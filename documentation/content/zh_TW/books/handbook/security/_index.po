# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR The FreeBSD Project
# This file is distributed under the same license as the FreeBSD Documentation package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
msgid ""
msgstr ""
"Project-Id-Version: FreeBSD Documentation VERSION\n"
"POT-Creation-Date: 2021-03-14 11:02-0300\n"
"PO-Revision-Date: 2021-04-12 20:54+0000\n"
"Last-Translator: Anonymous <noreply@weblate.org>\n"
"Language-Team: Chinese (Traditional) <https://translate-dev.freebsd.org/"
"projects/documentation/bookshandbooksecurity_index/zh_TW/>\n"
"Language: zh_TW\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"
"X-Generator: Weblate 4.5.2\n"

#. type: YAML Front Matter: part
#: documentation/content/en/books/handbook/security/_index.adoc:1
#, no-wrap
msgid "Part III. System Administration"
msgstr ""

#. type: YAML Front Matter: title
#: documentation/content/en/books/handbook/security/_index.adoc:1
#, no-wrap
msgid "Chapter 14. Security"
msgstr ""

#. type: Title =
#: documentation/content/en/books/handbook/security/_index.adoc:9
#, no-wrap
msgid "Security"
msgstr "安全性"

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:45
#, no-wrap
msgid "Synopsis"
msgstr "概述"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:48
msgid ""
"Security, whether physical or virtual, is a topic so broad that an entire "
"industry has evolved around it. Hundreds of standard practices have been "
"authored about how to secure systems and networks, and as a user of FreeBSD, "
"understanding how to protect against attacks and intruders is a must."
msgstr ""
"不論實體或虛擬，安全性這個主題大到有整個產業圍繞著它，上百個標準案例已經被用來搛寫如何確保系統與網路的安全性。身為 FreeBSD "
"必須了解如何避免攻擊與入侵。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:50
msgid ""
"In this chapter, several fundamentals and techniques will be discussed. The "
"FreeBSD system comes with multiple layers of security, and many more third "
"party utilities may be added to enhance security."
msgstr "在此章會討論幾個基本原理及技術。FreeBSD 系統的安全性有許多層面，且有許多第三方工具可以用來增加安全性。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:52
msgid "After reading this chapter, you will know:"
msgstr "讀完這章，您將了解："

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:54
msgid "Basic FreeBSD system security concepts."
msgstr "基礎 FreeBSD 系統安全概念。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:55
msgid "The various crypt mechanisms available in FreeBSD."
msgstr "FreeBSD 中的幾種加密 (Crypt) 機制。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:56
msgid "How to set up one-time password authentication."
msgstr "如何設定一次性密碼認證。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:57
msgid "How to configure TCP Wrapper for use with man:inetd[8]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:58
msgid "How to set up Kerberos on FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:59
msgid "How to configure IPsec and create a VPN."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:60
msgid "How to configure and use OpenSSH on FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:61
msgid "How to use file system ACLs."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:62
msgid ""
"How to use pkg to audit third party software packages installed from the "
"Ports Collection."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:63
msgid "How to utilize FreeBSD security advisories."
msgstr "如何利用 FreeBSD 安全報告。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:64
msgid "What Process Accounting is and how to enable it on FreeBSD."
msgstr "什麼是程序追蹤 (Process Accounting) 以及如何在 FreeBSD 開啟。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:65
msgid ""
"How to control user resources using login classes or the resource limits "
"database."
msgstr "如何使用登入類別或資源限制資料庫控制使用者資源。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:67
msgid "Before reading this chapter, you should:"
msgstr "在開始閱讀這章之前，您需要："

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:69
msgid "Understand basic FreeBSD and Internet concepts."
msgstr "了解 FreeBSD 基礎及網路概念。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:71
msgid ""
"Additional security topics are covered elsewhere in this Handbook. For "
"example, Mandatory Access Control is discussed in crossref:mac[mac,Mandatory "
"Access Control] and Internet firewalls are discussed in crossref:"
"firewalls[firewalls,Firewalls]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:73
#, no-wrap
msgid "Introduction"
msgstr "說明"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:76
#, fuzzy
msgid ""
"Security is everyone's responsibility. A weak entry point in any system "
"could allow intruders to gain access to critical information and cause havoc "
"on an entire network. One of the core principles of information security is "
"the CIA triad, which stands for the Confidentiality, Integrity, and "
"Availability of information systems."
msgstr ""
"保安是每個人的責任，任何系統中的弱點都可讓入侵者取得對關鍵資訊的存取權並導致整個網路的浩劫。資訊安全的其中一個核心原則便是 <acronym>CIA</"
"acronym> 三字訣，代表著資訊系統的機密性 (Confidentiality)、完整性 (Integrity) 以及可用性 "
"(Availability)。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:78
#, fuzzy
msgid ""
"The CIA triad is a bedrock concept of computer security as customers and "
"users expect their data to be protected. For example, a customer expects "
"that their credit card information is securely stored (confidentiality), "
"that their orders are not changed behind the scenes (integrity), and that "
"they have access to their order information at all times (availablility)."
msgstr ""
"<acronym>CIA</acronym> 三字訣是電腦安全的基石，就如同客戶與使用者期望他們的資料得到保護一樣重要。例如，"
"一個客戶會期望他們的信用卡資訊被安全的保存 (機密性)、他們的訂單不會在私底下被竄改 (完整性) 以及他們隨時可以存取他們的訂單資訊 (可用性)。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:80
#, fuzzy
msgid ""
"To provide CIA, security professionals apply a defense in depth strategy. "
"The idea of defense in depth is to add several layers of security to prevent "
"one single layer failing and the entire security system collapsing. For "
"example, a system administrator cannot simply turn on a firewall and "
"consider the network or system secure. One must also audit accounts, check "
"the integrity of binaries, and ensure malicious tools are not installed. To "
"implement an effective security strategy, one must understand threats and "
"how to defend against them."
msgstr ""
"要提供 <acronym>CIA</acronym>，安全專家會應用防禦深度的策略。防禦深度的概念是增加數個保全階層來避免單一階層失效便導致整個安全系統瓦"
"解。例如，系統管理者不能直接打開防火牆與評估網路或系統的安全性，還要同時稽查帳號、檢查 Binary "
"的完整性與確保未被安裝惡意工具。要執行有效的保安策略，必須了解威脅以及如何抵禦威脅。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:82
msgid ""
"What is a threat as it pertains to computer security? Threats are not "
"limited to remote attackers who attempt to access a system without "
"permission from a remote location. Threats also include employees, malicious "
"software, unauthorized network devices, natural disasters, security "
"vulnerabilities, and even competing corporations."
msgstr ""
"什麼威脅影響到電腦安全性? "
"威脅並不僅限於在遠端嘗試未經授權存取系統的遠端攻擊者，威脅也包含員工、惡意軟體、未經許可的網路裝置、天然災害、安全性漏洞甚至是公司競爭對手。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:84
msgid ""
"Systems and networks can be accessed without permission, sometimes by "
"accident, or by remote attackers, and in some cases, via corporate espionage "
"or former employees. As a user, it is important to prepare for and admit "
"when a mistake has led to a security breach and report possible issues to "
"the security team. As an administrator, it is important to know of the "
"threats and be prepared to mitigate them."
msgstr ""
"系統與網路可以被未經授權存取，有時是因為意外，或是因遠端攻擊者，或在某些案例中，是因商業間諜或者前員工。做為使用者，重要的是做好防範準備以及當有失誤造成安"
"全漏洞能夠承認並回報可能的問題給安全團隊。做為管理者，重要的是了解威脅並準備在發生時能夠減緩威脅。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:86
#, fuzzy
msgid ""
"When applying security to systems, it is recommended to start by securing "
"the basic accounts and system configuration, and then to secure the network "
"layer so that it adheres to the system policy and the organization's "
"security procedures. Many organizations already have a security policy that "
"covers the configuration of technology devices. The policy should include "
"the security configuration of workstations, desktops, mobile devices, "
"phones, production servers, and development servers. In many cases, standard "
"operating procedures (SOPs) already exist. When in doubt, ask the security "
"team."
msgstr ""
"當要應用保安到系統上時，建議由基本帳號以及系統設定開始保全，接著確保網路層，使其遵守系統政策以及組織的安全程序。許多組織已經有涵蓋科技裝置設置的安全性政策"
"，該政策應包含工作站、桌上型電腦、行動裝置、手機、上線伺服器、開發伺服器的安全設置。在大多數案例中，也都已經有標準操作程序 "
"(<acronym>SOP</acronym>)，當有疑慮時，請向安全團隊諮詢。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:88
msgid ""
"The rest of this introduction describes how some of these basic security "
"configurations are performed on a FreeBSD system. The rest of this chapter "
"describes some specific tools which can be used when implementing a security "
"policy on a FreeBSD system."
msgstr ""
"簡介接下來的部份將說明如何在 FreeBSD 系統上執行這些基礎的安全設置。本章接下來的部份將介紹在 FreeBSD "
"系統執行安全性政策時會用到的特定工具。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:90
#, no-wrap
msgid "Preventing Logins"
msgstr "防止登入"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:93
msgid ""
"In securing a system, a good starting point is an audit of accounts. Ensure "
"that `root` has a strong password and that this password is not shared. "
"Disable any accounts that do not need login access."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:95
msgid ""
"To deny login access to accounts, two methods exist. The first is to lock "
"the account. This example locks the `toor` account:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:99
#, no-wrap
msgid "# pw lock toor\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:102
#, fuzzy
msgid ""
"The second method is to prevent login access by changing the shell to [."
"filename]#/usr/sbin/nologin#. Only the superuser can change the shell for "
"other users:"
msgstr ""
"第二種防止登入存取的方式是狀 Shell 更改為 <filename>/usr/sbin/nologin</filename>，"
"只有超級使用者可以更改其他使用者的 Shell："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:106
#, no-wrap
msgid "# chsh -s /usr/sbin/nologin toor\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:109
#, fuzzy
msgid ""
"The [.filename]#/usr/sbin/nologin# shell prevents the system from assigning "
"a shell to the user when they attempt to login."
msgstr "<filename>/usr/sbin/nologin</filename> shell 可以避免系統分配 Shell 給嘗試登入的使用者。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:111
#, no-wrap
msgid "Permitted Account Escalation"
msgstr "帳號升級授權"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:114
msgid ""
"In some cases, system administration needs to be shared with other users. "
"FreeBSD has two methods to handle this. The first one, which is not "
"recommended, is a shared root password used by members of the `wheel` group. "
"With this method, a user types `su` and enters the password for `wheel` "
"whenever superuser access is needed. The user should then type `exit` to "
"leave privileged access after finishing the commands that required "
"administrative access. To add a user to this group, edit [.filename]#/etc/"
"group# and add the user to the end of the `wheel` entry. The user must be "
"separated by a comma character with no space."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:116
#, fuzzy
msgid ""
"The second, and recommended, method to permit privilege escalation is to "
"install the package:security/sudo[] package or port. This software provides "
"additional auditing, more fine-grained user control, and can be configured "
"to lock users into running only the specified privileged commands."
msgstr ""
"第二種方式，也是較建議的方式，安裝 <package>security/sudo</package> 套件或 Port "
"來提升權限。這個軟體提供了額外的稽查、更細微的使用者控制，然後可以設定鎖定使用者只能執行特定需權限的指令。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:118
msgid ""
"After installation, use `visudo` to edit [.filename]#/usr/local/etc/"
"sudoers#. This example creates a new `webadmin` group, adds the `trhodes` "
"account to that group, and configures that group access to restart package:"
"apache24[]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:124
#, no-wrap
msgid ""
"# pw groupadd webadmin -M trhodes -g 6000\n"
"# visudo\n"
"%webadmin ALL=(ALL) /usr/sbin/service apache24 *\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:127
#, no-wrap
msgid "Password Hashes"
msgstr "密碼編碼方式"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:130
msgid ""
"Passwords are a necessary evil of technology. When they must be used, they "
"should be complex and a powerful hash mechanism should be used to encrypt "
"the version that is stored in the password database. FreeBSD supports the "
"DES, MD5, SHA256, SHA512, and Blowfish hash algorithms in its `crypt()` "
"library. The default of SHA512 should not be changed to a less secure "
"hashing algorithm, but can be changed to the more secure Blowfish algorithm."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:134
#, fuzzy
msgid ""
"Blowfish is not part of AES and is not considered compliant with any Federal "
"Information Processing Standards (FIPS). Its use may not be permitted in "
"some environments."
msgstr ""
"Blowfish 不是 <acronym>AES</acronym> 的一部份且不符合任何聯邦資訊處理標準 (Federal Information "
"Processing Standards, <acronym>FIPS</acronym>)，在某些環境可能不會允許使用這種加密方式。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:137
msgid ""
"To determine which hash algorithm is used to encrypt a user's password, the "
"superuser can view the hash for the user in the FreeBSD password database. "
"Each hash starts with a symbol which indicates the type of hash mechanism "
"used to encrypt the password. If DES is used, there is no beginning symbol. "
"For MD5, the symbol is `$`. For SHA256 and SHA512, the symbol is `$6$`. For "
"Blowfish, the symbol is `$2a$`. In this example, the password for `dru` is "
"hashed using the default SHA512 algorithm as the hash starts with `$6$`. "
"Note that the encrypted hash, not the password itself, is stored in the "
"password database:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:142
#, no-wrap
msgid ""
"# grep dru /etc/master.passwd\n"
"dru:$6$pzIjSvCAn.PBYQBA$PXpSeWPx3g5kscj3IMiM7tUEUSPmGexxta.8Lt9TGSi2lNQqYGKszsBPuGME0:1001:1001::0:0:dru:/usr/home/dru:/bin/csh\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:145
msgid ""
"The hash mechanism is set in the user's login class. For this example, the "
"user is in the `default` login class and the hash algorithm is set with this "
"line in [.filename]#/etc/login.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:149
#, no-wrap
msgid "        :passwd_format=sha512:\\\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:152
msgid ""
"To change the algorithm to Blowfish, modify that line to look like this:"
msgstr "要更改演算法為 Blowfish，可修改該行如下："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:156
#, no-wrap
msgid "        :passwd_format=blf:\\\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:159
msgid ""
"Then run `cap_mkdb /etc/login.conf` as described in <<users-limiting>>. Note "
"that this change will not affect any existing password hashes. This means "
"that all passwords should be re-hashed by asking users to run `passwd` in "
"order to change their password."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:161
msgid ""
"For remote logins, two-factor authentication should be used. An example of "
"two-factor authentication is \"something you have\", such as a key, and "
"\"something you know\", such as the passphrase for that key. Since OpenSSH "
"is part of the FreeBSD base system, all network logins should be over an "
"encrypted connection and use key-based authentication instead of passwords. "
"For more information, refer to <<openssh>>. Kerberos users may need to make "
"additional changes to implement OpenSSH in their network. These changes are "
"described in <<kerberos5>>."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:163
#, no-wrap
msgid "Password Policy Enforcement"
msgstr "強制密碼政策"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:166
#, fuzzy
msgid ""
"Enforcing a strong password policy for local accounts is a fundamental "
"aspect of system security. In FreeBSD, password length, password strength, "
"and password complexity can be implemented using built-in Pluggable "
"Authentication Modules (PAM)."
msgstr ""
"強制在本地帳號使用高強度密碼的政策是系統安全的基礎之一。在 FreeBSD 密碼長度、密碼強度以及密碼複雜性可使用內建的可插拔認証模組 ("
"Pluggable Authentication Modules, <acronym>PAM</acronym>) 來執行。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:168
msgid ""
"This section demonstrates how to configure the minimum and maximum password "
"length and the enforcement of mixed characters using the [."
"filename]#pam_passwdqc.so# module. This module is enforced when a user "
"changes their password."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:170
msgid ""
"To configure this module, become the superuser and uncomment the line "
"containing `pam_passwdqc.so` in [.filename]#/etc/pam.d/passwd#. Then, edit "
"that line to match the password policy:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:174
#, no-wrap
msgid "password        requisite       pam_passwdqc.so         min=disabled,disabled,disabled,12,10 similar=deny retry=3 enforce=users\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:177
msgid ""
"This example sets several requirements for new passwords. The `min` setting "
"controls the minimum password length. It has five values because this module "
"defines five different types of passwords based on their complexity. "
"Complexity is defined by the type of characters that must exist in a "
"password, such as letters, numbers, symbols, and case. The types of "
"passwords are described in man:pam_passwdqc[8]. In this example, the first "
"three types of passwords are disabled, meaning that passwords that meet "
"those complexity requirements will not be accepted, regardless of their "
"length. The `12` sets a minimum password policy of at least twelve "
"characters, if the password also contains characters with three types of "
"complexity. The `10` sets the password policy to also allow passwords of at "
"least ten characters, if the password contains characters with four types of "
"complexity."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:179
msgid ""
"The `similar` setting denies passwords that are similar to the user's "
"previous password. The `retry` setting provides a user with three "
"opportunities to enter a new password."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:181
msgid ""
"Once this file is saved, a user changing their password will see a message "
"similar to the following:"
msgstr "一這個檔案儲存之後，更改密碼的使用者將會看到如下的訊息："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:187
#, no-wrap
msgid ""
"% passwd\n"
"Changing local password for trhodes\n"
"Old Password:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:198
#, no-wrap
msgid ""
"You can now choose the new password.\n"
"A valid password should be a mix of upper and lower case letters,\n"
"digits and other characters.  You can use a 12 character long\n"
"password with characters from at least 3 of these 4 classes, or\n"
"a 10 character long password containing characters from all the\n"
"classes.  Characters that form a common pattern are discarded by\n"
"the check.\n"
"Alternatively, if no one else can see your terminal now, you can\n"
"pick this as your password: \"trait-useful&knob\".\n"
"Enter new password:\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:201
msgid ""
"If a password that does not match the policy is entered, it will be rejected "
"with a warning and the user will have an opportunity to try again, up to the "
"configured number of retries."
msgstr "若輸入了一個不符何密碼政策的密碼，則會被拒絕並顯示警告，然後使用者會有機會再重試，直到超過設定的允許重試次數。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:203
msgid ""
"Most password policies require passwords to expire after so many days. To "
"set a password age time in FreeBSD, set `passwordtime` for the user's login "
"class in [.filename]#/etc/login.conf#. The `default` login class contains an "
"example:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:207
#, no-wrap
msgid "#       :passwordtime=90d:\\\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:210
msgid ""
"So, to set an expiry of 90 days for this login class, remove the comment "
"symbol (`#`), save the edit, and run `cap_mkdb /etc/login.conf`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:212
msgid ""
"To set the expiration on individual users, pass an expiration date or the "
"number of days to expiry and a username to `pw`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:216
#, no-wrap
msgid "# pw usermod -p 30-apr-2015 -n trhodes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:219
msgid ""
"As seen here, an expiration date is set in the form of day, month, and year. "
"For more information, see man:pw[8]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:221
#, no-wrap
msgid "Detecting Rootkits"
msgstr "偵測 Root 工具 (Rootkit)"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:224
msgid ""
"A _rootkit_ is any unauthorized software that attempts to gain `root` access "
"to a system. Once installed, this malicious software will normally open up "
"another avenue of entry for an attacker. Realistically, once a system has "
"been compromised by a rootkit and an investigation has been performed, the "
"system should be reinstalled from scratch. There is tremendous risk that "
"even the most prudent security or systems engineer will miss something an "
"attacker left behind."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:226
#, fuzzy
msgid ""
"A rootkit does do one thing useful for administrators: once detected, it is "
"a sign that a compromise happened at some point. But, these types of "
"applications tend to be very well hidden. This section demonstrates a tool "
"that can be used to detect rootkits, package:security/rkhunter[]."
msgstr ""
"rootkit 對管理者而言唯一有幫助的是：一但偵測到，便代表某處已經被滲透，但這類型的應用程式躲藏的非常好，本節將會示範一個可以用來偵測 "
"rootkit 的工具，<package>security/rkhunter</package>。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:228
msgid ""
"After installation of this package or port, the system may be checked using "
"the following command. It will produce a lot of information and will require "
"some manual pressing of kbd:[ENTER]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:232
#, no-wrap
msgid "# rkhunter -c\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:235
#, fuzzy
msgid ""
"After the process completes, a status message will be printed to the screen. "
"This message will include the amount of files checked, suspect files, "
"possible rootkits, and more. During the check, some generic security "
"warnings may be produced about hidden files, the OpenSSH protocol selection, "
"and known vulnerable versions of installed software. These can be handled "
"now or after a more detailed analysis has been performed."
msgstr ""
"該程序完成之後，目前狀態的訊息便會顯示在畫面上。這個訊息包含了已檢查過多少檔案、可疑的檔案、可能的 rootkit "
"以及其他更多資訊。在檢查的過程中，可能會產生一些有關隱藏檔案、<application>OpenSSH</application> "
"通訊協定選擇及已安裝軟體已知漏洞版本的通用的安全性警告、這些問題可以立即處理或在更詳細的分析之後再處理。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:237
#, fuzzy
msgid ""
"Every administrator should know what is running on the systems they are "
"responsible for. Third-party tools like rkhunter and package:sysutils/"
"lsof[], and native commands such as `netstat` and `ps`, can show a great "
"deal of information on the system. Take notes on what is normal, ask "
"questions when something seems out of place, and be paranoid. While "
"preventing a compromise is ideal, detecting a compromise is a must."
msgstr ""
"每位管理者應了解在系統上執行了那些程式以及這些程式的用途。第三方工具如 <application>rkhunter</application> 與 "
"<package>sysutils/lsof</package> 以及原生指令如 <command>netstat</command> 與 "
"<command>ps</command> "
"可以系統上大量的資訊，記錄下那一些是正常的，當有不適當的程式出現時提出疑問，然後找出答案。雖然理想要避免滲透，但也必須偵測是否已被滲透了。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:239
#, no-wrap
msgid "Binary Verification"
msgstr "Binary 檢驗"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:242
#, fuzzy
msgid ""
"Verification of system files and binaries is important because it provides "
"the system administration and security teams information about system "
"changes. A software application that monitors the system for changes is "
"called an Intrusion Detection System (IDS)."
msgstr ""
"檢驗系統檔案與 Binary 是很重要的，因為它可以提供系統管理者與資安團隊有關系統變更的資訊，能夠監視系統變更的軟體應用程式稱為入侵偵測系統 ("
"Intrusion Detection System, <acronym>IDS</acronym>)。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:244
#, fuzzy
msgid ""
"FreeBSD provides native support for a basic IDS system. While the nightly "
"security emails will notify an administrator of changes, the information is "
"stored locally and there is a chance that a malicious user could modify this "
"information in order to hide their changes to the system. As such, it is "
"recommended to create a separate set of binary signatures and store them on "
"a read-only, root-owned directory or, preferably, on a removable USB disk or "
"remote rsync server."
msgstr ""
"FreeBSD 原生提供了基礎的 <acronym>IDS</acronym> "
"系統，雖然每天晚上會有安全性的信件會通知管理者相關的變更，但這些資訊是儲存在本地的，這讓惡意的使用者有機會能夠修改這些資訊來隱藏其對系統的變更。也因此，"
"會建議建立一個獨立的 Binary 簽名並將這些簽名儲存在唯度、root 擁有的目錄或在可移除的 <acronym>USB</acronym> "
"磁碟或遠端 <application>rsync</application> 伺服器更好。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:246
msgid ""
"The built-in `mtree` utility can be used to generate a specification of the "
"contents of a directory. A seed, or a numeric constant, is used to generate "
"the specification and is required to check that the specification has not "
"changed. This makes it possible to determine if a file or binary has been "
"modified. Since the seed value is unknown by an attacker, faking or checking "
"the checksum values of files will be difficult to impossible. The following "
"example generates a set of SHA256 hashes, one for each system binary in [."
"filename]#/bin#, and saves those values to a hidden file in ``root``'s home "
"directory, [.filename]#/root/.bin_chksum_mtree#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:251
#, no-wrap
msgid ""
"# mtree -s 3483151339707503 -c -K cksum,sha256digest -p /bin > /root/.bin_chksum_mtree\n"
"# mtree: /bin checksum: 3427012225\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:254
msgid ""
"The _3483151339707503_ represents the seed. This value should be remembered, "
"but not shared."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:256
#, fuzzy
msgid ""
"Viewing [.filename]#/root/.bin_cksum_mtree# should yield output similar to "
"the following:"
msgstr "檢視 <filename>/root/.bin_cksum_mtree</filename> 應會產生類似以下的輸出結果："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:263
#, no-wrap
msgid ""
"#          user: root\n"
"#       machine: dreadnaught\n"
"#          tree: /bin\n"
"#          date: Mon Feb  3 10:19:53 2014\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:279
#, no-wrap
msgid ""
"# .\n"
"/set type=file uid=0 gid=0 mode=0555 nlink=1 flags=none\n"
".               type=dir mode=0755 nlink=2 size=1024 \\\n"
"                time=1380277977.000000000\n"
"    \\133        nlink=2 size=11704 time=1380277977.000000000 \\\n"
"                cksum=484492447 \\\n"
"                sha256digest=6207490fbdb5ed1904441fbfa941279055c3e24d3a4049aeb45094596400662a\n"
"    cat         size=12096 time=1380277975.000000000 cksum=3909216944 \\\n"
"                sha256digest=65ea347b9418760b247ab10244f47a7ca2a569c9836d77f074e7a306900c1e69\n"
"    chflags     size=8168 time=1380277975.000000000 cksum=3949425175 \\\n"
"                sha256digest=c99eb6fc1c92cac335c08be004a0a5b4c24a0c0ef3712017b12c89a978b2dac3\n"
"    chio        size=18520 time=1380277975.000000000 cksum=2208263309 \\\n"
"                sha256digest=ddf7c8cb92a58750a675328345560d8cc7fe14fb3ccd3690c34954cbe69fc964\n"
"    chmod       size=8640 time=1380277975.000000000 cksum=2214429708 \\\n"
"                sha256digest=a435972263bf814ad8df082c0752aa2a7bdd8b74ff01431ccbd52ed1e490bbe7\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:282
msgid ""
"The machine's hostname, the date and time the specification was created, and "
"the name of the user who created the specification are included in this "
"report. There is a checksum, size, time, and SHA256 digest for each binary "
"in the directory."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:284
msgid ""
"To verify that the binary signatures have not changed, compare the current "
"contents of the directory to the previously generated specification, and "
"save the results to a file. This command requires the seed that was used to "
"generate the original specification:"
msgstr ""
"要檢驗 Binary 簽名是否有被變更過，可使用先前產生的規格檔比對目前目錄的內容，然後儲存結果到檔案。這個指令需要當初產生原規格檔所使用的種子碼："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:289
#, no-wrap
msgid ""
"# mtree -s 3483151339707503 -p /bin < /root/.bin_chksum_mtree >> /root/.bin_chksum_output\n"
"# mtree: /bin checksum: 3427012225\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:292
#, fuzzy
msgid ""
"This should produce the same checksum for [.filename]#/bin# that was "
"produced when the specification was created. If no changes have occurred to "
"the binaries in this directory, the [.filename]#/root/.bin_chksum_output# "
"output file will be empty. To simulate a change, change the date on [."
"filename]#/bin/cat# using `touch` and run the verification command again:"
msgstr ""
"這個動作應會產生與上次建立 <filename>/bin</filename> 規格檔時產生的校驗碼相同，若在此目錄的 Binary 沒有被變更過，那麼 "
"<filename>/root/.bin_chksum_output</filename> 這個輸出檔將會是空的。要模擬變更，可以使用 "
"<command>touch</command> 更改 <filename>/root/.bin_chksum_output</filename> "
"的日期然後再執行檢驗指令一次："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:300
#, no-wrap
msgid ""
"# touch /bin/cat\n"
"# mtree -s 3483151339707503 -p /bin < /root/.bin_chksum_mtree >> /root/.bin_chksum_output\n"
"# more /root/.bin_chksum_output\n"
"cat changed\n"
"\tmodification time expected Fri Sep 27 06:32:55 2013 found Mon Feb  3 10:28:43 2014\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:303
msgid ""
"It is recommended to create specifications for the directories which contain "
"binaries and configuration files, as well as any directories containing "
"sensitive data. Typically, specifications are created for [.filename]#/bin#, "
"[.filename]#/sbin#, [.filename]#/usr/bin#, [.filename]#/usr/sbin#, [."
"filename]#/usr/local/bin#, [.filename]#/etc#, and [.filename]#/usr/local/"
"etc#."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:305
msgid ""
"More advanced IDS systems exist, such as package:security/aide[]. In most "
"cases, `mtree` provides the functionality administrators need. It is "
"important to keep the seed value and the checksum output hidden from "
"malicious users. More information about `mtree` can be found in man:mtree[8]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:307
#, no-wrap
msgid "System Tuning for Security"
msgstr "系統安全性調校"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:310
msgid ""
"In FreeBSD, many system features can be tuned using `sysctl`. A few of the "
"security features which can be tuned to prevent Denial of Service (DoS) "
"attacks will be covered in this section. More information about using "
"`sysctl`, including how to temporarily change values and how to make the "
"changes permanent after testing, can be found in crossref:"
"config[configtuning-sysctl,“Tuning with sysctl(8)”]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:314
#, fuzzy
msgid ""
"Any time a setting is changed with `sysctl`, the chance to cause undesired "
"harm is increased, affecting the availability of the system. All changes "
"should be monitored and, if possible, tried on a testing system before being "
"used on a production system."
msgstr ""
"任何時間使用 <xref linkend=\"configtuning-sysctl\"/> "
"做的設定變更都會讓造成不想要的傷害的可能性上升，影響到系統的可用性。因此應要對所有的變更做監視，若可能的話，先在測試系統上實驗，再到上線的系統上使用。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:317
msgid ""
"By default, the FreeBSD kernel boots with a security level of `-1`. This is "
"called \"insecure mode\" because immutable file flags may be turned off and "
"all devices may be read from or written to. The security level will remain "
"at `-1` unless it is altered through `sysctl` or by a setting in the startup "
"scripts. The security level may be increased during system startup by "
"setting `kern_securelevel_enable` to `YES` in [.filename]#/etc/rc.conf#, and "
"the value of `kern_securelevel` to the desired security level. See man:"
"security[7] and man:init[8] for more information on these settings and the "
"available security levels."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:322
msgid ""
"Increasing the `securelevel` can break Xorg and cause other issues. Be "
"prepared to do some debugging."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:325
msgid ""
"The `net.inet.tcp.blackhole` and `net.inet.udp.blackhole` settings can be "
"used to drop incoming SYN packets on closed ports without sending a return "
"RST response. The default behavior is to return an RST to show a port is "
"closed. Changing the default provides some level of protection against ports "
"scans, which are used to determine which applications are running on a "
"system. Set `net.inet.tcp.blackhole` to `2` and `net.inet.udp.blackhole` to "
"`1`. Refer to man:blackhole[4] for more information about these settings."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:327
msgid ""
"The `net.inet.icmp.drop_redirect` and `net.inet.ip.redirect` settings help "
"prevent against _redirect attacks_. A redirect attack is a type of DoS which "
"sends mass numbers of ICMP type 5 packets. Since these packets are not "
"required, set `net.inet.icmp.drop_redirect` to `1` and set `net.inet.ip."
"redirect` to `0`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:329
msgid ""
"Source routing is a method for detecting and accessing non-routable "
"addresses on the internal network. This should be disabled as non-routable "
"addresses are normally not routable on purpose. To disable this feature, set "
"`net.inet.ip.sourceroute` and `net.inet.ip.accept_sourceroute` to `0`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:331
msgid ""
"When a machine on the network needs to send messages to all hosts on a "
"subnet, an ICMP echo request message is sent to the broadcast address. "
"However, there is no reason for an external host to perform such an action. "
"To reject all external broadcast requests, set `net.inet.icmp.bmcastecho` to "
"`0`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:333
msgid "Some additional settings are documented in man:security[7]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:335
#, no-wrap
msgid "One-time Passwords"
msgstr "一次性密碼"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:338
#, fuzzy
msgid ""
"By default, FreeBSD includes support for One-time Passwords In Everything "
"(OPIE). OPIE is designed to prevent replay attacks, in which an attacker "
"discovers a user's password and uses it to access a system. Since a password "
"is only used once in OPIE, a discovered password is of little use to an "
"attacker. OPIE uses a secure hash and a challenge/response system to manage "
"passwords. The FreeBSD implementation uses the MD5 hash by default."
msgstr ""
"預設 FreeBSD 已內建一次性密碼 (One-time Passwords In Everything, "
"<acronym>OPIE</acronym>)。<acronym>OPIE</acronym> 設計用來避免重送攻擊 (Replay "
"attack)，重送攻擊指的是攻擊者發現了某位使用者的密碼，然後使用該密碼來存取系統。由於在 <acronym>OPIE</acronym> "
"的環境下，一組密碼只能被使用一次，被發現的密碼對攻擊者而言便沒有什麼作用。<acronym>OPIE</acronym> 使用了安全的加密方式與詰問/"
"回應系統 (Challenge/response system) 來管理密碼。FreeBSD 在實作上預設採用 <acronym>MD5</"
"acronym> 加密。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:340
msgid ""
"OPIE uses three different types of passwords. The first is the usual UNIX(R) "
"or Kerberos password. The second is the one-time password which is generated "
"by `opiekey`. The third type of password is the \"secret password\" which is "
"used to generate one-time passwords. The secret password has nothing to do "
"with, and should be different from, the UNIX(R) password."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:342
msgid ""
"There are two other pieces of data that are important to OPIE. One is the "
"\"seed\" or \"key\", consisting of two letters and five digits. The other is "
"the \"iteration count\", a number between 1 and 100. OPIE creates the one-"
"time password by concatenating the seed and the secret password, applying "
"the MD5 hash as many times as specified by the iteration count, and turning "
"the result into six short English words which represent the one-time "
"password. The authentication system keeps track of the last one-time "
"password used, and the user is authenticated if the hash of the user-"
"provided password is equal to the previous password. Since a one-way hash is "
"used, it is impossible to generate future one-time passwords if a "
"successfully used password is captured. The iteration count is decremented "
"after each successful login to keep the user and the login program in sync. "
"When the iteration count gets down to `1`, OPIE must be reinitialized."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:344
msgid ""
"There are a few programs involved in this process. A one-time password, or a "
"consecutive list of one-time passwords, is generated by passing an iteration "
"count, a seed, and a secret password to man:opiekey[1]. In addition to "
"initializing OPIE, man:opiepasswd[1] is used to change passwords, iteration "
"counts, or seeds. The relevant credential files in [.filename]#/etc/"
"opiekeys# are examined by man:opieinfo[1] which prints out the invoking "
"user's current iteration count and seed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:346
#, fuzzy
msgid ""
"This section describes four different sorts of operations. The first is how "
"to set up one-time-passwords for the first time over a secure connection. "
"The second is how to use `opiepasswd` over an insecure connection. The third "
"is how to log in over an insecure connection. The fourth is how to generate "
"a number of keys which can be written down or printed out to use at insecure "
"locations."
msgstr ""
"本章節將介紹四種不同的操作，第一是如何在安全連線下做第一次的一次性密碼設定，第二是如何使用在不安全的連線下使用 <command>opiepasswd</"
"command>，第三是如何在不安全的連線下登入系統，第四是如何產生數個可以被記錄或列印下來在不安全的場所使的金鑰。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:347
#, no-wrap
msgid "Initializing OPIE"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:350
msgid ""
"To initialize OPIE for the first time, run this command from a secure "
"location:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:361
#, no-wrap
msgid ""
"% opiepasswd -c\n"
"Adding unfurl:\n"
"Only use this method from the console; NEVER from remote. If you are using\n"
"telnet, xterm, or a dial-in, type ^C now or exit with no password.\n"
"Then run opiepasswd without the -c parameter.\n"
"Using MD5 to compute responses.\n"
"Enter new secret pass phrase:\n"
"Again new secret pass phrase:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:364
#, no-wrap
msgid ""
"ID unfurl OTP key is 499 to4268\n"
"MOS MALL GOAT ARM AVID COED\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:367
msgid ""
"The `-c` sets console mode which assumes that the command is being run from "
"a secure location, such as a computer under the user's control or an SSH "
"session to a computer under the user's control."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:369
msgid ""
"When prompted, enter the secret password which will be used to generate the "
"one-time login keys. This password should be difficult to guess and should "
"be different than the password which is associated with the user's login "
"account. It must be between 10 and 127 characters long. Remember this "
"password."
msgstr ""
"提示出現後，輸入用來產生一次性登入金鑰的秘密密碼，應使用一個不容易被猜出來的密碼，且應與使用者登入帳號所使用的密碼不同，密碼必須介於 10 到 127 "
"個字元長度之間，然後請記住這個密碼。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:371
#, fuzzy
msgid ""
"The `ID` line lists the login name (`unfurl`), default iteration count "
"(`499`), and default seed (`to4268`). When logging in, the system will "
"remember these parameters and display them, meaning that they do not have to "
"be memorized. The last line lists the generated one-time password which "
"corresponds to those parameters and the secret password. At the next login, "
"use this one-time password."
msgstr ""
"<literal>ID</literal> 行會列出登入名稱 (<literal>unfurl</literal>)、預設的疊代次數 "
"(<literal>499</literal>) 以及預設的種子碼 (<literal>to4268</literal>)。在進行登入時，系統會記住這些參"
"數並且顯示出來，這也代表不需要另外記錄這些資訊。最後一行會列出根據這些參數與秘密密碼所產生出來的一次性密碼，在下一次登入時便要使用這個一次性密碼。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:372
#, no-wrap
msgid "Insecure Connection Initialization"
msgstr "在不安全連線下做初始化"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:375
msgid ""
"To initialize or change the secret password on an insecure system, a secure "
"connection is needed to some place where `opiekey` can be run. This might be "
"a shell prompt on a trusted machine. An iteration count is needed, where 100 "
"is probably a good value, and the seed can either be specified or the "
"randomly-generated one used. On the insecure connection, the machine being "
"initialized, use man:opiepasswd[1]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:379
#, no-wrap
msgid "% opiepasswd\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:388
#, no-wrap
msgid ""
"Updating unfurl:\n"
"You need the response from an OTP generator.\n"
"Old secret pass phrase:\n"
"\totp-md5 498 to4268 ext\n"
"\tResponse: GAME GAG WELT OUT DOWN CHAT\n"
"New secret pass phrase:\n"
"\totp-md5 499 to4269\n"
"\tResponse: LINE PAP MILK NELL BUOY TROY\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:391
#, no-wrap
msgid ""
"ID mark OTP key is 499 gr4269\n"
"LINE PAP MILK NELL BUOY TROY\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:394
msgid ""
"To accept the default seed, press kbd:[Return]. Before entering an access "
"password, move over to the secure connection and give it the same parameters:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:402
#: documentation/content/en/books/handbook/security/_index.adoc:437
#, no-wrap
msgid ""
"% opiekey 498 to4268\n"
"Using the MD5 algorithm to compute response.\n"
"Reminder: Do not use opiekey from telnet or dial-in sessions.\n"
"Enter secret pass phrase:\n"
"GAME GAG WELT OUT DOWN CHAT\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:405
msgid ""
"Switch back over to the insecure connection, and copy the generated one-time "
"password over to the relevant program."
msgstr "切換回不安全的連線，然後複製產生的一次性密碼貼上。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:406
#, no-wrap
msgid "Generating a Single One-time Password"
msgstr "產生單組一次性密碼"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:409
msgid ""
"After initializing OPIE and logging in, a prompt like this will be displayed:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:416
#, no-wrap
msgid ""
"% telnet example.com\n"
"Trying 10.0.0.1...\n"
"Connected to example.com\n"
"Escape character is '^]'.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:418
#, no-wrap
msgid "FreeBSD/i386 (example.com) (ttypa)\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:422
#, no-wrap
msgid ""
"login: <username>\n"
"otp-md5 498 gr4269 ext\n"
"Password: \n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:425
msgid ""
"The OPIE prompts provides a useful feature. If kbd:[Return] is pressed at "
"the password prompt, the prompt will turn echo on and display what is typed. "
"This can be useful when attempting to type in a password by hand from a "
"printout."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:427
msgid ""
"At this point, generate the one-time password to answer this login prompt. "
"This must be done on a trusted system where it is safe to run man:"
"opiekey[1]. There are versions of this command for Windows(R), Mac OS(R) and "
"FreeBSD. This command needs the iteration count and the seed as command line "
"options. Use cut-and-paste from the login prompt on the machine being logged "
"in to."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:429
msgid "On the trusted system:"
msgstr "在信任的系統上執行："

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:440
msgid "Once the one-time password is generated, continue to log in."
msgstr "在產生一次性密碼後，回到登入畫面繼續登入。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:441
#, no-wrap
msgid "Generating Multiple One-time Passwords"
msgstr "產生多組一次性密碼"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:444
msgid ""
"Sometimes there is no access to a trusted machine or secure connection. In "
"this case, it is possible to use man:opiekey[1] to generate a number of one-"
"time passwords beforehand. For example:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:456
#, no-wrap
msgid ""
"% opiekey -n 5 30 zz99999\n"
"Using the MD5 algorithm to compute response.\n"
"Reminder: Do not use opiekey from telnet or dial-in sessions.\n"
"Enter secret pass phrase: <secret password>\n"
"26: JOAN BORE FOSS DES NAY QUIT\n"
"27: LATE BIAS SLAY FOLK MUCH TRIG\n"
"28: SALT TIN ANTI LOON NEAL USE\n"
"29: RIO ODIN GO BYE FURY TIC\n"
"30: GREW JIVE SAN GIRD BOIL PHI\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:459
#, fuzzy
msgid ""
"The `-n 5` requests five keys in sequence, and `30` specifies what the last "
"iteration number should be. Note that these are printed out in _reverse_ "
"order of use. The really paranoid might want to write the results down by "
"hand; otherwise, print the list. Each line shows both the iteration count "
"and the one-time password. Scratch off the passwords as they are used."
msgstr ""
"<option>-n 5</option> 會請求產生連續五個金鑰，而 <option>30</option> 則是指定最後一個疊代的編號。注意這些列印出"
"的結果的順序與使用的順序<emphasis>相反</emphasis>。十足的偏執狂可能會想要用手寫下結果，否則就列印出清單。每一行會同時顯示疊代次數及一"
"次性密碼，在密碼使用過後便可劃掉。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:460
#, no-wrap
msgid "Restricting Use of UNIX(R) Passwords"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:463
msgid ""
"OPIE can restrict the use of UNIX(R) passwords based on the IP address of a "
"login session. The relevant file is [.filename]#/etc/opieaccess#, which is "
"present by default. Refer to man:opieaccess[5] for more information on this "
"file and which security considerations to be aware of when using it."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:465
msgid "Here is a sample [.filename]#opieaccess#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:469
#, no-wrap
msgid "permit 192.168.0.0 255.255.0.0\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:472
msgid ""
"This line allows users whose IP source address (which is vulnerable to "
"spoofing) matches the specified value and mask, to use UNIX(R) passwords at "
"any time."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:474
msgid ""
"If no rules in [.filename]#opieaccess# are matched, the default is to deny "
"non-OPIE logins."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:476
#, no-wrap
msgid "TCP Wrapper"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:479
msgid ""
"TCP Wrapper is a host-based access control system which extends the "
"abilities of crossref:network-servers[network-inetd,“The inetd Super-"
"Server”]. It can be configured to provide logging support, return messages, "
"and connection restrictions for the server daemons under the control of "
"inetd. Refer to man:tcpd[8] for more information about TCP Wrapper and its "
"features."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:481
msgid ""
"TCP Wrapper should not be considered a replacement for a properly configured "
"firewall. Instead, TCP Wrapper should be used in conjunction with a firewall "
"and other security enhancements in order to provide another layer of "
"protection in the implementation of a security policy."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:482
#, no-wrap
msgid "Initial Configuration"
msgstr "初始設定"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:485
msgid ""
"To enable TCP Wrapper in FreeBSD, add the following lines to [.filename]#/"
"etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:490
#, no-wrap
msgid ""
"inetd_enable=\"YES\"\n"
"inetd_flags=\"-Ww\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:493
msgid "Then, properly configure [.filename]#/etc/hosts.allow#."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:497
msgid ""
"Unlike other implementations of TCP Wrapper, the use of [.filename]#hosts."
"deny# is deprecated in FreeBSD. All configuration options should be placed "
"in [.filename]#/etc/hosts.allow#."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:500
msgid ""
"In the simplest configuration, daemon connection policies are set to either "
"permit or block, depending on the options in [.filename]#/etc/hosts.allow#. "
"The default configuration in FreeBSD is to allow all connections to the "
"daemons started with inetd."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:502
msgid ""
"Basic configuration usually takes the form of `daemon : address : action`, "
"where `daemon` is the daemon which inetd started, `address` is a valid "
"hostname, IP address, or an IPv6 address enclosed in brackets ([ ]), and "
"`action` is either `allow` or `deny`. TCP Wrapper uses a first rule match "
"semantic, meaning that the configuration file is scanned from the beginning "
"for a matching rule. When a match is found, the rule is applied and the "
"search process stops."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:504
msgid ""
"For example, to allow POP3 connections via the package:mail/qpopper[] "
"daemon, the following lines should be appended to [.filename]#hosts.allow#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:509
#, no-wrap
msgid ""
"# This line is required for POP3 connections:\n"
"qpopper : ALL : allow\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:512
msgid "Whenever this file is edited, restart inetd:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:516
#, no-wrap
msgid "# service inetd restart\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:518
#, no-wrap
msgid "Advanced Configuration"
msgstr "進階設定"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:521
msgid ""
"TCP Wrapper provides advanced options to allow more control over the way "
"connections are handled. In some cases, it may be appropriate to return a "
"comment to certain hosts or daemon connections. In other cases, a log entry "
"should be recorded or an email sent to the administrator. Other situations "
"may require the use of a service for local connections only. This is all "
"possible through the use of configuration options known as wildcards, "
"expansion characters, and external command execution."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:523
msgid ""
"Suppose that a situation occurs where a connection should be denied yet a "
"reason should be sent to the host who attempted to establish that "
"connection. That action is possible with `twist`. When a connection attempt "
"is made, `twist` executes a shell command or script. An example exists in [."
"filename]#hosts.allow#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:530
#, no-wrap
msgid ""
"# The rest of the daemons are protected.\n"
"ALL : ALL \\\n"
"\t: severity auth.info \\\n"
"\t: twist /bin/echo \"You are not welcome to use %d from %h.\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:533
msgid ""
"In this example, the message \"You are not allowed to use _daemon name_ from "
"_hostname_.\" will be returned for any daemon not configured in [."
"filename]#hosts.allow#. This is useful for sending a reply back to the "
"connection initiator right after the established connection is dropped. Any "
"message returned _must_ be wrapped in quote (`\"`) characters."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:538
msgid ""
"It may be possible to launch a denial of service attack on the server if an "
"attacker floods these daemons with connection requests."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:541
msgid ""
"Another possibility is to use `spawn`. Like `twist`, `spawn` implicitly "
"denies the connection and may be used to run external shell commands or "
"scripts. Unlike `twist`, `spawn` will not send a reply back to the host who "
"established the connection. For example, consider the following "
"configuration:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:549
#, no-wrap
msgid ""
"# We do not allow connections from example.com:\n"
"ALL : .example.com \\\n"
"\t: spawn (/bin/echo %a from %h attempted to access %d >> \\\n"
"\t  /var/log/connections.log) \\\n"
"\t: deny\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:552
msgid ""
"This will deny all connection attempts from `*.example.com` and log the "
"hostname, IP address, and the daemon to which access was attempted to [."
"filename]#/var/log/connections.log#. This example uses the substitution "
"characters `%a` and `%h`. Refer to man:hosts_access[5] for the complete list."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:554
msgid ""
"To match every instance of a daemon, domain, or IP address, use `ALL`. "
"Another wildcard is `PARANOID` which may be used to match any host which "
"provides an IP address that may be forged because the IP address differs "
"from its resolved hostname. In this example, all connection requests to "
"Sendmail which have an IP address that varies from its hostname will be "
"denied:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:559
#, no-wrap
msgid ""
"# Block possibly spoofed requests to sendmail:\n"
"sendmail : PARANOID : deny\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:565
msgid ""
"Using the `PARANOID` wildcard will result in denied connections if the "
"client or server has a broken DNS setup."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:568
msgid ""
"To learn more about wildcards and their associated functionality, refer to "
"man:hosts_access[5]."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:572
msgid ""
"When adding new configuration lines, make sure that any unneeded entries for "
"that daemon are commented out in [.filename]#hosts.allow#."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:575
#, no-wrap
msgid "Kerberos"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:578
msgid ""
"Kerberos is a network authentication protocol which was originally created "
"by the Massachusetts Institute of Technology (MIT) as a way to securely "
"provide authentication across a potentially hostile network. The Kerberos "
"protocol uses strong cryptography so that both a client and server can prove "
"their identity without sending any unencrypted secrets over the network. "
"Kerberos can be described as an identity-verifying proxy system and as a "
"trusted third-party authentication system. After a user authenticates with "
"Kerberos, their communications can be encrypted to assure privacy and data "
"integrity."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:580
msgid ""
"The only function of Kerberos is to provide the secure authentication of "
"users and servers on the network. It does not provide authorization or "
"auditing functions. It is recommended that Kerberos be used with other "
"security methods which provide authorization and audit services."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:582
msgid ""
"The current version of the protocol is version 5, described in RFC 4120. "
"Several free implementations of this protocol are available, covering a wide "
"range of operating systems. MIT continues to develop their Kerberos package. "
"It is commonly used in the US as a cryptography product, and has "
"historically been subject to US export regulations. In FreeBSD, MITKerberos "
"is available as the package:security/krb5[] package or port. The Heimdal "
"Kerberos implementation was explicitly developed outside of the US to avoid "
"export regulations. The Heimdal Kerberos distribution is included in the "
"base FreeBSD installation, and another distribution with more configurable "
"options is available as package:security/heimdal[] in the Ports Collection."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:584
msgid ""
"In Kerberos users and services are identified as \"principals\" which are "
"contained within an administrative grouping, called a \"realm\". A typical "
"user principal would be of the form `_user_@_REALM_` (realms are "
"traditionally uppercase)."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:586
msgid ""
"This section provides a guide on how to set up Kerberos using the Heimdal "
"distribution included in FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:588
msgid ""
"For purposes of demonstrating a Kerberos installation, the name spaces will "
"be as follows:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:590
msgid "The DNS domain (zone) will be `example.org`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:591
msgid "The Kerberos realm will be `EXAMPLE.ORG`."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:595
msgid ""
"Use real domain names when setting up Kerberos, even if it will run "
"internally. This avoids DNS problems and assures inter-operation with other "
"Kerberos realms."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:597
#, no-wrap
msgid "Setting up a Heimdal KDC"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:600
msgid ""
"The Key Distribution Center (KDC) is the centralized authentication service "
"that Kerberos provides, the \"trusted third party\" of the system. It is the "
"computer that issues Kerberos tickets, which are used for clients to "
"authenticate to servers. As the KDC is considered trusted by all other "
"computers in the Kerberos realm, it has heightened security concerns. Direct "
"access to the KDC should be limited."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:602
msgid ""
"While running a KDC requires few computing resources, a dedicated machine "
"acting only as a KDC is recommended for security reasons."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:604
msgid "To begin, install the package:security/heimdal[] package as follows:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:608
#, no-wrap
msgid "# pkg install heimdal\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:611
msgid "Next, update [.filename]#/etc/rc.conf# using `sysrc` as follows:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:616
#, no-wrap
msgid ""
"# sysrc kdc_enable=yes\n"
"# sysrc kadmind_enable=yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:619
msgid "Next, edit [.filename]#/etc/krb5.conf# as follows:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:631
#, no-wrap
msgid ""
"[libdefaults]\n"
"    default_realm = EXAMPLE.ORG\n"
"[realms]\n"
"    EXAMPLE.ORG = {\n"
"\tkdc = kerberos.example.org\n"
"\tadmin_server = kerberos.example.org\n"
"    }\n"
"[domain_realm]\n"
"    .example.org = EXAMPLE.ORG\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:634
msgid ""
"In this example, the KDC will use the fully-qualified hostname `kerberos."
"example.org`. The hostname of the KDC must be resolvable in the DNS."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:636
msgid ""
"Kerberos can also use the DNS to locate KDCs, instead of a `[realms]` "
"section in [.filename]#/etc/krb5.conf#. For large organizations that have "
"their own DNS servers, the above example could be trimmed to:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:643
#, no-wrap
msgid ""
"[libdefaults]\n"
"      default_realm = EXAMPLE.ORG\n"
"[domain_realm]\n"
"    .example.org = EXAMPLE.ORG\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:646
msgid "With the following lines being included in the `example.org` zone file:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:654
#, no-wrap
msgid ""
"_kerberos._udp      IN  SRV     01 00 88 kerberos.example.org.\n"
"_kerberos._tcp      IN  SRV     01 00 88 kerberos.example.org.\n"
"_kpasswd._udp       IN  SRV     01 00 464 kerberos.example.org.\n"
"_kerberos-adm._tcp  IN  SRV     01 00 749 kerberos.example.org.\n"
"_kerberos           IN  TXT     EXAMPLE.ORG\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:659
msgid ""
"In order for clients to be able to find the Kerberos services, they _must_ "
"have either a fully configured [.filename]#/etc/krb5.conf# or a minimally "
"configured [.filename]#/etc/krb5.conf#_and_ a properly configured DNS server."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:662
msgid ""
"Next, create the Kerberos database which contains the keys of all principals "
"(users and hosts) encrypted with a master password. It is not required to "
"remember this password as it will be stored in [.filename]#/var/heimdal/m-"
"key#; it would be reasonable to use a 45-character random password for this "
"purpose. To create the master key, run `kstash` and enter a password:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:668
#, no-wrap
msgid ""
"# kstash\n"
"Master key: xxxxxxxxxxxxxxxxxxxxxxx\n"
"Verifying password - Master key: xxxxxxxxxxxxxxxxxxxxxxx\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:671
msgid ""
"Once the master key has been created, the database should be initialized. "
"The Kerberos administrative tool man:kadmin[8] can be used on the KDC in a "
"mode that operates directly on the database, without using the man:"
"kadmind[8] network service, as `kadmin -l`. This resolves the chicken-and-"
"egg problem of trying to connect to the database before it is created. At "
"the `kadmin` prompt, use `init` to create the realm's initial database:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:677
#, no-wrap
msgid ""
"# kadmin -l\n"
"kadmin> init EXAMPLE.ORG\n"
"Realm max ticket life [unlimited]:\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:680
msgid ""
"Lastly, while still in `kadmin`, create the first principal using `add`. "
"Stick to the default options for the principal for now, as these can be "
"changed later with `modify`. Type `?` at the prompt to see the available "
"options."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:691
#, no-wrap
msgid ""
"kadmin> add tillman\n"
"Max ticket life [unlimited]:\n"
"Max renewable life [unlimited]:\n"
"Principal expiration time [never]:\n"
"Password expiration time [never]:\n"
"Attributes []:\n"
"Password: xxxxxxxx\n"
"Verifying password - Password: xxxxxxxx\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:694
msgid "Next, start the KDC services by running:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:699
#, no-wrap
msgid ""
"# service kdc start\n"
"# service kadmind start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:702
msgid ""
"While there will not be any kerberized daemons running at this point, it is "
"possible to confirm that the KDC is functioning by obtaining a ticket for "
"the principal that was just created:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:707
#, no-wrap
msgid ""
"% kinit tillman\n"
"tillman@EXAMPLE.ORG's Password:\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:710
msgid "Confirm that a ticket was successfully obtained using `klist`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:716
#, no-wrap
msgid ""
"% klist\n"
"Credentials cache: FILE:/tmp/krb5cc_1001\n"
"\tPrincipal: tillman@EXAMPLE.ORG\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:719
#, no-wrap
msgid ""
"  Issued                Expires               Principal\n"
"Aug 27 15:37:58 2013  Aug 28 01:37:58 2013  krbtgt/EXAMPLE.ORG@EXAMPLE.ORG\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:722
msgid "The temporary ticket can be destroyed when the test is finished:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:726
#, no-wrap
msgid "% kdestroy\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:728
#, no-wrap
msgid "Configuring a Server to Use Kerberos"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:731
msgid ""
"The first step in configuring a server to use Kerberos authentication is to "
"ensure that it has the correct configuration in [.filename]#/etc/krb5.conf#. "
"The version from the KDC can be used as-is, or it can be regenerated on the "
"new system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:733
msgid ""
"Next, create [.filename]#/etc/krb5.keytab# on the server. This is the main "
"part of \"Kerberizing\" a service - it corresponds to generating a secret "
"shared between the service and the KDC. The secret is a cryptographic key, "
"stored in a \"keytab\". The keytab contains the server's host key, which "
"allows it and the KDC to verify each others' identity. It must be "
"transmitted to the server in a secure fashion, as the security of the server "
"can be broken if the key is made public. Typically, the [.filename]#keytab# "
"is generated on an administrator's trusted machine using `kadmin`, then "
"securely transferred to the server, e.g., with man:scp[1]; it can also be "
"created directly on the server if that is consistent with the desired "
"security policy. It is very important that the keytab is transmitted to the "
"server in a secure fashion: if the key is known by some other party, that "
"party can impersonate any user to the server! Using `kadmin` on the server "
"directly is convenient, because the entry for the host principal in the KDC "
"database is also created using `kadmin`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:735
msgid ""
"Of course, `kadmin` is a kerberized service; a Kerberos ticket is needed to "
"authenticate to the network service, but to ensure that the user running "
"`kadmin` is actually present (and their session has not been hijacked), "
"`kadmin` will prompt for the password to get a fresh ticket. The principal "
"authenticating to the kadmin service must be permitted to use the `kadmin` "
"interface, as specified in [.filename]#/var/heimdal/kadmind.acl#. See the "
"section titled \"Remote administration\" in `info heimdal` for details on "
"designing access control lists. Instead of enabling remote `kadmin` access, "
"the administrator could securely connect to the KDC via the local console or "
"man:ssh[1], and perform administration locally using `kadmin -l`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:737
msgid ""
"After installing [.filename]#/etc/krb5.conf#, use `add --random-key` in "
"`kadmin`. This adds the server's host principal to the database, but does "
"not extract a copy of the host principal key to a keytab. To generate the "
"keytab, use `ext` to extract the server's host principal key to its own "
"keytab:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:749
#, no-wrap
msgid ""
"# kadmin\n"
"kadmin> add --random-key host/myserver.example.org\n"
"Max ticket life [unlimited]:\n"
"Max renewable life [unlimited]:\n"
"Principal expiration time [never]:\n"
"Password expiration time [never]:\n"
"Attributes []:\n"
"kadmin> ext_keytab host/myserver.example.org\n"
"kadmin> exit\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:752
msgid ""
"Note that `ext_keytab` stores the extracted key in [.filename]#/etc/krb5."
"keytab# by default. This is good when being run on the server being "
"kerberized, but the `--keytab _path/to/file_` argument should be used when "
"the keytab is being extracted elsewhere:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:758
#, no-wrap
msgid ""
"# kadmin\n"
"kadmin> ext_keytab --keytab=/tmp/example.keytab host/myserver.example.org\n"
"kadmin> exit\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:761
msgid ""
"The keytab can then be securely copied to the server using man:scp[1] or a "
"removable media. Be sure to specify a non-default keytab name to avoid "
"inserting unneeded keys into the system's keytab."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:763
msgid ""
"At this point, the server can read encrypted messages from the KDC using its "
"shared key, stored in [.filename]#krb5.keytab#. It is now ready for the "
"Kerberos-using services to be enabled. One of the most common such services "
"is man:sshd[8], which supports Kerberos via the GSS-API. In [.filename]#/etc/"
"ssh/sshd_config#, add the line:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:767
#, no-wrap
msgid "GSSAPIAuthentication yes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:770
msgid ""
"After making this change, man:sshd[8] must be restarted for the new "
"configuration to take effect: `service sshd restart`."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:771
#, no-wrap
msgid "Configuring a Client to Use Kerberos"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:774
msgid ""
"As it was for the server, the client requires configuration in [.filename]#/"
"etc/krb5.conf#. Copy the file in place (securely) or re-enter it as needed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:776
msgid ""
"Test the client by using `kinit`, `klist`, and `kdestroy` from the client to "
"obtain, show, and then delete a ticket for an existing principal. Kerberos "
"applications should also be able to connect to Kerberos enabled servers. If "
"that does not work but obtaining a ticket does, the problem is likely with "
"the server and not with the client or the KDC. In the case of kerberized man:"
"ssh[1], GSS-API is disabled by default, so test using `ssh -o "
"GSSAPIAuthentication=yes _hostname_`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:778
msgid ""
"When testing a Kerberized application, try using a packet sniffer such as "
"`tcpdump` to confirm that no sensitive information is sent in the clear."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:780
msgid ""
"Various Kerberos client applications are available. With the advent of a "
"bridge so that applications using SASL for authentication can use GSS-API "
"mechanisms as well, large classes of client applications can use Kerberos "
"for authentication, from Jabber clients to IMAP clients."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:782
msgid ""
"Users within a realm typically have their Kerberos principal mapped to a "
"local user account. Occasionally, one needs to grant access to a local user "
"account to someone who does not have a matching Kerberos principal. For "
"example, `tillman@EXAMPLE.ORG` may need access to the local user account "
"`webdevelopers`. Other principals may also need access to that local account."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:784
msgid ""
"The [.filename]#.k5login# and [.filename]#.k5users# files, placed in a "
"user's home directory, can be used to solve this problem. For example, if "
"the following [.filename]#.k5login# is placed in the home directory of "
"`webdevelopers`, both principals listed will have access to that account "
"without requiring a shared password:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:789
#, no-wrap
msgid ""
"tillman@example.org\n"
"jdoe@example.org\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:792
msgid "Refer to man:ksu[1] for more information about [.filename]#.k5users#."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:793
#, no-wrap
msgid "MIT Differences"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:796
msgid ""
"The major difference between the MIT and Heimdal implementations is that "
"`kadmin` has a different, but equivalent, set of commands and uses a "
"different protocol. If the KDC is MIT, the Heimdal version of `kadmin` "
"cannot be used to administer the KDC remotely, and vice versa."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:798
msgid ""
"Client applications may also use slightly different command line options to "
"accomplish the same tasks. Following the instructions at http://web.mit.edu/"
"Kerberos/www/[http://web.mit.edu/Kerberos/www/] is recommended. Be careful "
"of path issues: the MIT port installs into [.filename]#/usr/local/# by "
"default, and the FreeBSD system applications run instead of the MIT versions "
"if `PATH` lists the system directories first."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:800
msgid ""
"When using MIT Kerberos as a KDC on FreeBSD, the following edits should also "
"be made to [.filename]#rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:808
#, no-wrap
msgid ""
"kdc_program=\"/usr/local/sbin/kdc\"\n"
"kadmind_program=\"/usr/local/sbin/kadmind\"\n"
"kdc_flags=\"\"\n"
"kdc_enable=\"YES\"\n"
"kadmind_enable=\"YES\"\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:810
#, no-wrap
msgid "Kerberos Tips, Tricks, and Troubleshooting"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:813
msgid ""
"When configuring and troubleshooting Kerberos, keep the following points in "
"mind:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:815
msgid ""
"When using either Heimdal or MITKerberos from ports, ensure that the `PATH` "
"lists the port's versions of the client applications before the system "
"versions."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:816
msgid ""
"If all the computers in the realm do not have synchronized time settings, "
"authentication may fail. crossref:network-servers[network-ntp,“Clock "
"Synchronization with NTP”] describes how to synchronize clocks using NTP."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:817
msgid ""
"If the hostname is changed, the `host/` principal must be changed and the "
"keytab updated. This also applies to special keytab entries like the `HTTP/` "
"principal used for Apache's package:www/mod_auth_kerb[]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:818
msgid ""
"All hosts in the realm must be both forward and reverse resolvable in DNS "
"or, at a minimum, exist in [.filename]#/etc/hosts#. CNAMEs will work, but "
"the A and PTR records must be correct and in place. The error message for "
"unresolvable hosts is not intuitive: `Kerberos5 refuses authentication "
"because Read req failed: Key table entry not found`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:819
msgid ""
"Some operating systems that act as clients to the KDC do not set the "
"permissions for `ksu` to be setuid `root`. This means that `ksu` does not "
"work. This is a permissions problem, not a KDC error."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:820
msgid ""
"With MITKerberos, to allow a principal to have a ticket life longer than the "
"default lifetime of ten hours, use `modify_principal` at the man:kadmin[8] "
"prompt to change the `maxlife` of both the principal in question and the "
"`krbtgt` principal. The principal can then use `kinit -l` to request a "
"ticket with a longer lifetime."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:821
msgid ""
"When running a packet sniffer on the KDC to aid in troubleshooting while "
"running `kinit` from a workstation, the Ticket Granting Ticket (TGT) is sent "
"immediately, even before the password is typed. This is because the Kerberos "
"server freely transmits a TGT to any unauthorized request. However, every "
"TGT is encrypted in a key derived from the user's password. When a user "
"types their password, it is not sent to the KDC, it is instead used to "
"decrypt the TGT that `kinit` already obtained. If the decryption process "
"results in a valid ticket with a valid time stamp, the user has valid "
"Kerberos credentials. These credentials include a session key for "
"establishing secure communications with the Kerberos server in the future, "
"as well as the actual TGT, which is encrypted with the Kerberos server's own "
"key. This second layer of encryption allows the Kerberos server to verify "
"the authenticity of each TGT."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:822
msgid ""
"Host principals can have a longer ticket lifetime. If the user principal has "
"a lifetime of a week but the host being connected to has a lifetime of nine "
"hours, the user cache will have an expired host principal and the ticket "
"cache will not work as expected."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:823
msgid ""
"When setting up [.filename]#krb5.dict# to prevent specific bad passwords "
"from being used as described in man:kadmind[8], remember that it only "
"applies to principals that have a password policy assigned to them. The "
"format used in [.filename]#krb5.dict# is one string per line. Creating a "
"symbolic link to [.filename]#/usr/share/dict/words# might be useful."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:824
#, no-wrap
msgid "Mitigating Kerberos Limitations"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:827
msgid ""
"Since Kerberos is an all or nothing approach, every service enabled on the "
"network must either be modified to work with Kerberos or be otherwise "
"secured against network attacks. This is to prevent user credentials from "
"being stolen and re-used. An example is when Kerberos is enabled on all "
"remote shells but the non-Kerberized POP3 mail server sends passwords in "
"plain text."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:829
msgid ""
"The KDC is a single point of failure. By design, the KDC must be as secure "
"as its master password database. The KDC should have absolutely no other "
"services running on it and should be physically secure. The danger is high "
"because Kerberos stores all passwords encrypted with the same master key "
"which is stored as a file on the KDC."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:831
msgid ""
"A compromised master key is not quite as bad as one might fear. The master "
"key is only used to encrypt the Kerberos database and as a seed for the "
"random number generator. As long as access to the KDC is secure, an attacker "
"cannot do much with the master key."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:833
msgid ""
"If the KDC is unavailable, network services are unusable as authentication "
"cannot be performed. This can be alleviated with a single master KDC and one "
"or more slaves, and with careful implementation of secondary or fall-back "
"authentication using PAM."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:835
msgid ""
"Kerberos allows users, hosts and services to authenticate between "
"themselves. It does not have a mechanism to authenticate the KDC to the "
"users, hosts, or services. This means that a trojaned `kinit` could record "
"all user names and passwords. File system integrity checking tools like "
"package:security/tripwire[] can alleviate this."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:836
#, no-wrap
msgid "Resources and Further Information"
msgstr "相關資源與延伸資訊"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:839
msgid ""
"http://www.faqs.org/faqs/Kerberos-faq/general/preamble.html[The Kerberos FAQ]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:840
msgid ""
"http://web.mit.edu/Kerberos/www/dialogue.html[Designing an Authentication "
"System: a Dialog in Four Scenes]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:841
msgid ""
"https://www.ietf.org/rfc/rfc4120.txt[RFC 4120, The Kerberos Network "
"Authentication Service (V5)]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:842
msgid "http://web.mit.edu/Kerberos/www/[MIT Kerberos home page]"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:843
msgid ""
"https://github.com/heimdal/heimdal/wiki[Heimdal Kerberos project wiki page]"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:845
#, no-wrap
msgid "OpenSSL"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:848
msgid ""
"OpenSSL is an open source implementation of the SSL and TLS protocols. It "
"provides an encryption transport layer on top of the normal communications "
"layer, allowing it to be intertwined with many network applications and "
"services."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:850
msgid ""
"The version of OpenSSL included in FreeBSD supports the Secure Sockets Layer "
"3.0 (SSLv3) and Transport Layer Security 1.0/1.1/1.2 (TLSv1/TLSv1.1/TLSv1.2) "
"network security protocols and can be used as a general cryptographic "
"library. In FreeBSD 12.0-RELEASE and above, OpenSSL also supports Transport "
"Layer Security 1.3 (TLSv1.3)."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:852
msgid ""
"OpenSSL is often used to encrypt authentication of mail clients and to "
"secure web based transactions such as credit card payments. Some ports, such "
"as package:www/apache24[] and package:databases/postgresql11-server[], "
"include a compile option for building with OpenSSL. If selected, the port "
"will add support using OpenSSL from the base system. To instead have the "
"port compile against OpenSSL from the package:security/openssl[] port, add "
"the following to [.filename]#/etc/make.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:856
#, no-wrap
msgid "DEFAULT_VERSIONS+= ssl=openssl\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:859
msgid ""
"Another common use of OpenSSL is to provide certificates for use with "
"software applications. Certificates can be used to verify the credentials of "
"a company or individual. If a certificate has not been signed by an external "
"_Certificate Authority_ (CA), such as http://www.verisign.com[http://www."
"verisign.com], the application that uses the certificate will produce a "
"warning. There is a cost associated with obtaining a signed certificate and "
"using a signed certificate is not mandatory as certificates can be self-"
"signed. However, using an external authority will prevent warnings and can "
"put users at ease."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:861
msgid ""
"This section demonstrates how to create and use certificates on a FreeBSD "
"system. Refer to crossref:network-servers[ldap-config,“Configuring an LDAP "
"Server”] for an example of how to create a CA for signing one's own "
"certificates."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:863
msgid ""
"For more information about SSL, read the free https://www.feistyduck.com/"
"books/openssl-cookbook/[OpenSSL Cookbook]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:864
#, no-wrap
msgid "Generating Certificates"
msgstr "產生憑証"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:867
msgid ""
"To generate a certificate that will be signed by an external CA, issue the "
"following command and input the information requested at the prompts. This "
"input information will be written to the certificate. At the `Common Name` "
"prompt, input the fully qualified name for the system that will use the "
"certificate. If this name does not match the server, the application "
"verifying the certificate will issue a warning to the user, rendering the "
"verification provided by the certificate as useless."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:890
#, no-wrap
msgid ""
"# openssl req -new -nodes -out req.pem -keyout cert.key -sha256 -newkey rsa:2048\n"
"Generating a 2048 bit RSA private key\n"
"..................+++\n"
".............................................................+++\n"
"writing new private key to 'cert.key'\n"
"-----\n"
"You are about to be asked to enter information that will be incorporated\n"
"into your certificate request.\n"
"What you are about to enter is what is called a Distinguished Name or a DN.\n"
"There are quite a few fields but you can leave some blank\n"
"For some fields there will be a default value,\n"
"If you enter '.', the field will be left blank.\n"
"-----\n"
"Country Name (2 letter code) [AU]:US\n"
"State or Province Name (full name) [Some-State]:PA\n"
"Locality Name (eg, city) []:Pittsburgh\n"
"Organization Name (eg, company) [Internet Widgits Pty Ltd]:My Company\n"
"Organizational Unit Name (eg, section) []:Systems Administrator\n"
"Common Name (eg, YOUR name) []:localhost.example.org\n"
"Email Address []:trhodes@FreeBSD.org\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:895
#, no-wrap
msgid ""
"Please enter the following 'extra' attributes\n"
"to be sent with your certificate request\n"
"A challenge password []:\n"
"An optional company name []:Another Name\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:898
msgid ""
"Other options, such as the expire time and alternate encryption algorithms, "
"are available when creating a certificate. A complete list of options is "
"described in man:openssl[1]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:900
msgid ""
"This command will create two files in the current directory. The certificate "
"request, [.filename]#req.pem#, can be sent to a CA who will validate the "
"entered credentials, sign the request, and return the signed certificate. "
"The second file, [.filename]#cert.key#, is the private key for the "
"certificate and should be stored in a secure location. If this falls in the "
"hands of others, it can be used to impersonate the user or the server."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:902
msgid ""
"Alternately, if a signature from a CA is not required, a self-signed "
"certificate can be created. First, generate the RSA key:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:911
#, no-wrap
msgid ""
"# openssl genrsa -rand -genkey -out cert.key 2048\n"
"0 semi-random bytes loaded\n"
"Generating RSA private key, 2048 bit long modulus\n"
".............................................+++\n"
".................................................................................................................+++\n"
"e is 65537 (0x10001)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:914
msgid ""
"Use this key to create a self-signed certificate. Follow the usual prompts "
"for creating a certificate:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:932
#, no-wrap
msgid ""
"# openssl req -new -x509 -days 365 -key cert.key -out cert.crt -sha256\n"
"You are about to be asked to enter information that will be incorporated\n"
"into your certificate request.\n"
"What you are about to enter is what is called a Distinguished Name or a DN.\n"
"There are quite a few fields but you can leave some blank\n"
"For some fields there will be a default value,\n"
"If you enter '.', the field will be left blank.\n"
"-----\n"
"Country Name (2 letter code) [AU]:US\n"
"State or Province Name (full name) [Some-State]:PA\n"
"Locality Name (eg, city) []:Pittsburgh\n"
"Organization Name (eg, company) [Internet Widgits Pty Ltd]:My Company\n"
"Organizational Unit Name (eg, section) []:Systems Administrator\n"
"Common Name (e.g. server FQDN or YOUR name) []:localhost.example.org\n"
"Email Address []:trhodes@FreeBSD.org\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:935
msgid ""
"This will create two new files in the current directory: a private key file "
"[.filename]#cert.key#, and the certificate itself, [.filename]#cert.crt#. "
"These should be placed in a directory, preferably under [.filename]#/etc/ssl/"
"#, which is readable only by `root`. Permissions of `0700` are appropriate "
"for these files and can be set using `chmod`."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:936
#, no-wrap
msgid "Using Certificates"
msgstr "使用憑證"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:939
msgid ""
"One use for a certificate is to encrypt connections to the Sendmail mail "
"server in order to prevent the use of clear text authentication."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:943
msgid ""
"Some mail clients will display an error if the user has not installed a "
"local copy of the certificate. Refer to the documentation included with the "
"software for more information on certificate installation."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:946
msgid ""
"In FreeBSD 10.0-RELEASE and above, it is possible to create a self-signed "
"certificate for Sendmail automatically. To enable this, add the following "
"lines to [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:952
#, no-wrap
msgid ""
"sendmail_enable=\"YES\"\n"
"sendmail_cert_create=\"YES\"\n"
"sendmail_cert_cn=\"localhost.example.org\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:955
msgid ""
"This will automatically create a self-signed certificate, [.filename]#/etc/"
"mail/certs/host.cert#, a signing key, [.filename]#/etc/mail/certs/host.key#, "
"and a CA certificate, [.filename]#/etc/mail/certs/cacert.pem#. The "
"certificate will use the `Common Name` specified in `sendmail_cert_cn`. "
"After saving the edits, restart Sendmail:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:959
#, no-wrap
msgid "# service sendmail restart\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:962
msgid ""
"If all went well, there will be no error messages in [.filename]#/var/log/"
"maillog#. For a simple test, connect to the mail server's listening port "
"using `telnet`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:985
#, no-wrap
msgid ""
"# telnet example.com 25\n"
"Trying 192.0.34.166...\n"
"Connected to example.com.\n"
"Escape character is '^]'.\n"
"220 example.com ESMTP Sendmail 8.14.7/8.14.7; Fri, 18 Apr 2014 11:50:32 -0400 (EDT)\n"
"ehlo example.com\n"
"250-example.com Hello example.com [192.0.34.166], pleased to meet you\n"
"250-ENHANCEDSTATUSCODES\n"
"250-PIPELINING\n"
"250-8BITMIME\n"
"250-SIZE\n"
"250-DSN\n"
"250-ETRN\n"
"250-AUTH LOGIN PLAIN\n"
"250-STARTTLS\n"
"250-DELIVERBY\n"
"250 HELP\n"
"quit\n"
"221 2.0.0 example.com closing connection\n"
"Connection closed by foreign host.\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:988
msgid ""
"If the `STARTTLS` line appears in the output, everything is working "
"correctly."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:990
#, no-wrap
msgid "VPN over IPsec"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:993
msgid ""
"Internet Protocol Security (IPsec) is a set of protocols which sit on top of "
"the Internet Protocol (IP) layer. It allows two or more hosts to communicate "
"in a secure manner by authenticating and encrypting each IP packet of a "
"communication session. The FreeBSD IPsec network stack is based on the "
"http://www.kame.net/[http://www.kame.net/] implementation and supports both "
"IPv4 and IPv6 sessions."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:995
msgid "IPsec is comprised of the following sub-protocols:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:997
msgid ""
"_Encapsulated Security Payload (ESP)_: this protocol protects the IP packet "
"data from third party interference by encrypting the contents using "
"symmetric cryptography algorithms such as Blowfish and 3DES."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:998
msgid ""
"_Authentication Header (AH)_: this protocol protects the IP packet header "
"from third party interference and spoofing by computing a cryptographic "
"checksum and hashing the IP packet header fields with a secure hashing "
"function. This is then followed by an additional header that contains the "
"hash, to allow the information in the packet to be authenticated."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:999
msgid ""
"_IP Payload Compression Protocol (IPComp_): this protocol tries to increase "
"communication performance by compressing the IP payload in order to reduce "
"the amount of data sent."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1001
msgid ""
"These protocols can either be used together or separately, depending on the "
"environment."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1003
msgid ""
"IPsec supports two modes of operation. The first mode, _Transport Mode_, "
"protects communications between two hosts. The second mode, _Tunnel Mode_, "
"is used to build virtual tunnels, commonly known as Virtual Private Networks "
"(VPNs). Consult man:ipsec[4] for detailed information on the IPsec subsystem "
"in FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1005
msgid ""
"IPsec support is enabled by default on FreeBSD 11 and later. For previous "
"versions of FreeBSD, add these options to a custom kernel configuration file "
"and rebuild the kernel using the instructions in crossref:"
"kernelconfig[kernelconfig,Configuring the FreeBSD Kernel]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1010
#, no-wrap
msgid ""
"options   IPSEC        IP security\n"
"device    crypto\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1013
msgid ""
"If IPsec debugging support is desired, the following kernel option should "
"also be added:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1017
#, no-wrap
msgid "options   IPSEC_DEBUG  debug for IP security\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1020
msgid ""
"This rest of this chapter demonstrates the process of setting up an IPsecVPN "
"between a home network and a corporate network. In the example scenario:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1022
msgid ""
"Both sites are connected to the Internet through a gateway that is running "
"FreeBSD."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1023
msgid ""
"The gateway on each network has at least one external IP address. In this "
"example, the corporate LAN's external IP address is `172.16.5.4` and the "
"home LAN's external IP address is `192.168.1.12`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1024
msgid ""
"The internal addresses of the two networks can be either public or private "
"IP addresses. However, the address space must not collide. For example, both "
"networks cannot use `192.168.1.x`. In this example, the corporate LAN's "
"internal IP address is `10.246.38.1` and the home LAN's internal IP address "
"is `10.0.0.5`."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1025
#, no-wrap
msgid "Configuring a VPN on FreeBSD"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1028
msgid ""
"To begin, package:security/ipsec-tools[] must be installed from the Ports "
"Collection. This software provides a number of applications which support "
"the configuration."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1030
msgid ""
"The next requirement is to create two man:gif[4] pseudo-devices which will "
"be used to tunnel packets and allow both networks to communicate properly. "
"As `root`, run the following commands, replacing _internal_ and _external_ "
"with the real IP addresses of the internal and external interfaces of the "
"two gateways:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1036
#, no-wrap
msgid ""
"# ifconfig gif0 create\n"
"# ifconfig gif0 internal1 internal2\n"
"# ifconfig gif0 tunnel external1 external2\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1039
msgid ""
"Verify the setup on each gateway, using `ifconfig`. Here is the output from "
"Gateway 1:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1046
#, no-wrap
msgid ""
"gif0: flags=8051 mtu 1280\n"
"tunnel inet 172.16.5.4 --> 192.168.1.12\n"
"inet6 fe80::2e0:81ff:fe02:5881%gif0 prefixlen 64 scopeid 0x6\n"
"inet 10.246.38.1 --> 10.0.0.5 netmask 0xffffff00\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1049
msgid "Here is the output from Gateway 2:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1056
#, no-wrap
msgid ""
"gif0: flags=8051 mtu 1280\n"
"tunnel inet 192.168.1.12 --> 172.16.5.4\n"
"inet 10.0.0.5 --> 10.246.38.1 netmask 0xffffff00\n"
"inet6 fe80::250:bfff:fe3a:c1f%gif0 prefixlen 64 scopeid 0x4\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1059
msgid ""
"Once complete, both internal IP addresses should be reachable using man:"
"ping[8]:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1071
#, no-wrap
msgid ""
"priv-net# ping 10.0.0.5\n"
"PING 10.0.0.5 (10.0.0.5): 56 data bytes\n"
"64 bytes from 10.0.0.5: icmp_seq=0 ttl=64 time=42.786 ms\n"
"64 bytes from 10.0.0.5: icmp_seq=1 ttl=64 time=19.255 ms\n"
"64 bytes from 10.0.0.5: icmp_seq=2 ttl=64 time=20.440 ms\n"
"64 bytes from 10.0.0.5: icmp_seq=3 ttl=64 time=21.036 ms\n"
"--- 10.0.0.5 ping statistics ---\n"
"4 packets transmitted, 4 packets received, 0% packet loss\n"
"round-trip min/avg/max/stddev = 19.255/25.879/42.786/9.782 ms\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1082
#, no-wrap
msgid ""
"corp-net# ping 10.246.38.1\n"
"PING 10.246.38.1 (10.246.38.1): 56 data bytes\n"
"64 bytes from 10.246.38.1: icmp_seq=0 ttl=64 time=28.106 ms\n"
"64 bytes from 10.246.38.1: icmp_seq=1 ttl=64 time=42.917 ms\n"
"64 bytes from 10.246.38.1: icmp_seq=2 ttl=64 time=127.525 ms\n"
"64 bytes from 10.246.38.1: icmp_seq=3 ttl=64 time=119.896 ms\n"
"64 bytes from 10.246.38.1: icmp_seq=4 ttl=64 time=154.524 ms\n"
"--- 10.246.38.1 ping statistics ---\n"
"5 packets transmitted, 5 packets received, 0% packet loss\n"
"round-trip min/avg/max/stddev = 28.106/94.594/154.524/49.814 ms\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1085
msgid ""
"As expected, both sides have the ability to send and receive ICMP packets "
"from the privately configured addresses. Next, both gateways must be told "
"how to route packets in order to correctly send traffic from either network. "
"The following commands will achieve this goal:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1092
#, no-wrap
msgid ""
"corp-net# route add 10.0.0.0 10.0.0.5 255.255.255.0\n"
"corp-net# route add net 10.0.0.0: gateway 10.0.0.5\n"
"priv-net# route add 10.246.38.0 10.246.38.1 255.255.255.0\n"
"priv-net# route add host 10.246.38.0: gateway 10.246.38.1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1095
msgid ""
"At this point, internal machines should be reachable from each gateway as "
"well as from machines behind the gateways. Again, use man:ping[8] to confirm:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1108
#, no-wrap
msgid ""
"corp-net# ping 10.0.0.8\n"
"PING 10.0.0.8 (10.0.0.8): 56 data bytes\n"
"64 bytes from 10.0.0.8: icmp_seq=0 ttl=63 time=92.391 ms\n"
"64 bytes from 10.0.0.8: icmp_seq=1 ttl=63 time=21.870 ms\n"
"64 bytes from 10.0.0.8: icmp_seq=2 ttl=63 time=198.022 ms\n"
"64 bytes from 10.0.0.8: icmp_seq=3 ttl=63 time=22.241 ms\n"
"64 bytes from 10.0.0.8: icmp_seq=4 ttl=63 time=174.705 ms\n"
"--- 10.0.0.8 ping statistics ---\n"
"5 packets transmitted, 5 packets received, 0% packet loss\n"
"round-trip min/avg/max/stddev = 21.870/101.846/198.022/74.001 ms\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1119
#, no-wrap
msgid ""
"priv-net# ping 10.246.38.107\n"
"PING 10.246.38.1 (10.246.38.107): 56 data bytes\n"
"64 bytes from 10.246.38.107: icmp_seq=0 ttl=64 time=53.491 ms\n"
"64 bytes from 10.246.38.107: icmp_seq=1 ttl=64 time=23.395 ms\n"
"64 bytes from 10.246.38.107: icmp_seq=2 ttl=64 time=23.865 ms\n"
"64 bytes from 10.246.38.107: icmp_seq=3 ttl=64 time=21.145 ms\n"
"64 bytes from 10.246.38.107: icmp_seq=4 ttl=64 time=36.708 ms\n"
"--- 10.246.38.107 ping statistics ---\n"
"5 packets transmitted, 5 packets received, 0% packet loss\n"
"round-trip min/avg/max/stddev = 21.145/31.721/53.491/12.179 ms\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1122
msgid ""
"Setting up the tunnels is the easy part. Configuring a secure link is a more "
"in depth process. The following configuration uses pre-shared (PSK) RSA "
"keys. Other than the IP addresses, the [.filename]#/usr/local/etc/racoon/"
"racoon.conf# on both gateways will be identical and look similar to:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1127
#, no-wrap
msgid ""
"path    pre_shared_key  \"/usr/local/etc/racoon/psk.txt\"; #location of pre-shared key file\n"
"log     debug;\t#log verbosity setting: set to 'notify' when testing and debugging is complete\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1135
#, no-wrap
msgid ""
"padding\t# options are not to be changed\n"
"{\n"
"        maximum_length  20;\n"
"        randomize       off;\n"
"        strict_check    off;\n"
"        exclusive_tail  off;\n"
"}\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1145
#, no-wrap
msgid ""
"timer\t# timing options. change as needed\n"
"{\n"
"        counter         5;\n"
"        interval        20 sec;\n"
"        persend         1;\n"
"#       natt_keepalive  15 sec;\n"
"        phase1          30 sec;\n"
"        phase2          15 sec;\n"
"}\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1151
#, no-wrap
msgid ""
"listen\t# address [port] that racoon will listen on\n"
"{\n"
"        isakmp          172.16.5.4 [500];\n"
"        isakmp_natt     172.16.5.4 [4500];\n"
"}\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1164
#, no-wrap
msgid ""
"remote  192.168.1.12 [500]\n"
"{\n"
"        exchange_mode   main,aggressive;\n"
"        doi             ipsec_doi;\n"
"        situation       identity_only;\n"
"        my_identifier   address 172.16.5.4;\n"
"        peers_identifier        address 192.168.1.12;\n"
"        lifetime        time 8 hour;\n"
"        passive         off;\n"
"        proposal_check  obey;\n"
"#       nat_traversal   off;\n"
"        generate_policy off;\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1173
#, no-wrap
msgid ""
"                        proposal {\n"
"                                encryption_algorithm    blowfish;\n"
"                                hash_algorithm          md5;\n"
"                                authentication_method   pre_shared_key;\n"
"                                lifetime time           30 sec;\n"
"                                dh_group                1;\n"
"                        }\n"
"}\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1182
#, no-wrap
msgid ""
"sainfo  (address 10.246.38.0/24 any address 10.0.0.0/24 any)\t# address $network/$netmask $type address $network/$netmask $type ( $type being any or esp)\n"
"{\t\t\t\t\t\t\t\t# $network must be the two internal networks you are joining.\n"
"        pfs_group       1;\n"
"        lifetime        time    36000 sec;\n"
"        encryption_algorithm    blowfish,3des;\n"
"        authentication_algorithm        hmac_md5,hmac_sha1;\n"
"        compression_algorithm   deflate;\n"
"}\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1185
msgid ""
"For descriptions of each available option, refer to the manual page for [."
"filename]#racoon.conf#."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1187
msgid ""
"The Security Policy Database (SPD) needs to be configured so that FreeBSD "
"and racoon are able to encrypt and decrypt network traffic between the hosts."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1189
msgid ""
"This can be achieved with a shell script, similar to the following, on the "
"corporate gateway. This file will be used during system initialization and "
"should be saved as [.filename]#/usr/local/etc/racoon/setkey.conf#."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1197
#, no-wrap
msgid ""
"flush;\n"
"spdflush;\n"
"# To the home network\n"
"spdadd 10.246.38.0/24 10.0.0.0/24 any -P out ipsec esp/tunnel/172.16.5.4-192.168.1.12/use;\n"
"spdadd 10.0.0.0/24 10.246.38.0/24 any -P in ipsec esp/tunnel/192.168.1.12-172.16.5.4/use;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1200
msgid ""
"Once in place, racoon may be started on both gateways using the following "
"command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1204
#, no-wrap
msgid "# /usr/local/sbin/racoon -F -f /usr/local/etc/racoon/racoon.conf -l /var/log/racoon.log\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1207
msgid "The output should be similar to the following:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1222
#, no-wrap
msgid ""
"corp-net# /usr/local/sbin/racoon -F -f /usr/local/etc/racoon/racoon.conf\n"
"Foreground mode.\n"
"2006-01-30 01:35:47: INFO: begin Identity Protection mode.\n"
"2006-01-30 01:35:48: INFO: received Vendor ID: KAME/racoon\n"
"2006-01-30 01:35:55: INFO: received Vendor ID: KAME/racoon\n"
"2006-01-30 01:36:04: INFO: ISAKMP-SA established 172.16.5.4[500]-192.168.1.12[500] spi:623b9b3bd2492452:7deab82d54ff704a\n"
"2006-01-30 01:36:05: INFO: initiate new phase 2 negotiation: 172.16.5.4[0]192.168.1.12[0]\n"
"2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 192.168.1.12[0]->172.16.5.4[0] spi=28496098(0x1b2d0e2)\n"
"2006-01-30 01:36:09: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]->192.168.1.12[0] spi=47784998(0x2d92426)\n"
"2006-01-30 01:36:13: INFO: respond new phase 2 negotiation: 172.16.5.4[0]192.168.1.12[0]\n"
"2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 192.168.1.12[0]->172.16.5.4[0] spi=124397467(0x76a279b)\n"
"2006-01-30 01:36:18: INFO: IPsec-SA established: ESP/Tunnel 172.16.5.4[0]->192.168.1.12[0] spi=175852902(0xa7b4d66)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1225
msgid ""
"To ensure the tunnel is working properly, switch to another console and use "
"man:tcpdump[1] to view network traffic using the following command. Replace "
"`em0` with the network interface card as required:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1229
#, no-wrap
msgid "# tcpdump -i em0 host 172.16.5.4 and dst 192.168.1.12\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1232
msgid ""
"Data similar to the following should appear on the console. If not, there is "
"an issue and debugging the returned data will be required."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1238
#, no-wrap
msgid ""
"01:47:32.021683 IP corporatenetwork.com > 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xa)\n"
"01:47:33.022442 IP corporatenetwork.com > 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xb)\n"
"01:47:34.024218 IP corporatenetwork.com > 192.168.1.12.privatenetwork.com: ESP(spi=0x02acbf9f,seq=0xc)\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1241
msgid ""
"At this point, both networks should be available and seem to be part of the "
"same network. Most likely both networks are protected by a firewall. To "
"allow traffic to flow between them, rules need to be added to pass packets. "
"For the man:ipfw[8] firewall, add the following lines to the firewall "
"configuration file:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1248
#, no-wrap
msgid ""
"ipfw add 00201 allow log esp from any to any\n"
"ipfw add 00202 allow log ah from any to any\n"
"ipfw add 00203 allow log ipencap from any to any\n"
"ipfw add 00204 allow log udp from any 500 to any\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1253
msgid ""
"The rule numbers may need to be altered depending on the current host "
"configuration."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1256
msgid ""
"For users of man:pf[4] or man:ipf[8], the following rules should do the "
"trick:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1269
#, no-wrap
msgid ""
"pass in quick proto esp from any to any\n"
"pass in quick proto ah from any to any\n"
"pass in quick proto ipencap from any to any\n"
"pass in quick proto udp from any port = 500 to any port = 500\n"
"pass in quick on gif0 from any to any\n"
"pass out quick proto esp from any to any\n"
"pass out quick proto ah from any to any\n"
"pass out quick proto ipencap from any to any\n"
"pass out quick proto udp from any port = 500 to any port = 500\n"
"pass out quick on gif0 from any to any\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1272
msgid ""
"Finally, to allow the machine to start support for the VPN during system "
"initialization, add the following lines to [.filename]#/etc/rc.conf#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1279
#, no-wrap
msgid ""
"ipsec_enable=\"YES\"\n"
"ipsec_program=\"/usr/local/sbin/setkey\"\n"
"ipsec_file=\"/usr/local/etc/racoon/setkey.conf\" # allows setting up spd policies on boot\n"
"racoon_enable=\"yes\"\n"
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:1282
#, no-wrap
msgid "OpenSSH"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1285
msgid ""
"OpenSSH is a set of network connectivity tools used to provide secure access "
"to remote machines. Additionally, TCP/IP connections can be tunneled or "
"forwarded securely through SSH connections. OpenSSH encrypts all traffic to "
"effectively eliminate eavesdropping, connection hijacking, and other network-"
"level attacks."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1287
msgid ""
"OpenSSH is maintained by the OpenBSD project and is installed by default in "
"FreeBSD. It is compatible with both SSH version 1 and 2 protocols."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1289
msgid ""
"When data is sent over the network in an unencrypted form, network sniffers "
"anywhere in between the client and server can steal user/password "
"information or data transferred during the session. OpenSSH offers a variety "
"of authentication and encryption methods to prevent this from happening. "
"More information about OpenSSH is available from http://www.openssh.com/"
"[http://www.openssh.com/]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1291
#, fuzzy
msgid ""
"This section provides an overview of the built-in client utilities to "
"securely access other systems and securely transfer files from a FreeBSD "
"system. It then describes how to configure a SSH server on a FreeBSD system. "
"More information is available in the man pages mentioned in this chapter."
msgstr ""
"本節會簡單介紹如何使用內建的客戶端工具安全的存取其他系統及安全的傳輸檔案到 FreeBSD 系統，然後會說明如何設定在 FreeBSD 系統上的 "
"<acronym>SSH</acronym> 伺服器。更多的資訊可於本章節所提及的操作手冊 (Man page) 取得。"

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1292
#, no-wrap
msgid "Using the SSH Client Utilities"
msgstr "使用 SSH 客戶端工具"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1295
msgid ""
"To log into a SSH server, use `ssh` and specify a username that exists on "
"that server and the IP address or hostname of the server. If this is the "
"first time a connection has been made to the specified server, the user will "
"be prompted to first verify the server's fingerprint:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1304
#, no-wrap
msgid ""
"# ssh user@example.com\n"
"The authenticity of host 'example.com (10.0.0.1)' can't be established.\n"
"ECDSA key fingerprint is 25:cc:73:b5:b3:96:75:3d:56:19:49:d2:5c:1f:91:3b.\n"
"Are you sure you want to continue connecting (yes/no)? yes\n"
"Permanently added 'example.com' (ECDSA) to the list of known hosts.\n"
"Password for user@example.com: user_password\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1307
msgid ""
"SSH utilizes a key fingerprint system to verify the authenticity of the "
"server when the client connects. When the user accepts the key's fingerprint "
"by typing `yes` when connecting for the first time, a copy of the key is "
"saved to [.filename]#.ssh/known_hosts# in the user's home directory. Future "
"attempts to login are verified against the saved key and `ssh` will display "
"an alert if the server's key does not match the saved key. If this occurs, "
"the user should first verify why the key has changed before continuing with "
"the connection."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1309
msgid ""
"By default, recent versions of OpenSSH only accept SSHv2 connections. By "
"default, the client will use version 2 if possible and will fall back to "
"version 1 if the server does not support version 2. To force `ssh` to only "
"use the specified protocol, include `-1` or `-2`. Additional options are "
"described in man:ssh[1]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1311
msgid ""
"Use man:scp[1] to securely copy a file to or from a remote machine. This "
"example copies [.filename]#COPYRIGHT# on the remote system to a file of the "
"same name in the current directory of the local system:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1319
#, no-wrap
msgid ""
"# scp user@example.com:/COPYRIGHT COPYRIGHT\n"
"Password for user@example.com: *******\n"
"COPYRIGHT            100% |*****************************|  4735\n"
"00:00\n"
"#\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1322
msgid ""
"Since the fingerprint was already verified for this host, the server's key "
"is automatically checked before prompting for the user's password."
msgstr "由於這個主機的指紋已驗證過，在提示用者輸入密碼之前伺服器的金鑰已自動檢查。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1324
msgid ""
"The arguments passed to `scp` are similar to `cp`. The file or files to copy "
"is the first argument and the destination to copy to is the second. Since "
"the file is fetched over the network, one or more of the file arguments "
"takes the form `user@host:<path_to_remote_file>`. Be aware when copying "
"directories recursively that `scp` uses `-r`, whereas `cp` uses `-R`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1326
msgid ""
"To open an interactive session for copying files, use `sftp`. Refer to man:"
"sftp[1] for a list of available commands while in an `sftp` session."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/security/_index.adoc:1328
#, no-wrap
msgid "Key-based Authentication"
msgstr "以金鑰為基礎的認證"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1331
#, fuzzy
msgid ""
"Instead of using passwords, a client can be configured to connect to the "
"remote machine using keys. To generate RSA authentication keys, use `ssh-"
"keygen`. To generate a public and private key pair, specify the type of key "
"and follow the prompts. It is recommended to protect the keys with a "
"memorable, but hard to guess passphrase."
msgstr ""
"除了使用密碼之外，客戶端可以設定成使用金鑰來連線到遠端的主機。要產生 <acronym>RSA</acronym> 認証金鑰可使用 <command"
">ssh-keygen</command>。要產生成對的公鑰與私鑰，可指定金鑰的類型並依提示操作。建議使用容易記住但較難猜出的密碼來保護這個金鑰。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1355
#, no-wrap
msgid ""
"% ssh-keygen -t rsa\n"
"Generating public/private rsa key pair.\n"
"Enter file in which to save the key (/home/user/.ssh/id_rsa):\n"
"Enter passphrase (empty for no passphrase):  <.>\n"
"Enter same passphrase again:                 <.>\n"
"Your identification has been saved in /home/user/.ssh/id_rsa.\n"
"Your public key has been saved in /home/user/.ssh/id_rsa.pub.\n"
"The key fingerprint is:\n"
"SHA256:54Xm9Uvtv6H4NOo6yjP/YCfODryvUU7yWHzMqeXwhq8 user@host.example.com\n"
"The key's randomart image is:\n"
"+---[RSA 2048]----+\n"
"|                 |\n"
"|                 |\n"
"|                 |\n"
"|        . o..    |\n"
"|       .S*+*o    |\n"
"|      . O=Oo . . |\n"
"|       = Oo= oo..|\n"
"|      .oB.* +.oo.|\n"
"|       =OE**.o..=|\n"
"+----[SHA256]-----+\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1359
msgid ""
"<.> Type a passphrase here. It can contain spaces and symbols.  <.> Retype "
"the passphrase to verify it."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1361
msgid ""
"The private key is stored in [.filename]#~/.ssh/id_rsa# and the public key "
"is stored in [.filename]#~/.ssh/id_rsa.pub#. The _public_ key must be copied "
"to [.filename]#~/.ssh/authorized_keys# on the remote machine for key-based "
"authentication to work."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1366
msgid ""
"Many users believe that keys are secure by design and will use a key without "
"a passphrase. This is _dangerous_ behavior. An administrator can verify that "
"a key pair is protected by a passphrase by viewing the private key manually. "
"If the private key file contains the word `ENCRYPTED`, the key owner is "
"using a passphrase. In addition, to better secure end users, `from` may be "
"placed in the public key file. For example, adding `from=\"192.168.10.5\"` "
"in front of the `ssh-rsa` prefix will only allow that specific user to log "
"in from that IP address."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1369
msgid ""
"The options and files vary with different versions of OpenSSH. To avoid "
"problems, consult man:ssh-keygen[1]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1371
msgid ""
"If a passphrase is used, the user is prompted for the passphrase each time a "
"connection is made to the server. To load SSH keys into memory and remove "
"the need to type the passphrase each time, use man:ssh-agent[1] and man:ssh-"
"add[1]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1373
#, fuzzy
msgid ""
"Authentication is handled by `ssh-agent`, using the private keys that are "
"loaded into it. `ssh-agent` can be used to launch another application like a "
"shell or a window manager."
msgstr ""
"認証可用 <command>ssh-agent</command> 來管理，只要將私鑰載入，<command>ssh-agent</command> "
"可用在執行其他應用程式，如 Shell 或視窗管理程式。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1375
#, fuzzy
msgid ""
"To use `ssh-agent` in a shell, start it with a shell as an argument. Add the "
"identity by running `ssh-add` and entering the passphrase for the private "
"key. The user will then be able to `ssh` to any host that has the "
"corresponding public key installed. For example:"
msgstr ""
"要在 Shell 使用 <command>ssh-agent</command>，使用 Shell 做為參數來啟動 <command>ssh-"
"agent</command>。執行 <command>ssh-add</command> 來加入識別碼，然後輸入私鑰的密碼。使用者將可使用 "
"<command>ssh</command> 連線到任何有安裝對應公鑰的主機，例如："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1383
#, no-wrap
msgid ""
"% ssh-agent csh\n"
"% ssh-add\n"
"Enter passphrase for key '/usr/home/user/.ssh/id_rsa':  <.>\n"
"Identity added: /usr/home/user/.ssh/id_rsa (/usr/home/user/.ssh/id_rsa)\n"
"%\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1386
#, fuzzy
msgid "<.> Enter the passphrase for the key."
msgstr "輸入金鑰的密碼。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1388
msgid ""
"To use `ssh-agent` in Xorg, add an entry for it in [.filename]#~/.xinitrc#. "
"This provides the `ssh-agent` services to all programs launched in Xorg. An "
"example [.filename]#~/.xinitrc# might look like this:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1392
#, no-wrap
msgid "exec ssh-agent startxfce4\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1395
msgid ""
"This launches `ssh-agent`, which in turn launches XFCE, every time Xorg "
"starts. Once Xorg has been restarted so that the changes can take effect, "
"run `ssh-add` to load all of the SSH keys."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/handbook/security/_index.adoc:1397
#, no-wrap
msgid "SSH Tunneling"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1400
msgid ""
"OpenSSH has the ability to create a tunnel to encapsulate another protocol "
"in an encrypted session."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1402
msgid "The following command tells `ssh` to create a tunnel for telnet:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1407
#, no-wrap
msgid ""
"% ssh -2 -N -f -L 5023:localhost:23 user@foo.example.com\n"
"%\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1410
msgid "This example uses the following options:"
msgstr "這個例子使用了以下選項："

#. type: Labeled list
#: documentation/content/en/books/handbook/security/_index.adoc:1411
#, no-wrap
msgid "`-2`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1413
msgid "Forces `ssh` to use version 2 to connect to the server."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/handbook/security/_index.adoc:1414
#, no-wrap
msgid "`-N`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1416
#, fuzzy
msgid ""
"Indicates no command, or tunnel only. If omitted, `ssh` initiates a normal "
"session."
msgstr "代表不需下指令、只建立通道。若省略這個選項 <command>ssh</command> 會初始化一個正常的連線。"

#. type: Labeled list
#: documentation/content/en/books/handbook/security/_index.adoc:1417
#, no-wrap
msgid "`-f`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1419
msgid "Forces `ssh` to run in the background."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/handbook/security/_index.adoc:1420
#, no-wrap
msgid "`-L`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1422
msgid "Indicates a local tunnel in _localport:remotehost:remoteport_ format."
msgstr ""

#. type: Labeled list
#: documentation/content/en/books/handbook/security/_index.adoc:1423
#, no-wrap
msgid "`user@foo.example.com`"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1425
msgid "The login name to use on the specified remote SSH server."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1427
msgid ""
"An SSH tunnel works by creating a listen socket on `localhost` on the "
"specified `localport`. It then forwards any connections received on "
"`localport` via the SSH connection to the specified `remotehost:remoteport`. "
"In the example, port `5023` on the client is forwarded to port `23` on the "
"remote machine. Since port 23 is used by telnet, this creates an encrypted "
"telnet session through an SSH tunnel."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1429
msgid ""
"This method can be used to wrap any number of insecure TCP protocols such as "
"SMTP, POP3, and FTP, as seen in the following examples."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/security/_index.adoc:1430
#, no-wrap
msgid "Create a Secure Tunnel for SMTP"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1443
#, no-wrap
msgid ""
"% ssh -2 -N -f -L 5025:localhost:25 user@mailserver.example.com\n"
"user@mailserver.example.com's password: *****\n"
"% telnet localhost 5025\n"
"Trying 127.0.0.1...\n"
"Connected to localhost.\n"
"Escape character is '^]'.\n"
"220 mailserver.example.com ESMTP\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1445
msgid ""
"This can be used in conjunction with `ssh-keygen` and additional user "
"accounts to create a more seamless SSH tunneling environment. Keys can be "
"used in place of typing a password, and the tunnels can be run as a separate "
"user."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/security/_index.adoc:1447
#, no-wrap
msgid "Secure Access of a POP3 Server"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1451
msgid ""
"In this example, there is an SSH server that accepts connections from the "
"outside. On the same network resides a mail server running a POP3 server. To "
"check email in a secure manner, create an SSH connection to the SSH server "
"and tunnel through to the mail server:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1456
#, no-wrap
msgid ""
"% ssh -2 -N -f -L 2110:mail.example.com:110 user@ssh-server.example.com\n"
"user@ssh-server.example.com's password: ******\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1459
msgid ""
"Once the tunnel is up and running, point the email client to send POP3 "
"requests to `localhost` on port 2110. This connection will be forwarded "
"securely across the tunnel to `mail.example.com`."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/security/_index.adoc:1461
#, no-wrap
msgid "Bypassing a Firewall"
msgstr "跳過防火牆"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1465
#, fuzzy
msgid ""
"Some firewalls filter both incoming and outgoing connections. For example, a "
"firewall might limit access from remote machines to ports 22 and 80 to only "
"allow SSH and web surfing. This prevents access to any other service which "
"uses a port other than 22 or 80."
msgstr ""
"有些防火牆會同時過濾傳入與傳出的連線。例如，防火牆很可能會限制來自遠端主機只能存取 Port 22 與 80 來只讓 <acronym>SSH</"
"acronym> 與網頁瀏覽器連線，這會使得 Port 使用 22 或 80 以外的服務無法存取。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1467
msgid ""
"The solution is to create an SSH connection to a machine outside of the "
"network's firewall and use it to tunnel to the desired service:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1472
#, no-wrap
msgid ""
"% ssh -2 -N -f -L 8888:music.example.com:8000 user@unfirewalled-system.example.org\n"
"user@unfirewalled-system.example.org's password: *******\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1475
msgid ""
"In this example, a streaming Ogg Vorbis client can now be pointed to "
"`localhost` port 8888, which will be forwarded over to `music.example.com` "
"on port 8000, successfully bypassing the firewall."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1477
#, no-wrap
msgid "Enabling the SSH Server"
msgstr "開啟 SSH 伺服器"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1480
msgid ""
"In addition to providing built-in SSH client utilities, a FreeBSD system can "
"be configured as an SSH server, accepting connections from other SSH clients."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1482
msgid "To see if sshd is operating, use the man:service[8] command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1486
#, no-wrap
msgid "# service sshd status\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1489
#, fuzzy
msgid ""
"If the service is not running, add the following line to [.filename]#/etc/rc."
"conf#."
msgstr "若服務未執行，請加入下行到 <filename>/etc/rc.conf</filename>。"

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1493
#, no-wrap
msgid "sshd_enable=\"YES\"\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1496
msgid ""
"This will start sshd, the daemon program for OpenSSH, the next time the "
"system boots. To start it now:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1500
#, no-wrap
msgid "# service sshd start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1503
#, fuzzy
msgid ""
"The first time sshd starts on a FreeBSD system, the system's host keys will "
"be automatically created and the fingerprint will be displayed on the "
"console. Provide users with the fingerprint so that they can verify it the "
"first time they connect to the server."
msgstr ""
"在 FreeBSD 系統第一次啟動 <application>sshd</application> 時便會自動產生系統的主機金鑰且會顯示指紋在  "
"Console 上，這個指紋可供使用者在第一次連線到伺服器時驗證用。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1505
msgid ""
"Refer to man:sshd[8] for the list of available options when starting sshd "
"and a more complete discussion about authentication, the login process, and "
"the various configuration files."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1507
msgid ""
"At this point, the sshd should be available to all users with a username and "
"password on the system."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1508
#, no-wrap
msgid "SSH Server Security"
msgstr "SSH 伺服器安全性"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1511
#, fuzzy
msgid ""
"While sshd is the most widely used remote administration facility for "
"FreeBSD, brute force and drive by attacks are common to any system exposed "
"to public networks. Several additional parameters are available to prevent "
"the success of these attacks and will be described in this section."
msgstr ""
"在 FreeBSD 廣泛使用 <application>sshd</application> 做為遠端管理基礎設施的同時，"
"所有暴露在公有網路上的系統也會時常受到暴力攻擊 (Brute force attack) 與路過攻擊 (Drive by "
"attack)。在本節會介紹一些可用來避免這些攻擊的參數。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1513
msgid ""
"It is a good idea to limit which users can log into the SSH server and from "
"where using the `AllowUsers` keyword in the OpenSSH server configuration "
"file. For example, to only allow `root` to log in from `192.168.1.32`, add "
"this line to [.filename]#/etc/ssh/sshd_config#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1517
#, no-wrap
msgid "AllowUsers root@192.168.1.32\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1520
msgid ""
"To allow `admin` to log in from anywhere, list that user without specifying "
"an IP address:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1524
#, no-wrap
msgid "AllowUsers admin\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1527
msgid "Multiple users should be listed on the same line, like so:"
msgstr "有多位使用者也應列在同一行，例如："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1531
#, no-wrap
msgid "AllowUsers root@192.168.1.32 admin\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1534
msgid ""
"After making changes to [.filename]#/etc/ssh/sshd_config#, tell sshd to "
"reload its configuration file by running:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1538
#, no-wrap
msgid "# service sshd reload\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1543
msgid ""
"When this keyword is used, it is important to list each user that needs to "
"log into this machine. Any user that is not specified in that line will be "
"locked out. Also, the keywords used in the OpenSSH server configuration file "
"are case-sensitive. If the keyword is not spelled correctly, including its "
"case, it will be ignored. Always test changes to this file to make sure that "
"the edits are working as expected. Refer to man:sshd_config[5] to verify the "
"spelling and use of the available keywords."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1546
msgid ""
"In addition, users may be forced to use two factor authentication via the "
"use of a public and private key. When required, the user may generate a key "
"pair through the use of man:ssh-keygen[1] and send the administrator the "
"public key. This key file will be placed in the [.filename]#authorized_keys# "
"as described above in the client section. To force the users to use keys "
"only, the following option may be configured:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1550
#, no-wrap
msgid "AuthenticationMethods publickey\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1556
msgid ""
"Do not confuse [.filename]#/etc/ssh/sshd_config# with [.filename]#/etc/ssh/"
"ssh_config# (note the extra `d` in the first filename). The first file "
"configures the server and the second file configures the client. Refer to "
"man:ssh_config[5] for a listing of the available client settings."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:1559
#, no-wrap
msgid "Access Control Lists"
msgstr "存取控制清單"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1562
msgid ""
"Access Control Lists (ACLs) extend the standard UNIX(R) permission model in "
"a POSIX(R).1e compatible way. This permits an administrator to take "
"advantage of a more fine-grained permissions model."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1564
msgid ""
"The FreeBSD [.filename]#GENERIC# kernel provides ACL support for UFS file "
"systems. Users who prefer to compile a custom kernel must include the "
"following option in their custom kernel configuration file:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1568
#, no-wrap
msgid "options UFS_ACL\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1571
msgid ""
"If this option is not compiled in, a warning message will be displayed when "
"attempting to mount a file system with ACL support. ACLs rely on extended "
"attributes which are natively supported in UFS2."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1573
msgid ""
"This chapter describes how to enable ACL support and provides some usage "
"examples."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1574
#, no-wrap
msgid "Enabling ACL Support"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1577
msgid ""
"ACLs are enabled by the mount-time administrative flag, `acls`, which may be "
"added to [.filename]#/etc/fstab#. The mount-time flag can also be "
"automatically set in a persistent manner using man:tunefs[8] to modify a "
"superblock ACLs flag in the file system header. In general, it is preferred "
"to use the superblock flag for several reasons:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1579
msgid ""
"The superblock flag cannot be changed by a remount using `mount -u` as it "
"requires a complete `umount` and fresh `mount`. This means that ACLs cannot "
"be enabled on the root file system after boot. It also means that ACL "
"support on a file system cannot be changed while the system is in use."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1580
msgid ""
"Setting the superblock flag causes the file system to always be mounted with "
"ACLs enabled, even if there is not an [.filename]#fstab# entry or if the "
"devices re-order. This prevents accidental mounting of the file system "
"without ACL support."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1584
msgid ""
"It is desirable to discourage accidental mounting without ACLs enabled "
"because nasty things can happen if ACLs are enabled, then disabled, then re-"
"enabled without flushing the extended attributes. In general, once ACLs are "
"enabled on a file system, they should not be disabled, as the resulting file "
"protections may not be compatible with those intended by the users of the "
"system, and re-enabling ACLs may re-attach the previous ACLs to files that "
"have since had their permissions changed, resulting in unpredictable "
"behavior."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1587
msgid ""
"File systems with ACLs enabled will show a plus (`+`) sign in their "
"permission settings:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1595
#, no-wrap
msgid ""
"drwx------  2 robert  robert  512 Dec 27 11:54 private\n"
"drwxrwx---+ 2 robert  robert  512 Dec 23 10:57 directory1\n"
"drwxrwx---+ 2 robert  robert  512 Dec 22 10:20 directory2\n"
"drwxrwx---+ 2 robert  robert  512 Dec 27 11:57 directory3\n"
"drwxr-xr-x  2 robert  robert  512 Nov 10 11:54 public_html\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1598
msgid ""
"In this example, [.filename]#directory1#, [.filename]#directory2#, and [."
"filename]#directory3# are all taking advantage of ACLs, whereas [."
"filename]#private# and [.filename]#public_html# are not."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1599
#, no-wrap
msgid "Using ACLs"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1602
msgid ""
"File system ACLs can be viewed using `getfacl`. For instance, to view the "
"ACL settings on [.filename]#test#:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1612
#, no-wrap
msgid ""
"% getfacl test\n"
"\t#file:test\n"
"\t#owner:1001\n"
"\t#group:1001\n"
"\tuser::rw-\n"
"\tgroup::r--\n"
"\tother::r--\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1615
msgid ""
"To change the ACL settings on this file, use `setfacl`. To remove all of the "
"currently defined ACLs from a file or file system, include `-k`. However, "
"the preferred method is to use `-b` as it leaves the basic fields required "
"for ACLs to work."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1619
#, no-wrap
msgid "% setfacl -k test\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1622
msgid "To modify the default ACL entries, use `-m`:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1626
#, no-wrap
msgid "% setfacl -m u:trhodes:rwx,group:web:r--,o::--- test\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1629
msgid ""
"In this example, there were no pre-defined entries, as they were removed by "
"the previous command. This command restores the default options and assigns "
"the options listed. If a user or group is added which does not exist on the "
"system, an `Invalid argument` error will be displayed."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1631
msgid ""
"Refer to man:getfacl[1] and man:setfacl[1] for more information about the "
"options available for these commands."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:1633
#, no-wrap
msgid "Monitoring Third Party Security Issues"
msgstr "監視第三方安全性問題"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1636
msgid ""
"In recent years, the security world has made many improvements to how "
"vulnerability assessment is handled. The threat of system intrusion "
"increases as third party utilities are installed and configured for "
"virtually any operating system available today."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1638
msgid ""
"Vulnerability assessment is a key factor in security. While FreeBSD releases "
"advisories for the base system, doing so for every third party utility is "
"beyond the FreeBSD Project's capability. There is a way to mitigate third "
"party vulnerabilities and warn administrators of known security issues. A "
"FreeBSD add on utility known as pkg includes options explicitly for this "
"purpose."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1640
msgid ""
"pkg polls a database for security issues. The database is updated and "
"maintained by the FreeBSD Security Team and ports developers."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1642
msgid ""
"Please refer to crossref:ports[pkgng-intro,instructions] for installing pkg."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1644
msgid ""
"Installation provides man:periodic[8] configuration files for maintaining "
"the pkg audit database, and provides a programmatic method of keeping it "
"updated. This functionality is enabled if "
"`daily_status_security_pkgaudit_enable` is set to `YES` in man:periodic."
"conf[5]. Ensure that daily security run emails, which are sent to ``root``'s "
"email account, are being read."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1646
msgid ""
"After installation, and to audit third party utilities as part of the Ports "
"Collection at any time, an administrator may choose to update the database "
"and view known vulnerabilities of installed packages by invoking:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1650
#, no-wrap
msgid "# pkg audit -F\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1653
msgid ""
"pkg displays messages any published vulnerabilities in installed packages:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1659
#, no-wrap
msgid ""
"Affected package: cups-base-1.1.22.0_1\n"
"Type of problem: cups-base -- HPGL buffer overflow vulnerability.\n"
"Reference: <https://www.FreeBSD.org/ports/portaudit/40a3bca2-6809-11d9-a9e7-0001020eed82.html>\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1661
#, no-wrap
msgid "1 problem(s) in your installed packages found.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1663
#, no-wrap
msgid "You are advised to update or deinstall the affected package(s) immediately.\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1666
msgid ""
"By pointing a web browser to the displayed URL, an administrator may obtain "
"more information about the vulnerability. This will include the versions "
"affected, by FreeBSD port version, along with other web sites which may "
"contain security advisories."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1668
msgid ""
"pkg is a powerful utility and is extremely useful when coupled with package:"
"ports-mgmt/portmaster[]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:1670
#, no-wrap
msgid "FreeBSD Security Advisories"
msgstr "FreeBSD 安全報告"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1673
msgid ""
"Like many producers of quality operating systems, the FreeBSD Project has a "
"security team which is responsible for determining the End-of-Life (EoL) "
"date for each FreeBSD release and to provide security updates for supported "
"releases which have not yet reached their EoL. More information about the "
"FreeBSD security team and the supported releases is available on the link:"
"https://www.FreeBSD.org/security[FreeBSD security page]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1675
msgid ""
"One task of the security team is to respond to reported security "
"vulnerabilities in the FreeBSD operating system. Once a vulnerability is "
"confirmed, the security team verifies the steps necessary to fix the "
"vulnerability and updates the source code with the fix. It then publishes "
"the details as a \"Security Advisory\". Security advisories are published on "
"the link:https://www.FreeBSD.org/security/advisories/[FreeBSD website] and "
"mailed to the {freebsd-security-notifications}, {freebsd-security}, and "
"{freebsd-announce} mailing lists."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1677
msgid "This section describes the format of a FreeBSD security advisory."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1678
#, no-wrap
msgid "Format of a Security Advisory"
msgstr "安全報告的格式"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1681
msgid "Here is an example of a FreeBSD security advisory:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1687
#, no-wrap
msgid ""
"=============================================================================\n"
"-----BEGIN PGP SIGNED MESSAGE-----\n"
"Hash: SHA512\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1691
#, no-wrap
msgid ""
"=============================================================================\n"
"FreeBSD-SA-14:04.bind                                       Security Advisory\n"
"                                                          The FreeBSD Project\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1693
#, no-wrap
msgid "Topic:          BIND remote denial of service vulnerability\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1706
#, no-wrap
msgid ""
"Category:       contrib\n"
"Module:         bind\n"
"Announced:      2014-01-14\n"
"Credits:        ISC\n"
"Affects:        FreeBSD 8.x and FreeBSD 9.x\n"
"Corrected:      2014-01-14 19:38:37 UTC (stable/9, 9.2-STABLE)\n"
"                2014-01-14 19:42:28 UTC (releng/9.2, 9.2-RELEASE-p3)\n"
"                2014-01-14 19:42:28 UTC (releng/9.1, 9.1-RELEASE-p10)\n"
"                2014-01-14 19:38:37 UTC (stable/8, 8.4-STABLE)\n"
"                2014-01-14 19:42:28 UTC (releng/8.4, 8.4-RELEASE-p7)\n"
"                2014-01-14 19:42:28 UTC (releng/8.3, 8.3-RELEASE-p14)\n"
"CVE Name:       CVE-2014-0591\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1710
#, no-wrap
msgid ""
"For general information regarding FreeBSD Security Advisories,\n"
"including descriptions of the fields above, security branches, and the\n"
"following sections, please visit <URL:http://security.FreeBSD.org/>.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1712
#, no-wrap
msgid "I.   Background\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1715
#, no-wrap
msgid ""
"BIND 9 is an implementation of the Domain Name System (DNS) protocols.\n"
"The named(8) daemon is an Internet Domain Name Server.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1717
#, no-wrap
msgid "II.  Problem Description\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1722
#, no-wrap
msgid ""
"Because of a defect in handling queries for NSEC3-signed zones, BIND can\n"
"crash with an \"INSIST\" failure in name.c when processing queries possessing\n"
"certain properties.  This issue only affects authoritative nameservers with\n"
"at least one NSEC3-signed zone.  Recursive-only servers are not at risk.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1724
#, no-wrap
msgid "III. Impact\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1727
#, no-wrap
msgid ""
"An attacker who can send a specially crafted query could cause named(8)\n"
"to crash, resulting in a denial of service.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1729
#, no-wrap
msgid "IV.  Workaround\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1732
#, no-wrap
msgid ""
"No workaround is available, but systems not running authoritative DNS service\n"
"with at least one NSEC3-signed zone using named(8) are not vulnerable.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1734
#, no-wrap
msgid "V.   Solution\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1736
#, no-wrap
msgid "Perform one of the following:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1739
#, no-wrap
msgid ""
"1) Upgrade your vulnerable system to a supported FreeBSD stable or\n"
"release / security branch (releng) dated after the correction date.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1741
#, no-wrap
msgid "2) To update your vulnerable system via a source code patch:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1744
#, no-wrap
msgid ""
"The following patches have been verified to apply to the applicable\n"
"FreeBSD release branches.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1747
#, no-wrap
msgid ""
"a) Download the relevant patch from the location below, and verify the\n"
"detached PGP signature using your PGP utility.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1752
#, no-wrap
msgid ""
"[FreeBSD 8.3, 8.4, 9.1, 9.2-RELEASE and 8.4-STABLE]\n"
"# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-release.patch\n"
"# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-release.patch.asc\n"
"# gpg --verify bind-release.patch.asc\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1757
#, no-wrap
msgid ""
"[FreeBSD 9.2-STABLE]\n"
"# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-stable-9.patch\n"
"# fetch http://security.FreeBSD.org/patches/SA-14:04/bind-stable-9.patch.asc\n"
"# gpg --verify bind-stable-9.patch.asc\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1759
#, no-wrap
msgid "b) Execute the following commands as root:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1762
#, no-wrap
msgid ""
"# cd /usr/src\n"
"# patch < /path/to/patch\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1765
#, no-wrap
msgid ""
"Recompile the operating system using buildworld and installworld as\n"
"described in <URL:https://www.FreeBSD.org/handbook/makeworld.html>.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1767
#, no-wrap
msgid "Restart the applicable daemons, or reboot the system.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1769
#, no-wrap
msgid "3) To update your vulnerable system via a binary patch:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1772
#, no-wrap
msgid ""
"Systems running a RELEASE version of FreeBSD on the i386 or amd64\n"
"platforms can be updated via the freebsd-update(8) utility:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1775
#, no-wrap
msgid ""
"# freebsd-update fetch\n"
"# freebsd-update install\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1777
#, no-wrap
msgid "VI.  Correction details\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1780
#, no-wrap
msgid ""
"The following list contains the correction revision numbers for each\n"
"affected branch.\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1790
#, no-wrap
msgid ""
"Branch/path                                                      Revision\n"
"- -------------------------------------------------------------------------\n"
"stable/8/                                                         r260646\n"
"releng/8.3/                                                       r260647\n"
"releng/8.4/                                                       r260647\n"
"stable/9/                                                         r260646\n"
"releng/9.1/                                                       r260647\n"
"releng/9.2/                                                       r260647\n"
"- -------------------------------------------------------------------------\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1794
#, no-wrap
msgid ""
"To see which files were modified by a particular revision, run the\n"
"following command, replacing NNNNNN with the revision number, on a\n"
"machine with Subversion installed:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1796
#, no-wrap
msgid "# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1798
#, no-wrap
msgid "Or visit the following URL, replacing NNNNNN with the revision number:\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1800
#, no-wrap
msgid "<URL:https://svnweb.freebsd.org/base?view=revision&revision=NNNNNN>\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1802
#, no-wrap
msgid "VII. References\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1804
#, no-wrap
msgid "<URL:https://kb.isc.org/article/AA-01078>\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1806
#, no-wrap
msgid "<URL:http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0591>\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1810
#, no-wrap
msgid ""
"The latest revision of this advisory is available at\n"
"<URL:http://security.FreeBSD.org/advisories/FreeBSD-SA-14:04.bind.asc>\n"
"-----BEGIN PGP SIGNATURE-----\n"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1825
#, no-wrap
msgid ""
"iQIcBAEBCgAGBQJS1ZTYAAoJEO1n7NZdz2rnOvQP/2/68/s9Cu35PmqNtSZVVxVG\n"
"ZSQP5EGWx/lramNf9566iKxOrLRMq/h3XWcC4goVd+gZFrvITJSVOWSa7ntDQ7TO\n"
"XcinfRZ/iyiJbs/Rg2wLHc/t5oVSyeouyccqODYFbOwOlk35JjOTMUG1YcX+Zasg\n"
"ax8RV+7Zt1QSBkMlOz/myBLXUjlTZ3Xg2FXVsfFQW5/g2CjuHpRSFx1bVNX6ysoG\n"
"9DT58EQcYxIS8WfkHRbbXKh9I1nSfZ7/Hky/kTafRdRMrjAgbqFgHkYTYsBZeav5\n"
"fYWKGQRJulYfeZQ90yMTvlpF42DjCC3uJYamJnwDIu8OhS1WRBI8fQfr9DRzmRua\n"
"OK3BK9hUiScDZOJB6OqeVzUTfe7MAA4/UwrDtTYQ+PqAenv1PK8DZqwXyxA9ThHb\n"
"zKO3OwuKOVHJnKvpOcr+eNwo7jbnHlis0oBksj/mrq2P9m2ueF9gzCiq5Ri5Syag\n"
"Wssb1HUoMGwqU0roS8+pRpNC8YgsWpsttvUWSZ8u6Vj/FLeHpiV3mYXPVMaKRhVm\n"
"067BA2uj4Th1JKtGleox+Em0R7OFbCc/9aWC67wiqI6KRyit9pYiF3npph+7D5Eq\n"
"7zPsUdDd+qc+UTiLp3liCRp5w6484wWdhZO6wRtmUgxGjNkxFoNnX8CitzF8AaqO\n"
"UWWemqWuz3lAZuORQ9KX\n"
"=OQzQ\n"
"-----END PGP SIGNATURE-----\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1828
msgid "Every security advisory uses the following format:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1830
msgid ""
"Each security advisory is signed by the PGP key of the Security Officer. The "
"public key for the Security Officer can be verified at crossref:"
"pgpkeys[pgpkeys,OpenPGP Keys]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1831
msgid ""
"The name of the security advisory always begins with `FreeBSD-SA-` (for "
"FreeBSD Security Advisory), followed by the year in two digit format (`14:"
"`), followed by the advisory number for that year (`04.`), followed by the "
"name of the affected application or subsystem (`bind`). The advisory shown "
"here is the fourth advisory for 2014 and it affects BIND."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1832
msgid "The `Topic` field summarizes the vulnerability."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1833
msgid ""
"The `Category` refers to the affected part of the system which may be one of "
"`core`, `contrib`, or `ports`. The `core` category means that the "
"vulnerability affects a core component of the FreeBSD operating system. The "
"`contrib` category means that the vulnerability affects software included "
"with FreeBSD, such as BIND. The `ports` category indicates that the "
"vulnerability affects software available through the Ports Collection."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1834
msgid ""
"The `Module` field refers to the component location. In this example, the "
"`bind` module is affected; therefore, this vulnerability affects an "
"application installed with the operating system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1835
msgid ""
"The `Announced` field reflects the date the security advisory was published. "
"This means that the security team has verified that the problem exists and "
"that a patch has been committed to the FreeBSD source code repository."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1836
msgid ""
"The `Credits` field gives credit to the individual or organization who "
"noticed the vulnerability and reported it."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1837
msgid ""
"The `Affects` field explains which releases of FreeBSD are affected by this "
"vulnerability."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1838
msgid ""
"The `Corrected` field indicates the date, time, time offset, and releases "
"that were corrected. The section in parentheses shows each branch for which "
"the fix has been merged, and the version number of the corresponding release "
"from that branch. The release identifier itself includes the version number "
"and, if appropriate, the patch level. The patch level is the letter `p` "
"followed by a number, indicating the sequence number of the patch, allowing "
"users to track which patches have already been applied to the system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1839
msgid ""
"The `CVE Name` field lists the advisory number, if one exists, in the public "
"http://cve.mitre.org[cve.mitre.org] security vulnerabilities database."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1840
msgid "The `Background` field provides a description of the affected module."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1841
msgid ""
"The `Problem Description` field explains the vulnerability. This can include "
"information about the flawed code and how the utility could be maliciously "
"used."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1842
msgid ""
"The `Impact` field describes what type of impact the problem could have on a "
"system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1843
msgid ""
"The `Workaround` field indicates if a workaround is available to system "
"administrators who cannot immediately patch the system ."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1844
msgid ""
"The `Solution` field provides the instructions for patching the affected "
"system. This is a step by step tested and verified method for getting a "
"system patched and working securely."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1845
msgid ""
"The `Correction Details` field displays each affected Subversion branch with "
"the revision number that contains the corrected code."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1846
msgid ""
"The `References` field offers sources of additional information regarding "
"the vulnerability."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:1848
#, no-wrap
msgid "Process Accounting"
msgstr "程序追蹤"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1851
msgid ""
"Process accounting is a security method in which an administrator may keep "
"track of system resources used and their allocation among users, provide for "
"system monitoring, and minimally track a user's commands."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1853
msgid ""
"Process accounting has both positive and negative points. One of the "
"positives is that an intrusion may be narrowed down to the point of entry. A "
"negative is the amount of logs generated by process accounting, and the disk "
"space they may require. This section walks an administrator through the "
"basics of process accounting."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1857
msgid ""
"If more fine-grained accounting is needed, refer to crossref:audit[audit,"
"Security Event Auditing]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1859
#, no-wrap
msgid "Enabling and Utilizing Process Accounting"
msgstr "開啟並使用程序追蹤"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1862
msgid ""
"Before using process accounting, it must be enabled using the following "
"commands:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1867
#, no-wrap
msgid ""
"# sysrc accounting_enable=yes\n"
"# service accounting start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1870
msgid ""
"The accounting information is stored in files located in [.filename]#/var/"
"account#, which is automatically created, if necessary, the first time the "
"accounting service starts. These files contain sensitive information, "
"including all the commands issued by all users. Write access to the files is "
"limited to `root`, and read access is limited to `root` and members of the "
"`wheel` group. To also prevent members of `wheel` from reading the files, "
"change the mode of the [.filename]#/var/account# directory to allow access "
"only by `root`."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1872
msgid ""
"Once enabled, accounting will begin to track information such as CPU "
"statistics and executed commands. All accounting logs are in a non-human "
"readable format which can be viewed using `sa`. If issued without any "
"options, `sa` prints information relating to the number of per-user calls, "
"the total elapsed time in minutes, total CPU and user time in minutes, and "
"the average number of I/O operations. Refer to man:sa[8] for the list of "
"available options which control the output."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1874
msgid ""
"To display the commands issued by users, use `lastcomm`. For example, this "
"command prints out all usage of `ls` by `trhodes` on the `ttyp1` terminal:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1878
#, no-wrap
msgid "# lastcomm ls trhodes ttyp1\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1881
msgid ""
"Many other useful options exist and are explained in man:lastcomm[1], man:"
"acct[5], and man:sa[8]."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:1883
#, no-wrap
msgid "Resource Limits"
msgstr "限制資源"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1886
msgid ""
"FreeBSD provides several methods for an administrator to limit the amount of "
"system resources an individual may use. Disk quotas limit the amount of disk "
"space available to users. Quotas are discussed in crossref:disks[quotas,"
"\"Disk Quotas\"]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1888
msgid ""
"Limits to other resources, such as CPU and memory, can be set using either a "
"flat file or a command to configure a resource limits database. The "
"traditional method defines login classes by editing [.filename]#/etc/login."
"conf#. While this method is still supported, any changes require a multi-"
"step process of editing this file, rebuilding the resource database, making "
"necessary changes to [.filename]#/etc/master.passwd#, and rebuilding the "
"password database. This can become time consuming, depending upon the number "
"of users to configure."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1890
msgid ""
"`rctl` can be used to provide a more fine-grained method for controlling "
"resource limits. This command supports more than user limits as it can also "
"be used to set resource constraints on processes and jails."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1892
msgid ""
"This section demonstrates both methods for controlling resources, beginning "
"with the traditional method."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1894
#, no-wrap
msgid "Configuring Login Classes"
msgstr "設定登入類別"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1897
msgid ""
"In the traditional method, login classes and the resource limits to apply to "
"a login class are defined in [.filename]#/etc/login.conf#. Each user account "
"can be assigned to a login class, where `default` is the default login "
"class. Each login class has a set of login capabilities associated with it. "
"A login capability is a `_name_=_value_` pair, where _name_ is a well-known "
"identifier and _value_ is an arbitrary string which is processed accordingly "
"depending on the _name_."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1901
msgid ""
"Whenever [.filename]#/etc/login.conf# is edited, the [.filename]#/etc/login."
"conf.db# must be updated by executing the following command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1905
#, no-wrap
msgid "# cap_mkdb /etc/login.conf\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1910
msgid ""
"Resource limits differ from the default login capabilities in two ways. "
"First, for every limit, there is a _soft_ and _hard_ limit. A soft limit may "
"be adjusted by the user or application, but may not be set higher than the "
"hard limit. The hard limit may be lowered by the user, but can only be "
"raised by the superuser. Second, most resource limits apply per process to a "
"specific user."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:1912
msgid ""
"<<resource-limits>> lists the most commonly used resource limits. All of the "
"available resource limits and capabilities are described in detail in man:"
"login.conf[5]."
msgstr ""

#. type: Block title
#: documentation/content/en/books/handbook/security/_index.adoc:1913
#, no-wrap
msgid "Login Class Resource Limits"
msgstr "登入類別限制資源類型"

#. type: Table
#: documentation/content/en/books/handbook/security/_index.adoc:1945
#, no-wrap
msgid ""
"| Resource Limit\n"
"| Description\n"
"\n"
"|coredumpsize\n"
"|The limit on the size of a core file generated by a program is subordinate to other limits on disk usage, such as `filesize` or disk quotas. This limit is often used as a less severe method of controlling disk space consumption. Since users do not generate core files and often do not delete them, this setting may save them from running out of disk space should a large program crash.\n"
"\n"
"|cputime\n"
"|The maximum amount of CPU time a user's process may consume. Offending processes will be killed by the kernel. This is a limit on CPU _time_ consumed, not the percentage of the CPU as displayed in some of the fields generated by `top` and `ps`.\n"
"\n"
"|filesize\n"
"|The maximum size of a file the user may own. Unlike disk quotas (crossref:disks[quotas,\"Disk Quotas\"]), this limit is enforced on individual files, not the set of all files a user owns.\n"
"\n"
"|maxproc\n"
"|The maximum number of foreground and background processes a user can run. This limit may not be larger than the system limit specified by `kern.maxproc`. Setting this limit too small may hinder a user's productivity as some tasks, such as compiling a large program, start lots of processes.\n"
"\n"
"|memorylocked\n"
"|The maximum amount of memory a process may request to be locked into main memory using man:mlock[2]. Some system-critical programs, such as man:amd[8], lock into main memory so that if the system begins to swap, they do not contribute to disk thrashing.\n"
"\n"
"|memoryuse\n"
"|The maximum amount of memory a process may consume at any given time. It includes both core memory and swap usage. This is not a catch-all limit for restricting memory consumption, but is a good start.\n"
"\n"
"|openfiles\n"
"|The maximum number of files a process may have open. In FreeBSD, files are used to represent sockets and IPC channels, so be careful not to set this too low. The system-wide limit for this is defined by `kern.maxfiles`.\n"
"\n"
"|sbsize\n"
"|The limit on the amount of network memory a user may consume. This can be generally used to limit network communications.\n"
"\n"
"|stacksize\n"
"|The maximum size of a process stack. This alone is not sufficient to limit the amount of memory a program may use, so it should be used in conjunction with other limits.\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1948
msgid "There are a few other things to remember when setting resource limits:"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1950
msgid ""
"Processes started at system startup by [.filename]#/etc/rc# are assigned to "
"the `daemon` login class."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1951
msgid ""
"Although the default [.filename]#/etc/login.conf# is a good source of "
"reasonable values for most limits, they may not be appropriate for every "
"system. Setting a limit too high may open the system up to abuse, while "
"setting it too low may put a strain on productivity."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1952
msgid ""
"Xorg takes a lot of resources and encourages users to run more programs "
"simultaneously."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1953
msgid ""
"Many limits apply to individual processes, not the user as a whole. For "
"example, setting `openfiles` to `50` means that each process the user runs "
"may open up to `50` files. The total amount of files a user may open is the "
"value of `openfiles` multiplied by the value of `maxproc`. This also applies "
"to memory consumption."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1955
msgid ""
"For further information on resource limits and login classes and "
"capabilities in general, refer to man:cap.mkdb[1], man:getrlimit[2], and man:"
"login.conf[5]."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:1956
#, no-wrap
msgid "Enabling and Configuring Resource Limits"
msgstr "開啟並設定資源限制"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1959
msgid ""
"The `kern.racct.enable` tunable must be set to a non-zero value. Custom "
"kernels require specific configuration:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1964
#, no-wrap
msgid ""
"options         RACCT\n"
"options         RCTL\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1967
msgid ""
"Once the system has rebooted into the new kernel, `rctl` may be used to set "
"rules for the system."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1969
msgid ""
"Rule syntax is controlled through the use of a subject, subject-id, "
"resource, and action, as seen in this example rule:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1973
#, no-wrap
msgid "user:trhodes:maxproc:deny=10/user\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1976
msgid ""
"In this rule, the subject is `user`, the subject-id is `trhodes`, the "
"resource, `maxproc`, is the maximum number of processes, and the action is "
"`deny`, which blocks any new processes from being created. This means that "
"the user, `trhodes`, will be constrained to no greater than `10` processes. "
"Other possible actions include logging to the console, passing a "
"notification to man:devd[8], or sending a sigterm to the process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1978
msgid ""
"Some care must be taken when adding rules. Since this user is constrained to "
"`10` processes, this example will prevent the user from performing other "
"tasks after logging in and executing a `screen` session. Once a resource "
"limit has been hit, an error will be printed, as in this example:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1984
#, no-wrap
msgid ""
"% man test\n"
"    /usr/bin/man: Cannot fork: Resource temporarily unavailable\n"
"eval: Cannot fork: Resource temporarily unavailable\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1987
msgid ""
"As another example, a jail can be prevented from exceeding a memory limit. "
"This rule could be written as:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1991
#, no-wrap
msgid "# rctl -a jail:httpd:memoryuse:deny=2G/jail\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:1994
msgid ""
"Rules will persist across reboots if they have been added to [.filename]#/"
"etc/rctl.conf#. The format is a rule, without the preceding command. For "
"example, the previous rule could be added as:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:1999
#, no-wrap
msgid ""
"# Block jail from using more than 2G memory:\n"
"jail:httpd:memoryuse:deny=2G/jail\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2002
msgid "To remove a rule, use `rctl` to remove it from the list:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2006
#, no-wrap
msgid "# rctl -r user:trhodes:maxproc:deny=10/user\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2009
msgid ""
"A method for removing all rules is documented in man:rctl[8]. However, if "
"removing all rules for a single user is required, this command may be issued:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2013
#, no-wrap
msgid "# rctl -r user:trhodes\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2016
msgid ""
"Many other resources exist which can be used to exert additional control "
"over various `subjects`. See man:rctl[8] to learn about them."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:2018
#, no-wrap
msgid "Shared Administration with Sudo"
msgstr "使用 Sudo 分享管理權限"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2021
msgid ""
"System administrators often need the ability to grant enhanced permissions "
"to users so they may perform privileged tasks. The idea that team members "
"are provided access to a FreeBSD system to perform their specific tasks "
"opens up unique challenges to every administrator. These team members only "
"need a subset of access beyond normal end user levels; however, they almost "
"always tell management they are unable to perform their tasks without "
"superuser access. Thankfully, there is no reason to provide such access to "
"end users because tools exist to manage this exact requirement."
msgstr ""
"系統管理者通常會要能夠授予額外的權限給其他使用者，以讓這些使用者可以執行需權限的工作。要讓團隊成員可以存取 FreeBSD 系統來完成其特定的工作對所有管"
"理者都會帶來挑戰，這些團隊成員通常只需要比一般使用者多出一些存取權限便可作業，但他們總是會告訴管理者若沒有超級使用者的存取權便無法完成其工作。幸好，有工具"
"可以管理這類的需求，這樣便不需提供這麼大的權限給一般使用者。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2023
msgid ""
"Up to this point, the security chapter has covered permitting access to "
"authorized users and attempting to prevent unauthorized access. Another "
"problem arises once authorized users have access to the system resources. In "
"many cases, some users may need access to application startup scripts, or a "
"team of administrators need to maintain the system. Traditionally, the "
"standard users and groups, file permissions, and even the man:su[1] command "
"would manage this access. And as applications required more access, as more "
"users needed to use system resources, a better solution was required. The "
"most used application is currently Sudo."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2025
msgid ""
"Sudo allows administrators to configure more rigid access to system commands "
"and provide for some advanced logging features. As a tool, it is available "
"from the Ports Collection as package:security/sudo[] or by use of the man:"
"pkg[8] utility. To use the man:pkg[8] tool:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2029
#, no-wrap
msgid "# pkg install sudo\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2032
#, fuzzy
msgid ""
"After the installation is complete, the installed `visudo` will open the "
"configuration file with a text editor. Using `visudo` is highly recommended "
"as it comes with a built in syntax checker to verify there are no errors "
"before the file is saved."
msgstr ""
"安裝完成之後，可用安裝的 <command>visudo</command> 以文字編輯器開啟設定檔，強烈建議使用 <command>visudo</"
"command> 來編輯設定檔，由於它有內建的語法檢查程式可在檔案儲存之前檢驗是否有誤。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2034
#, fuzzy
msgid ""
"The configuration file is made up of several small sections which allow for "
"extensive configuration. In the following example, web application "
"maintainer, user1, needs to start, stop, and restart the web application "
"known as _webservice_. To grant this user permission to perform these tasks, "
"add this line to the end of [.filename]#/usr/local/etc/sudoers#:"
msgstr ""
"設定檔由個小節所組成，透過這些小節可做常廣泛的設定，在以下的範例中，網站應用程式維護人員 user1 需要啟動、停止與重新啟動名稱為 "
"<replaceable>webservice</replaceable> 的網站應用程式 。要授權此使用者執行這些工作的權限，可加入此行到 "
"<filename>/usr/local/etc/sudoers</filename> 的最後："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2038
#, no-wrap
msgid "user1   ALL=(ALL)       /usr/sbin/service webservice *\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2041
msgid "The user may now start _webservice_ using this command:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2045
#, no-wrap
msgid "% sudo /usr/sbin/service webservice start\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2048
#, fuzzy
msgid ""
"While this configuration allows a single user access to the webservice "
"service; however, in most organizations, there is an entire web team in "
"charge of managing the service. A single line can also give access to an "
"entire group. These steps will create a web group, add a user to this group, "
"and allow all members of the group to manage the service:"
msgstr ""
"雖然這項設定可以讓一位使用者存取 <application>webservice</application> 服務，但在大部份組織中會有一整個網站小組負責"
"管理該服務，因此也可以一行來授予整個群組存取權，以下步驟會建立一個網站群組、加入使用者到這個群組，然後讓該群組中的所有成員能夠管理服務："

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2052
#, no-wrap
msgid "# pw groupadd -g 6001 -n webteam\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2055
msgid ""
"Using the same man:pw[8] command, the user is added to the webteam group:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2059
#, no-wrap
msgid "# pw groupmod -m user1 -n webteam\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2062
msgid ""
"Finally, this line in [.filename]#/usr/local/etc/sudoers# allows any member "
"of the webteam group to manage _webservice_:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2066
#, no-wrap
msgid "%webteam   ALL=(ALL)       /usr/sbin/service webservice *\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2069
msgid ""
"Unlike man:su[1], Sudo only requires the end user password. This adds an "
"advantage where users will not need shared passwords, a finding in most "
"security audits and just bad all the way around."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2071
msgid ""
"Users permitted to run applications with Sudo only enter their own "
"passwords. This is more secure and gives better control than man:su[1], "
"where the `root` password is entered and the user acquires all `root` "
"permissions."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:2076
msgid ""
"Most organizations are moving or have moved toward a two factor "
"authentication model. In these cases, the user may not have a password to "
"enter. Sudo provides for these cases with the `NOPASSWD` variable. Adding it "
"to the configuration above will allow all members of the _webteam_ group to "
"manage the service without the password requirement:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2080
#, no-wrap
msgid "%webteam   ALL=(ALL)       NOPASSWD: /usr/sbin/service webservice *\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/handbook/security/_index.adoc:2085
#, no-wrap
msgid "Logging Output"
msgstr "記錄輸出"

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:2088
msgid ""
"An advantage to implementing Sudo is the ability to enable session logging. "
"Using the built in log mechanisms and the included sudoreplay command, all "
"commands initiated through Sudo are logged for later verification. To enable "
"this feature, add a default log directory entry, this example uses a user "
"variable. Several other log filename conventions exist, consult the manual "
"page for sudoreplay for additional information."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2092
#, no-wrap
msgid "Defaults iolog_dir=/var/log/sudo-io/%{user}\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:2098
#, fuzzy
msgid ""
"This directory will be created automatically after the logging is "
"configured. It is best to let the system create directory with default "
"permissions just to be safe. In addition, this entry will also log "
"administrators who use the sudoreplay command. To change this behavior, read "
"and uncomment the logging options inside [.filename]#sudoers#."
msgstr ""
"這個目錄會在記錄功能設定之後自動建立，最好讓系統以預設的權限來建立目錄比較保險，除此之外，這個設定項目也會記錄使用 "
"<application>sudoreplay</application> 指令的管理者，要更改設定請閱讀並取消在 <filename>sudoers</"
"filename> 中記錄選項的註解。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2101
msgid ""
"Once this directive has been added to the [.filename]#sudoers# file, any "
"user configuration can be updated with the request to log access. In the "
"example shown, the updated _webteam_ entry would have the following "
"additional changes:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2105
#, no-wrap
msgid "%webteam ALL=(ALL) NOPASSWD: LOG_INPUT: LOG_OUTPUT: /usr/sbin/service webservice *\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2108
msgid ""
"From this point on, all _webteam_ members altering the status of the "
"_webservice_ application will be logged. The list of previous and current "
"sessions can be displayed with:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2112
#, no-wrap
msgid "# sudoreplay -l\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2115
msgid ""
"In the output, to replay a specific session, search for the `TSID=` entry, "
"and pass that to sudoreplay with no other options to replay the session at "
"normal speed. For example:"
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2119
#, no-wrap
msgid "# sudoreplay user1/00/00/02\n"
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/handbook/security/_index.adoc:2125
#, fuzzy
msgid ""
"While sessions are logged, any administrator is able to remove sessions and "
"leave only a question of why they had done so. It is worthwhile to add a "
"daily check through an intrusion detection system (IDS) or similar software "
"so that other administrators are alerted to manual alterations."
msgstr ""
"雖然所有連線階段都會被記錄，但任何管理者都可以移除連線階段，使得沒人知道它們做了什麼事，所以非常值得在入侵偵測系統 "
"(<acronym>IDS</acronym>) 或類似的軟體加入每日檢查，以便在有人為修改時通知其他管理人員。"

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2128
msgid ""
"The `sudoreplay` is extremely extendable. Consult the documentation for more "
"information."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/handbook/security/_index.adoc:2130
#, no-wrap
msgid "Using doas as an alternative to sudo"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2133
msgid ""
"As an alternative to package:security/sudo[] package:security/doas[] can be "
"used to provide the ability for users to get enhanced privileges."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2135
msgid ""
"The doas utility is available via the ports collection in package:security/"
"doas[] or via the man:pkg[8] utility."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2137
msgid ""
"After the installation [.filename]#/usr/local/etc/doas.conf# must be "
"configured to grant access for users for specific commands, or roles."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2139
msgid ""
"The simpliest entry could be the following, which grants local_user root "
"permissions without asking for its password when executing the doas command."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2143
#, no-wrap
msgid "permit nopass local_user as root\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2146
msgid "For more configuration examples, please read man:doas.conf[5]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/handbook/security/_index.adoc:2148
msgid ""
"After the installation and configuration of the `doas` utility, a command "
"can now be executed with enhanced privileges, like for example."
msgstr ""

#. type: delimited block . 4
#: documentation/content/en/books/handbook/security/_index.adoc:2152
#, no-wrap
msgid "$ doas vi /etc/rc.conf\n"
msgstr ""
