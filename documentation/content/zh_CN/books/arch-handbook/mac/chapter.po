# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR The FreeBSD Project
# This file is distributed under the same license as the FreeBSD Documentation package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
msgid ""
msgstr ""
"Project-Id-Version: FreeBSD Documentation VERSION\n"
"POT-Creation-Date: 2021-02-21 18:54-0300\n"
"PO-Revision-Date: 2021-04-11 12:25+0000\n"
"Last-Translator: Anonymous <noreply@weblate.org>\n"
"Language-Team: Chinese (Simplified) <https://translate-dev.freebsd.org/"
"projects/documentation/booksarch-handbookmacchapter/zh_CN/>\n"
"Language: zh_CN\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=1; plural=0;\n"
"X-Generator: Weblate 4.5.2\n"

#. type: YAML Front Matter: title
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1
#, no-wrap
msgid "Chapter 6. The TrustedBSD MAC Framework"
msgstr ""

#. type: Title =
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:13
#, no-wrap
msgid "The TrustedBSD MAC Framework"
msgstr "TrustedBSD MAC 框架"

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:38
#, no-wrap
msgid "MAC Documentation Copyright"
msgstr "MAC 文档版权声明"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:41
#, fuzzy
msgid ""
"This documentation was developed for the FreeBSD Project by Chris Costello "
"at Safeport Network Services and Network Associates Laboratories, the "
"Security Research Division of Network Associates, Inc. under DARPA/SPAWAR "
"contract N66001-01-C-8035 (\"CBOSS\"), as part of the DARPA CHATS research "
"program."
msgstr ""
"本文档是作为 DARPA CHATS 研究计划的一部分，由供职于 Security Research Division of Network "
"Associates公司Safeport Network Services and Network Associates Laboratories "
"的Chris Costello依据 DARPA/SPAWAR 合同 N66001-01-C-8035 (<quote>CBOSS</quote>)，为 "
"FreeBSD 项目编写的。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:43
msgid ""
"Redistribution and use in source (SGML DocBook) and 'compiled' forms (SGML, "
"HTML, PDF, PostScript, RTF and so forth) with or without modification, are "
"permitted provided that the following conditions are met:"
msgstr ""
"Redistribution and use in source (SGML DocBook) and 'compiled' forms (SGML, "
"HTML, PDF, PostScript, RTF and so forth) with or without modification, are "
"permitted provided that the following conditions are met:"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:45
msgid ""
"Redistributions of source code (SGML DocBook) must retain the above "
"copyright notice, this list of conditions and the following disclaimer as "
"the first lines of this file unmodified."
msgstr ""
"Redistributions of source code (SGML DocBook) must retain the above "
"copyright notice, this list of conditions and the following disclaimer as "
"the first lines of this file unmodified."

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:46
msgid ""
"Redistributions in compiled form (transformed to other DTDs, converted to "
"PDF, PostScript, RTF and other formats) must reproduce the above copyright "
"notice, this list of conditions and the following disclaimer in the "
"documentation and/or other materials provided with the distribution."
msgstr ""
"以编译形式重新分发（转换为其他DTD，转换为PDF，PostScript，RTF和其他格式）必须在随分发提供的文档和/或其他材料中复制上述版权声明，此条件"
"列表和以下免责声明。"

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:50
msgid ""
"THIS DOCUMENTATION IS PROVIDED BY THE NETWORKS ASSOCIATES TECHNOLOGY, INC "
"\"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED "
"TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR "
"PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL NETWORKS ASSOCIATES TECHNOLOGY, "
"INC BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR "
"CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF "
"SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS "
"INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN "
"CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) "
"ARISING IN ANY WAY OUT OF THE USE OF THIS DOCUMENTATION, EVEN IF ADVISED OF "
"THE POSSIBILITY OF SUCH DAMAGE."
msgstr ""
"THIS DOCUMENTATION IS PROVIDED BY THE NETWORKS ASSOCIATES TECHNOLOGY, INC "
"\"AS IS\" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED "
"TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR "
"PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL NETWORKS ASSOCIATES TECHNOLOGY, "
"INC BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR "
"CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF "
"SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS "
"INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN "
"CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) "
"ARISING IN ANY WAY OUT OF THE USE OF THIS DOCUMENTATION, EVEN IF ADVISED OF "
"THE POSSIBILITY OF SUCH DAMAGE."

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:53
#, no-wrap
msgid "Synopsis"
msgstr "简介"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:56
msgid ""
"FreeBSD includes experimental support for several mandatory access control "
"policies, as well as a framework for kernel security extensibility, the "
"TrustedBSD MAC Framework. The MAC Framework is a pluggable access control "
"framework, permitting new security policies to be easily linked into the "
"kernel, loaded at boot, or loaded dynamically at run-time. The framework "
"provides a variety of features to make it easier to implement new security "
"policies, including the ability to easily tag security labels (such as "
"confidentiality information) onto system objects."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:58
msgid ""
"This chapter introduces the MAC policy framework and provides documentation "
"for a sample MAC policy module."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:60
#, no-wrap
msgid "Introduction"
msgstr "介绍"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:63
msgid ""
"The TrustedBSD MAC framework provides a mechanism to allow the compile-time "
"or run-time extension of the kernel access control model. New system "
"policies may be implemented as kernel modules and linked to the kernel; if "
"multiple policy modules are present, their results will be composed. The MAC "
"Framework provides a variety of access control infrastructure services to "
"assist policy writers, including support for transient and persistent "
"policy-agnostic object security labels. This support is currently considered "
"experimental."
msgstr ""
"TrustedBSD MAC 框架提供的机制,允许在其上运行的内核模块在内核编译或者运行时，对内核的访问控制模型进行扩展。新的系统安全策略作为一个内核模块"
"实现,并被链接到内核中；如果系统中同时存在多个安全策略模块，则它们的决策结果将以某种确定的方式组合。为了给简化新安全策略的开发，MAC "
"向上提供了大量用于访问控制的基础设施，特别是，对临时的或者持久的、策略无关的对象安全标记的支持。该支持目前仍是试验性质的。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:65
msgid ""
"This chapter provides information appropriate for developers of policy "
"modules, as well as potential consumers of MAC-enabled environments, to "
"learn about how the MAC Framework supports access control extension of the "
"kernel."
msgstr ""
"本章所提供的信息不仅将使在 MAC 使能环境下工作的潜在用户受益，也可以为需要了解 MAC 框架是如何支持对内核访问控制进行扩展的策略模块开发人员所用。"

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:67
#, no-wrap
msgid "Policy Background"
msgstr "安全策略背景知识"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:70
msgid ""
"Mandatory Access Control (MAC), refers to a set of access control policies "
"that are mandatorily enforced on users by the operating system. MAC policies "
"may be contrasted with Discretionary Access Control (DAC) protections, by "
"which non-administrative users may (at their discretion) protect objects. In "
"traditional UNIX systems, DAC protections include file permissions and "
"access control lists; MAC protections include process controls preventing "
"inter-user debugging and firewalls. A variety of MAC policies have been "
"formulated by operating system designers and security researches, including "
"the Multi-Level Security (MLS) confidentiality policy, the Biba integrity "
"policy, Role-Based Access Control (RBAC), Domain and Type Enforcement (DTE), "
"and Type Enforcement (TE). Each model bases decisions on a variety of "
"factors, including user identity, role, and security clearance, as well as "
"security labels on objects representing concepts such as data sensitivity "
"and integrity."
msgstr ""
"强制访问控制（简称 MAC），是指由操作系统强制实施的一组针对用户的访问控制策略。在某些情况下,强制访问控制的策略可能会与自主访问控制（简称 "
"DAC）所提供的保护措施发生冲突，后者是用来向非管理员用户对数据采取保护措施提供支持的。在传统的 UNIX 系统中，DAC "
"保护措施包括文件访问模式和访问控制列表；而 MAC 则提供进程控制和防火墙等。操作系统设计者和安全机制研究人员对许多经典的 MAC "
"安全策略作了形式化的表述，比如，多级安全（MLS)机密性策略，Biba 完整性策略，基于角色的访问控制策略（RBAC），域和型裁决策略(DTE),以及型裁"
"决策略(TE)。安全策略的形式化表述被称为安全模型。每个模型根据一系列条件做出安全相关的决策，这些条件包括，用户的身份、角色和安全信任状，以及对象的安全标"
"记(用来代表该对象数据的机密性/完整性级别)。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:72
msgid ""
"The TrustedBSD MAC Framework is capable of supporting policy modules that "
"implement all of these policies, as well as a broad class of system "
"hardening policies, which may use existing security attributes, such as user "
"and group IDs, as well as extended attributes on files, and other system "
"properties. In addition, despite the name, the MAC Framework can also be "
"used to implement purely discretionary policies, as policy modules are given "
"substantial flexibility in how they authorize protections."
msgstr ""
"TrustedBSD MAC 框架所提供的对策略模块的支持，不仅可以用来实现上述所有策略，还能用于实现其他利用已有安全属性(如，用户和组ID、文件扩展属性"
"等）决策的系统安全强化策略。此外，因为具体策略模块在访问授权方面所拥有的高度灵活性和自主性，所以MAC 框架同样可以用来实现完全自主式的安全策略."

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:74
#, no-wrap
msgid "MAC Framework Kernel Architecture"
msgstr "MAC 框架的内核体系结构"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:77
msgid ""
"The TrustedBSD MAC Framework permits kernel modules to extend the operating "
"system security policy, as well as providing infrastructure functionality "
"required by many access control modules. If multiple policies are "
"simultaneously loaded, the MAC Framework will usefully (for some definition "
"of useful) compose the results of the policies."
msgstr ""
"TrustedBSD MAC "
"框架为大多数的访问控制模块提供基本设施，允许它们以内核模块的形式灵活地扩展系统中实施的安全策略。如果系统中同时加载了多个策略，MAC "
"框架将负责将各个策略的授权结果以一种（某种程度上）有意义的方式组合，形成最后的决策。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:79
#, no-wrap
msgid "Kernel Elements"
msgstr "内核元素"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:82
msgid "The MAC Framework contains a number of kernel elements:"
msgstr "MAC 框架由下列内核元素组成："

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:84
msgid "Framework management interfaces"
msgstr "框架管理接口"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:85
msgid "Concurrency and synchronization primitives."
msgstr "并发与同步原语。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:86
msgid "Policy registration"
msgstr "策略注册"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:87
msgid "Extensible security label for kernel objects"
msgstr "内核对象的扩展性安全标记"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:88
msgid "Policy entry point composition operators"
msgstr "策略入口函数的组合操作"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:89
msgid "Label management primitives"
msgstr "标记管理原语"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:90
msgid "Entry point API invoked by kernel services"
msgstr "由内核服务调用的入口函数 API"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:91
msgid "Entry point API to policy modules"
msgstr "策略模块的入口函数 API"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:92
msgid ""
"Entry points implementations (policy life cycle, object life cycle/label "
"management, access control checks)."
msgstr "入口函数的实现（包括策略生命周期管理、标记管理和访问控制检查三部分）。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:93
msgid "Policy-agnostic label-management system calls"
msgstr "管理策略无关标记的系统调用"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:94
msgid "`mac_syscall()` multiplex system call"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:95
msgid "Various security policies implemented as MAC policy modules"
msgstr "以 MAC 的策略加载模块形式实现的各种安全策略"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:97
#, no-wrap
msgid "Framework Management Interfaces"
msgstr "框架管理接口"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:100
msgid ""
"The TrustedBSD MAC Framework may be directly managed using sysctl's, loader "
"tunables, and system calls."
msgstr "对 TrustedBSD MAC 框架进行直接管理的方式有三种:通过 sysctl 子系统、通过 loader 配置, 或者使用系统调用。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:102
msgid ""
"In most cases, sysctl's and loader tunables of the same name modify the same "
"parameters, and control behavior such as enforcement of protections relating "
"to various kernel subsystems. In addition, if MAC debugging support is "
"compiled into the kernel, several counters will be maintained tracking label "
"allocation. It is generally advisable that per-subsystem enforcement "
"controls not be used to control policy behavior in production environments, "
"as they broadly impact the operation of all active policies. Instead, "
"per-policy controls should be preferred, as they provide greater granularity "
"and greater operational consistency for policy modules."
msgstr ""
"多数情况下，与同一个内核内部变量相关联的 sysctl 变量和 loader "
"参数的名字是相同的，通过设置它们，可以控制保护措施的实施细节，比如，某个策略在各个内核子系统中的实施与否等等。另外，如果在内核编译时选择支持 MAC 调试"
"选项，内核将维护若干计数器以跟踪标记的分配使用情况。通常不建议在实用环境下通过在不同子系统上设置不同的变量或参数来实施控制，因为这种方法将会作用于系统中所"
"有的活跃策略。如果希望对具体策略实施管理而不相影响其他活跃策略,则应当使用策略级别的控制，因为这种方法的控制粒度更细，并能更好地保证策略模块的功能一致性。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:104
msgid ""
"Loading and unloading of policy modules is performed using the system module "
"management system calls and other system interfaces, including boot loader "
"variables; policy modules will have the opportunity to influence load and "
"unload events, including preventing undesired unloading of the policy."
msgstr ""
"与其他内核模块一样，系统管理员可以通过系统的模块管理系统调用和其他系统接口，包括 boot loader "
"变量，对策略模块执行加载与卸载操作；策略模块可以在加载时,设置加载标志,来指示系统对其加载、卸载操作进行相应控制，比如阻止非期望的卸载操作。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:106
#, no-wrap
msgid "Policy List Concurrency and Synchronization"
msgstr "策略链表的并发与同步"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:109
msgid ""
"As the set of active policies may change at run-time, and the invocation of "
"entry points is non-atomic, synchronization is required to prevent loading "
"or unloading of policies while an entry point invocation is in progress, "
"freezing the set of active policies for the duration. This is accomplished "
"by means of a framework busy count: whenever an entry point is entered, the "
"busy count is incremented; whenever it is exited, the busy count is "
"decremented. While the busy count is elevated, policy list changes are not "
"permitted, and threads attempting to modify the policy list will sleep until "
"the list is not busy. The busy count is protected by a mutex, and a "
"condition variable is used to wake up sleepers waiting on policy list "
"modifications. One side effect of this synchronization model is that "
"recursion into the MAC Framework from within a policy module is permitted, "
"although not generally used."
msgstr ""
"在运行时,系统中活跃的策略集合可能发生变化，然而对策略入口函数的使用操作并不是原子性的，因此，当某一个入口函数正被使用时，\n"
"        系统需要提供额外的同步机制来阻止对该策略模块的加载与卸载，以确保当前活跃的策略集合不会在此过程中发生改变。\n"
"        通过使用\"框架忙”计数器,就可以做到这一点：一旦某个入口函数被调用，计数器的值被增加1；而每当一个入口函数调用结束时，计数器的值被减少1"
"。检查计数器的值，如果其值为正，框架将阻止对策略链表的修改操作，请求操作的线程将被迫进入睡眠，直到计数器的值重新减少到0为止。计数器本身由一个互斥锁保护，"
"同时结合一个条件变量(用于唤醒等待对策略链表进行修改操作的睡眠线程)。采用这种同步模型的一个副作用是，在同一个策略模块内部，允许嵌套地调用框架，不过这种情"
"况其实很少出现。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:111
msgid ""
"Various optimizations are used to reduce the overhead of the busy count, "
"including avoiding the full cost of incrementing and decrementing if the "
"list is empty or contains only static entries (policies that are loaded "
"before the system starts, and cannot be unloaded). A compile-time option is "
"also provided which prevents any change in the set of loaded policies at "
"run-time, which eliminates the mutex locking costs associated with "
"supporting dynamically loaded and unloaded policies as synchronization is no "
"longer required."
msgstr ""
"为了减少由于采用计数器引入的额外开销，设计者采用了各种优化措施。其中包括，当策略链表为空或者其中仅含有静态表项（那些只能在系统运行之前加载而且不能动态卸载"
"的策略）时，框架不对计数器进行操作，其值总是为0，从而将此时的同步开销减到0。另一个极端的办法是，使用一个编译选项来禁止在运行时对加载的策略链表进行修改，"
"此时不再需要对策略链表的使用进行同步保护。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:113
msgid ""
"As the MAC Framework is not permitted to block in some entry points, a "
"normal sleep lock cannot be used; as a result, it is possible for the load "
"or unload attempt to block for a substantial period of time waiting for the "
"framework to become idle."
msgstr "因为 MAC 框架不允许在某些入口函数之内阻塞，所以不能使用普通的睡眠锁。故而，加载或卸载操作可能会为等待框架空闲而被阻塞相当长的一段时间。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:115
#, no-wrap
msgid "Label Synchronization"
msgstr "标记同步"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:118
msgid ""
"As kernel objects of interest may generally be accessed from more than one "
"thread at a time, and simultaneous entry of more than one thread into the "
"MAC Framework is permitted, security attribute storage maintained by the MAC "
"Framework is carefully synchronized. In general, existing kernel "
"synchronization on kernel object data is used to protect MAC Framework "
"security labels on the object: for example, MAC labels on sockets are "
"protected using the existing socket mutex. Likewise, semantics for "
"concurrent access are generally identical to those of the container objects: "
"for credentials, copy-on-write semantics are maintained for label contents "
"as with the remainder of the credential structure. The MAC Framework asserts "
"necessary locks on objects when invoked with an object reference. Policy "
"authors must be aware of these synchronization semantics, as they will "
"sometimes limit the types of accesses permitted on labels: for example, when "
"a read-only reference to a credential is passed to a policy via an entry "
"point, only read operations are permitted on the label state attached to the "
"credential."
msgstr ""
"MAC 框架必须对其负责维护的安全属性标记的存储访问提供同步保护。下列两种情形，可能导致对安全属性标记的不一致访问：第一，作为安全属性标记的持有者，内核对"
"象本身可能同时被多个线程访问；第二，MAC 框架代码是可重入的，即允许多个线程同时在框架内执行。通常，MAC "
"框架使用内核对象数据上已有的内核同步机制来保护该其上附加的 MAC 安全标记。例如，套接字上的 MAC "
"标记由已有的套接字互斥锁保护。类似的，对于安全标记的并发访问的过程与对其所在对象进行的并发访问在语义上是一样的，例如，信任状安全标记,"
"将保持与该数据结构中其他内容一致的\"写时复制\"的更新过程。MAC "
"框架在引用一个内核对象时，将首先对访问该对象上的标记需要用到的锁进行断言。策略模块的编写者必须了解这些同步语义， "
"因为它们可能会限制对安全标记所能进行的访问类型。 "
"举个例子，如果通过入口函数传给策略模块的是对某个信任状的只读引用，那么在策略内部，只能读该结构对应的标记状态。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:120
#, no-wrap
msgid "Policy Synchronization and Concurrency"
msgstr "策略间的同步与并发"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:123
msgid ""
"Policy modules must be written to assume that many kernel threads may "
"simultaneously enter one more policy entry points due to the parallel and "
"preemptive nature of the FreeBSD kernel. If the policy module makes use of "
"mutable state, this may require the use of synchronization primitives within "
"the policy to prevent inconsistent views on that state resulting in "
"incorrect operation of the policy. Policies will generally be able to make "
"use of existing FreeBSD synchronization primitives for this purpose, "
"including mutexes, sleep locks, condition variables, and counting "
"semaphores. However, policies should be written to employ these primitives "
"carefully, respecting existing kernel lock orders, and recognizing that some "
"entry points are not permitted to sleep, limiting the use of primitives in "
"those entry points to mutexes and wakeup operations."
msgstr ""
"FreeBSD 内核是一个可抢占式的内核，因此，作为内核一部分的策略模块也必须是可重入的，也就是说，在开发策略模块时必须假设多个内核线程可以同时通过不同的"
"入口函数进入该模块。如果策略模块使用可被修改的内核状态，那么还需要在策略内部使用恰当的同步原语，确保在策略内部的多个线程不会因此观察到不一致的内核状态，从"
"而避免由此产生的策略误操作。为此，策略可以使用 FreeBSD 现有的同步原语，包括互斥锁、睡眠锁、条件变量和计数信号量。对这些同步原语的使用必须慎重，需"
"要特别注意两点：第一，保持现有的内核上锁次序；第二，在非睡眠的入口函数之内不要使用互斥锁和唤醒操作。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:125
msgid ""
"When policy modules call out to other kernel subsystems, they will generally "
"need to release any in-policy locks in order to avoid violating the kernel "
"lock order or risking lock recursion. This will maintain policy locks as "
"leaf locks in the global lock order, helping to avoid deadlock."
msgstr ""
"为避免违反内核上锁次序或造成递归上锁，策略模块在调用其他内核子系统之前，通常要释放所有在策略内部申请的锁。这样做的结果是，在全局上锁次序形成的拓朴结构中，"
"策略内部的锁总是作为叶子节点，从而保证了这些锁的使用不会导致由于上锁次序混乱造成的死锁。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:127
#, no-wrap
msgid "Policy Registration"
msgstr "策略注册"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:130
#, fuzzy
msgid ""
"The MAC Framework maintains two lists of active policies: a static list, and "
"a dynamic list. The lists differ only with regards to their locking "
"semantics: an elevated reference count is not required to make use of the "
"static list. When kernel modules containing MAC Framework policies are "
"loaded, the policy module will use `SYSINIT` to invoke a registration "
"function; when a policy module is unloaded, `SYSINIT` will likewise invoke a "
"de-registration function. Registration may fail if a policy module is loaded "
"more than once, if insufficient resources are available for the registration "
"(for example, the policy might require labeling and insufficient labeling "
"state might be available), or other policy prerequisites might not be met "
"(some policies may only be loaded prior to boot). Likewise, de-registration "
"may fail if a policy is flagged as not unloadable."
msgstr ""
"为了记录当前使用的策略模块集合，MAC 框架维护两个链表：一个静态链表和一个动态链表。\n"
"       两个链表的数据结构和操作基本相同，只是动态链表还额外使用了一个\"引用计数\"以同步对其的访问操作。\n"
"       当包含 MAC 框架策略的内核模块被加载时，该策略模块会通过 <literal>SYSINIT</literal> 调用一个注册函数；\n"
"       相对应的，每当一个策略模块被卸载，<literal>SYSINIT</literal> "
"也会调用一个注销函数。只有当遇到下列情况之一时，注册过程才会失败： 一个策略模块被加载多次，或者系统资源不足不能满足注册过程的需要（例如，策略模块需要对内"
"核对象添加标记而可用资源不足），或者其他的策略加载前提条件不满足（有些策略要求只能在系统引导之前加载）。类似的，如果一个策略被标记为不可卸载的，对其调用注"
"销过程将会失败。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:132
#, no-wrap
msgid "Entry Points"
msgstr "入口函数"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:135
msgid ""
"Kernel services interact with the MAC Framework in two ways: they invoke a "
"series of APIs to notify the framework of relevant events, and they provide "
"a policy-agnostic label structure pointer in security-relevant objects. The "
"label pointer is maintained by the MAC Framework via label management entry "
"points, and permits the Framework to offer a labeling service to policy "
"modules through relatively non-invasive changes to the kernel subsystem "
"maintaining the object. For example, label pointers have been added to "
"processes, process credentials, sockets, pipes, vnodes, Mbufs, network "
"interfaces, IP reassembly queues, and a variety of other security-relevant "
"structures. Kernel services also invoke the MAC Framework when they perform "
"important security decisions, permitting policy modules to augment those "
"decisions based on their own criteria (possibly including data stored in "
"security labels). Most of these security critical decisions will be explicit "
"access control checks; however, some affect more general decision functions "
"such as packet matching for sockets and label transition at program "
"execution."
msgstr ""
"内核服务与 MAC 框架之间进行交互有两种途径：一是，内核服务调用一系列 API 通知 MAC 框架安全事件的发生；二是，内核服务向 MAC "
"框架提供一个指向安全对象的策略无关安全标记数据结构的指针。标记指针由 MAC "
"框架经由标记管理入口函数进行维护，并且，只要对管理相关对象的内核子系统稍作修改，就可以允许 MAC "
"框架向策略模块提供标记服务。例如，在进程、进程信任状、套接字、管道、Mbuf、网络接口、IP "
"重组队列和其他各种安全相关的数据结构中均增加了指向安全标记的指针。另外，当需要做出重要的安全决策时，内核服务也会调用 MAC 框架，以便各个策略模块根据其"
"自己的标准（可以使用存储在安全标记中的数据）完善这些决策。绝大多数安全相关的关键决策是显式的访问控制检查；也有少数涉及更加一般的决策函数，比如，套接字的数"
"据包匹配和程序执行时刻的标记转换。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:137
#, no-wrap
msgid "Policy Composition"
msgstr "策略组合"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:140
msgid ""
"When more than one policy module is loaded into the kernel at a time, the "
"results of the policy modules will be composed by the framework using a "
"composition operator. This operator is currently hard-coded, and requires "
"that all active policies must approve a request for it to return success. As "
"policies may return a variety of error conditions (success, access denied, "
"object does not exist, ...), a precedence operator selects the resulting "
"error from the set of errors returned by policies. In general, errors "
"indicating that an object does not exist will be preferred to errors "
"indicating that access to an object is denied. While it is not guaranteed "
"that the resulting composition will be useful or secure, we have found that "
"it is for many useful selections of policies. For example, traditional "
"trusted systems often ship with two or more policies using a similar "
"composition."
msgstr ""
"如果内核中同时加载了多个策略模块，这些策略的决策结果将由框架使用一个合成运算子来进行组合汇总，得出最终的结果。目前，该算子是硬编码的，并且只有当所有的活跃"
"策略均对请求表示同意时才会返回成功。由于各个策略返回的出错条件可能并不相同（成功、访问被拒绝、请求对象不存在等等），需要使用一个选择子先从各个策略返回的错"
"误条件集合中选择出一个作为最终返回结果。一般情况下，与“访问被拒绝”相比，将更倾向于选择“请求对象不存在”。尽管不能从理论上保证合成结果的有效性与安全性，"
"但试验结果表明，对于许多实用的策略集合来说，事实的确如此。例如，传统的可信系统常常采用类似的方法对多个安全策略进行组合。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:142
#, no-wrap
msgid "Labeling Support"
msgstr "标记支持"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:145
msgid ""
"As many interesting access control extensions rely on security labels on "
"objects, the MAC Framework provides a set of policy-agnostic label "
"management system calls covering a variety of user-exposed objects. Common "
"label types include partition identifiers, sensitivity labels, integrity "
"labels, compartments, domains, roles, and types. By policy agnostic, we mean "
"that policy modules are able to completely define the semantics of meta-data "
"associated with an object. Policy modules participate in the internalization "
"and externalization of string-based labels provides by user applications, "
"and can expose multiple label elements to applications if desired."
msgstr ""
"与许多需要给对象添加安全标记的访问控制扩展一样，MAC 框架为各种用户可见的对象提供了一组用于管理策略无关标记的系统调用。常用的标记类型有，partiti"
"on标识符、机密性标记、完整性标记、区间（非等级类别）、域、角色和型。“策略无关”的意思是指，标记的语法与使用它的具体策略模块无关，而同时策略模块能够完全"
"独立地定义和使用与对象相关联的元数据的语义。用户应用程序提供统一格式的基于字符串的标记，由使用它的策略模块负责解析其内在含义并决定其外在表示。如果需要，应"
"用程序可以使用多重标记元素。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:147
#, fuzzy
msgid ""
"In-memory labels are stored in slab-allocated `struct label`, which consists "
"of a fixed-length array of unions, each holding a `void *` pointer and a "
"`long`. Policies registering for label storage will be assigned a \"slot\" "
"identifier, which may be used to dereference the label storage. The "
"semantics of the storage are left entirely up to the policy module: modules "
"are provided with a variety of entry points associated with the kernel "
"object life cycle, including initialization, association/creation, and "
"destruction. Using these interfaces, it is possible to implement reference "
"counting and other storage models. Direct access to the object structure is "
"generally not required by policy modules to retrieve a label, as the MAC "
"Framework generally passes both a pointer to the object and a direct pointer "
"to the object's label into entry points. The primary exception to this rule "
"is the process credential, which must be manually dereferenced to access the "
"credential label. This may change in future revisions of the MAC Framework."
msgstr ""
"内存中的标记实例被存放在由 slab 分配的<varname remap=\"structname\">struct "
"label</varname>数据结构中。该结构是一个固定长度的数组，每个元素是由一个 <literal>void *</literal>指针和一个 "
"<literal>long</literal>组成的联合结构。申请标记存储的策略模块在向 MAC "
"注册时，将被分配一个“slot”值，作为框架分配给其使用的策略标记元素在整个标记存储结构中的位置索引。而所分配的存储空间的语义则完全由该策略模块来决定："
"MAC 框架向策略模块提供了一系列入口函数用于对内核对象生命周期的各种事件进行控制，包括，对象的初始化、标记的关联/创建和对象的注销。使用这些接口，可以实"
"现诸如访问计数等存储模型。MAC 框架总是给入口函数传入一个指向相关对象的指针和一个指向该对象标记的指针，因此，策略模块能够直接访问标记而无需知悉该对象的"
"内部结构。唯一的例外是进程信任状结构，指向其标记的指针必须由策略模块手动解析计算。今后的 MAC 框架实现可能会对此进行改进。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:149
msgid ""
"Initialization entry points frequently include a sleeping disposition flag "
"indicating whether or not an initialization is permitted to sleep; if "
"sleeping is not permitted, a failure may be returned to cancel allocation of "
"the label (and hence object). This may occur, for example, in the network "
"stack during interrupt handling, where sleeping is not permitted, or while "
"the caller holds a mutex. Due to the performance cost of maintaining labels "
"on in-flight network packets (Mbufs), policies must specifically declare a "
"requirement that Mbuf labels be allocated. Dynamically loaded policies "
"making use of labels must be able to handle the case where their init "
"function has not been called on an object, as objects may already exist when "
"the policy is loaded. The MAC Framework guarantees that uninitialized label "
"slots will hold a 0 or NULL value, which policies may use to detect "
"uninitialized values. However, as allocation of Mbuf labels is conditional, "
"policies must also be able to handle a NULL label pointer for Mbufs if they "
"have been loaded dynamically."
msgstr ""
"初始化入口函数通常有一个睡眠标志位，用来表明一个初始化操作是否允许中途睡眠等待；如果不允许，则可能会失败返回，并要求撤销此次标记分配操作（乃至对象分配操作"
"）。例如，如果在网络栈上处理中断时因为不允许睡眠或者调用者持有一个互斥锁，就可能出现这种情况。考虑到在处理中的网络数据包（Mbufs）上维护标记的性能损失"
"太大，策略必须就自己对 Mbuf 进行标记的要求向 MAC 框架做出特别声明。动态加载到系统中而又使用标记的策略必须为处理未被其初始化函数处理过的对象作好"
"准备，这些对象在策略加载之前就已经存在,故而无法在初始化时调用策略的相关函数进行处理。MAC 框架向策略保证，没有被初始化的标记 slot "
"的值必为0或者 NULL，策略可以借此检测到未初始化的标记。需要注意的是，因为对 Mbuf 标记的存储分配是有条件的，"
"因此需要使用其标记的动态加载策略还可能需要处理 Mbuf 中值为 NULL 的标记指针。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:151
#, fuzzy
msgid ""
"In the case of file system labels, special support is provided for the "
"persistent storage of security labels in extended attributes. Where "
"available, extended attribute transactions are used to permit consistent "
"compound updates of security labels on vnodes--currently this support is "
"present only in the UFS2 file system. Policy authors may choose to implement "
"multilabel file system object labels using one (or more) extended "
"attributes. For efficiency reasons, the vnode label (`v_label`) is a cache "
"of any on-disk label; policies are able to load values into the cache when "
"the vnode is instantiated, and update the cache as needed. As a result, the "
"extended attribute need not be directly accessed with every access control "
"check."
msgstr ""
"对于文件系统对象的标记，MAC 框架在文件的扩展属性中为其分配永久存储。只要可能，扩展属性的原子化的事务操作就被用于保证对 vnode "
"上安全标记的复合更新操作的一致性－－目前，该特性只被 UFS2 "
"文件系统支持。为了实现细粒度的文件系统对象标记（即每个文件系统对象一个标记），策略编写者可能选择使用一个（或者若干）扩展属性块。为了提高性能，"
"\tvnode 数据结构中有一个标记 (<literal>v_label</literal>)字段，用作磁盘标记的缓冲；vnode "
"结构实例化时，策略可以将标记值装入该缓冲，并在需要时对其进行更新。如此，不必在每次进行访问控制检查时，均无条件地访问磁盘上的扩展属性。"

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:155
msgid ""
"Currently, if a labeled policy permits dynamic unloading, its state slot "
"cannot be reclaimed, which places a strict (and relatively low) bound on the "
"number of unload-reload operations for labeled policies."
msgstr ""
"目前，如果一个使用标记的策略允许被动态卸载，则卸载该模块之后,其状态 slot 尚无法被系统回收重用，由此导致了 MAC "
"框架对标记策略卸载－重载操作数目上的严格限制。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:158
#, no-wrap
msgid "System Calls"
msgstr "相关系统调用"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:161
msgid ""
"The MAC Framework implements a number of system calls: most of these calls "
"support the policy-agnostic label retrieval and manipulation APIs exposed to "
"user applications."
msgstr "MAC 框架向应用程序提供了一组系统调用：其中大多数用于向进行查询和修改策略无关标记操作的应用 API提供支持。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:163
#, fuzzy
msgid ""
"The label management calls accept a label description structure, `struct "
"mac`, which contains a series of MAC label elements. Each element contains a "
"character string name, and character string value. Each policy will be given "
"the chance to claim a particular element name, permitting policies to expose "
"multiple independent elements if desired. Policy modules perform the "
"internalization and externalization between kernel labels and user-provided "
"labels via entry points, permitting a variety of semantics. Label management "
"system calls are generally wrapped by user library functions to perform "
"memory allocation and error handling, simplifying user applications that "
"must manage labels."
msgstr ""
"这些标记管理系统调用，接受一个标记描述结构， <varname remap=\"structname\">struct "
"mac</varname>，作为输入参数。这个结构的主体是一个数组，其中每个元素包含了一个应用级的 MAC 标记形式。每个元素又由两部分组成:一个字符串名"
"字，和其对应的值。每个策略可以向系统声明一个特定的元素名字，这样一来，如果需要，就可以将若干个相互独立的元素作为一个整体进行处理。策略模块经由入口函数，在"
"内核标记和用户提供的标记之间作翻译转换的工作，这种实现提供了标记元素语义上的高度灵活性。标记管理系统调用通常有对应的库函数包装，这些包装函数可以提供内存分"
"配和错误处理功能，从而简化了用户应用程序的标记管理工作。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:165
msgid "The following MAC-related system calls are present in the FreeBSD kernel:"
msgstr "目前的FreeBSD 内核提供了下列 MAC 相关的系统调用："

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:167
msgid "`mac_get_proc()` may be used to retrieve the label of the current process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:168
msgid ""
"`mac_set_proc()` may be used to request a change in the label of the current "
"process."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:169
msgid ""
"`mac_get_fd()` may be used to retrieve the label of an object (file, socket, "
"pipe, ...) referenced by a file descriptor."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:170
msgid ""
"`mac_get_file()` may be used to retrieve the label of an object referenced "
"by a file system path."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:171
msgid ""
"`mac_set_fd()` may be used to request a change in the label of an object "
"(file, socket, pipe, ...) referenced by a file descriptor."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:172
msgid ""
"`mac_set_file()` may be used to request a change in the label of an object "
"referenced by a file system path."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:173
#, fuzzy
msgid ""
"`mac_syscall()` permits policy modules to create new system calls without "
"modifying the system call table; it accepts a target policy name, operation "
"number, and opaque argument for use by the policy."
msgstr ""
"<function>mac_syscall()</function> "
"通过复用该系统调用,策略模块能够在不修改系统调用表的前提下创建新的系统调用；其调用参数包括：目标策略名字、 操作编号和将被该策略内部使用的参数。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:174
msgid ""
"`mac_get_pid()` may be used to request the label of another process by "
"process id."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:175
msgid ""
"`mac_get_link()` is identical to `mac_get_file()`, only it will not follow a "
"symbolic link if it is the final entry in the path, so may be used to "
"retrieve the label on a symlink."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:176
msgid ""
"`mac_set_link()` is identical to `mac_set_file()`, only it will not follow a "
"symbolic link if it is the final entry in a path, so may be used to "
"manipulate the label on a symlink."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:177
#, fuzzy
msgid ""
"`mac_execve()` is identical to the `execve()` system call, only it also "
"accepts a requested label to set the process label to when beginning "
"execution of a new program. This change in label on execution is referred to "
"as a \"transition\"."
msgstr ""
"<function>mac_execve()</function> 与<function>execve()</function> "
"功能类似，只是前者还可以在开始执行一个新程序时,根据传入的请求参数,设置执行进程的安全标记。由于执行一个新程序而导致的进程安全标记的改变,被称为“转换”。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:178
msgid ""
"`mac_get_peer()`, actually implemented via a socket option, retrieves the "
"label of a remote peer on a socket, if available."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:180
msgid ""
"In addition to these system calls, the `SIOCSIGMAC` and `SIOCSIFMAC` network "
"interface ioctls permit the labels on network interfaces to be retrieved and "
"set."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:182
#, no-wrap
msgid "MAC Policy Architecture"
msgstr "MAC策略模块体系结构"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:185
msgid ""
"Security policies are either linked directly into the kernel, or compiled "
"into loadable kernel modules that may be loaded at boot, or dynamically "
"using the module loading system calls at runtime. Policy modules interact "
"with the system through a set of declared entry points, providing access to "
"a stream of system events and permitting the policy to influence access "
"control decisions. Each policy contains a number of elements:"
msgstr ""
"安全策略可以直接编入内核，也可以编译成独立的内核模块，在系统引导时或者运行时使用模块加载命令加载。策略模块通过一组预先定义好的入口函数与系统交互。通过它们"
"，策略模块能够掌握某些系统事件的发生，并且在必要的时候影响系统的访问控制决策。每个策略模块包含下列组成部分："

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:187
msgid "Optional configuration parameters for policy."
msgstr "可选：策略配置参数。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:188
msgid "Centralized implementation of the policy logic and parameters."
msgstr "策略逻辑和参数的集中实现。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:189
msgid ""
"Optional implementation of policy life cycle events, such as initialization "
"and destruction."
msgstr "可选：策略生命周期事件的实现，比如，策略的初始化和销毁。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:190
msgid ""
"Optional support for initializing, maintaining, and destroying labels on "
"selected kernel objects."
msgstr "可选：对所选内核对象的安全标记进行初始化、维护和销毁的支持。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:191
msgid ""
"Optional support for user process inspection and modification of labels on "
"selected objects."
msgstr "可选：对所选对象的使用进程进行监控以及修改对象安全标记的支持。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:192
msgid ""
"Implementation of selected access control entry points that are of interest "
"to the policy."
msgstr "策略相关的访问控制入口函数的实现。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:193
msgid "Declaration of policy identity, module entry points, and policy properties."
msgstr "对策略标志、模块入口函数和策略特性的声明。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:195
#, no-wrap
msgid "Policy Declaration"
msgstr "策略注销"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:198
#, fuzzy
msgid ""
"Modules may be declared using the `MAC_POLICY_SET()` macro, which names the "
"policy, provides a reference to the MAC entry point vector, provides "
"load-time flags determining how the policy framework should handle the "
"policy, and optionally requests the allocation of label state by the "
"framework."
msgstr ""
"策略模块可以使用\t<function>MAC_POLICY_SET()</function> "
"宏来声明。该宏完成以下工作：为该策略命名（向系统声明该策略提供的名字）；提交策略定义的 MAC 入口函数向量的地址；按照策略的要求设置该策略的加载标志位，"
"保证 MAC 框架将以策略所期望的方式对其进行操作；另外，还可能请求框架为策略分配标记状态 slot 值。"

#. type: delimited block . 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:212
#, no-wrap
msgid ""
"static struct mac_policy_ops mac_policy_ops =\n"
"{\n"
"        .mpo_destroy = mac_policy_destroy,\n"
"        .mpo_init = mac_policy_init,\n"
"        .mpo_init_bpfdesc_label = mac_policy_init_bpfdesc_label,\n"
"        .mpo_init_cred_label = mac_policy_init_label,\n"
"/* ... */\n"
"        .mpo_check_vnode_setutimes = mac_policy_check_vnode_setutimes,\n"
"        .mpo_check_vnode_stat = mac_policy_check_vnode_stat,\n"
"        .mpo_check_vnode_write = mac_policy_check_vnode_write,\n"
"};\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:215
#, fuzzy
msgid ""
"The MAC policy entry point vector, `mac__policy__ops` in this example, "
"associates functions defined in the module with specific entry points. A "
"complete listing of available entry points and their prototypes may be found "
"in the MAC entry point reference section. Of specific interest during module "
"registration are the .mpo_destroy and .mpo_init entry points. .mpo_init will "
"be invoked once a policy is successfully registered with the module "
"framework but prior to any other entry points becoming active. This permits "
"the policy to perform any policy-specific allocation and initialization, "
"such as initialization of any data or locks. .mpo_destroy will be invoked "
"when a policy module is unloaded to permit releasing of any allocated memory "
"and destruction of locks. Currently, these two entry points are invoked with "
"the MAC policy list mutex held to prevent any other entry points from being "
"invoked: this will be changed, but in the mean time, policies should be "
"careful about what kernel primitives they invoke so as to avoid lock "
"ordering or sleeping problems."
msgstr ""
"如上所示，MAC 策略入口函数向量，<varname>mac_<replaceable>policy</replaceable>_ops</varname"
">，将策略模块中定义的功能函数挂接到特定的入口函数地址上。在稍后的“入口函数参考”小节中，将提供可用入口函数功能描述和原型的完整列表。与模块注册相关的入口"
"函数有两个：<symbol>.mpo_destroy</symbol>和<symbol>."
"mpo_init</symbol>。当某个策略向模块框架注册操作成功时，<symbol>.mpo_init</symbol>将被调用，此后其他的入口函数才"
"能被使用。这种特殊的设计使得策略有机会根据自己的需要，进行特定的分配和初始化操作，比如对特殊数据或锁的初始化。卸载一个策略模块时，将调用 <symbol>"
".mpo_destroy</symbol> 用来释放策略分配的内存空间或注销其申请的锁。目前，为了防止其他入口函数被同时调用，"
"调用上述两个入口函数的进程必须持有 MAC "
"策略链表的互斥锁：这种限制将被放开，但与此同时，将要求策略必须谨慎使用内核原语,以避免由于上锁次序或睡眠造成死锁。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:217
msgid ""
"The policy declaration's module name field exists so that the module may be "
"uniquely identified for the purposes of module dependencies. An appropriate "
"string should be selected. The full string name of the policy is displayed "
"to the user via the kernel log during load and unload events, and also "
"exported when providing status information to userland processes."
msgstr ""
"之所以向策略声明提供模块名字域，是为了能够唯一标识该模块，以便解析模块依赖关系。选择使用恰当的字符串作为名字。在策略加载和卸载时，策略的完整字符串名字将经"
"由内核日志显示给用户。另外，当向用户进程报告状态信息时也会包含该字符串。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:219
#, no-wrap
msgid "Policy Flags"
msgstr "策略标志"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:222
msgid ""
"The policy declaration flags field permits the module to provide the "
"framework with information about its capabilities at the time the module is "
"loaded. Currently, three flags are defined:"
msgstr "在声明时提供标志参数域的机制，允许策略模块在作为模块被加载时，就自身特性向 MAC 框架提供说明。目前，已经定义的标志有三个："

#. type: Labeled list
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:223
#, no-wrap
msgid "MPC_LOADTIME_FLAG_UNLOADOK"
msgstr "MPC_LOADTIME_FLAG_UNLOADOK"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:225
msgid ""
"This flag indicates that the policy module may be unloaded. If this flag is "
"not provided, then the policy framework will reject requests to unload the "
"module. This flag might be used by modules that allocate label state and are "
"unable to free that state at runtime."
msgstr ""
"表示该策略模块可以被卸载。如果未提供该标志，则表示该策略模块拒绝被卸载。那些使用安全标记的状态，而又不能在运行时释放该状态的模块可能会设置该标志。"

#. type: Labeled list
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:226
#, no-wrap
msgid "MPC_LOADTIME_FLAG_NOTLATE"
msgstr "MPC_LOADTIME_FLAG_NOTLATE"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:228
msgid ""
"This flag indicates that the policy module must be loaded and initialized "
"early in the boot process. If the flag is specified, attempts to register "
"the module following boot will be rejected. The flag may be used by policies "
"that require pervasive labeling of all system objects, and cannot handle "
"objects that have not been properly initialized by the policy."
msgstr "表示该策略模块必须在系统引导过程时进行加载和初始化。如果该标志被设置，那么在系统引导之后注册该模块的请求将被。"

#. type: Labeled list
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:229
#, no-wrap
msgid "MPC_LOADTIME_FLAG_LABELMBUFS"
msgstr "MPC_LOADTIME_FLAG_LABELMBUFS"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:231
#, fuzzy
msgid ""
"This flag indicates that the policy module requires labeling of Mbufs, and "
"that memory should always be allocated for the storage of Mbuf labels. By "
"default, the MAC Framework will not allocate label storage for Mbufs unless "
"at least one loaded policy has this flag set. This measurably improves "
"network performance when policies do not require Mbuf labeling. A kernel "
"option, `MAC_ALWAYS_LABEL_MBUF`, exists to force the MAC Framework to "
"allocate Mbuf label storage regardless of the setting of this flag, and may "
"be useful in some environments."
msgstr ""
"表示该策略模块要求为 Mbuf 指定安全标记，并且为存储其标记所需的内存空间总是提前分配好的。缺省情况下，MAC 框架并不会为 Mbuf "
"分配标记存储，除非系统中注册的策略模块中至少有一个设置了该标志。这种做法在没有策略需要对 Mbuf 做标记时，显著地提升了系统网络性能。另外，在某些特殊环"
"境下，可以通过设置内核选项，<literal>MAC_ALWAYS_LABEL_MBUF</literal>，强制 MAC 框架为 Mbuf "
"的安全标记分配存储，而不论上述标志如何设置。"

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:235
#, fuzzy
msgid ""
"Policies using the `MPC_LOADTIME_FLAG_LABELMBUFS` without the "
"`MPC_LOADTIME_FLAG_NOTLATE` flag set must be able to correctly handle `NULL` "
"Mbuf label pointers passed into entry points. This is necessary as in-flight "
"Mbufs without label storage may persist after a policy enabling Mbuf "
"labeling has been loaded. If a policy is loaded before the network subsystem "
"is active (i.e., the policy is not being loaded late), then all Mbufs are "
"guaranteed to have label storage."
msgstr ""
"<literal>MPC_LOADTIME_FLAG_NOTLATE</literal> 标志的策略模块必须能够正确地处理通过入口函数传入的值为 "
"<literal>NULL</literal>的 Mbuf 安全标记指针。这是因为那些没有分配标记存储的处理中的 Mbuf 在一个需要 Mbuf "
"安全标记的策略模块加载之后，其安全标记的指针将仍然为空。如果策略在网络子系统活跃之前被加载（即，该策略不是被推迟加载的），那么所有的 Mbuf "
"的标记存储的分配就可以得到保证。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:238
#, no-wrap
msgid "Policy Entry Points"
msgstr "策略入口函数"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:241
#, fuzzy
msgid ""
"Four classes of entry points are offered to policies registered with the "
"framework: entry points associated with the registration and management of "
"policies, entry points denoting initialization, creation, destruction, and "
"other life cycle events for kernel objects, events associated with access "
"control decisions that the policy module may influence, and calls associated "
"with the management of labels on objects. In addition, a `mac_syscall()` "
"entry point is provided so that policies may extend the kernel interface "
"without registering new system calls."
msgstr ""
"MAC 框架为注册的策略提供四种类型的入口函数：策略注册和管理入口函数；用于处理内核对象声明周期事件，如初始化、创建和销毁，的入口函数；处理该策略模块感兴"
"趣的访问控制决策事件的入口函数；以及用于管理对象安全标记的调用入口函数。此外，还有一个 <function>mac_syscall()</"
"function> 入口函数，被策略模块用于在不注册新的系统调用的前提下，扩展内核接口。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:243
msgid ""
"Policy module writers should be aware of the kernel locking strategy, as "
"well as what object locks are available during which entry points. Writers "
"should attempt to avoid deadlock scenarios by avoiding grabbing non-leaf "
"locks inside of entry points, and also follow the locking protocol for "
"object access and modification. In particular, writers should be aware that "
"while necessary locks to access objects and their labels are generally held, "
"sufficient locks to modify an object or its label may not be present for all "
"entry points. Locking information for arguments is documented in the MAC "
"framework entry point document."
msgstr ""
"策略模块的编写人员除了必须清楚在进入特定入口函数之后，哪些对象锁是可用的之外，还应该熟知内核所采用的加锁策略。编程人员在入口函数之内应该避免使用非叶节点锁"
"，并且遵循访问和修改对象时的加锁规程，以降低导致死锁的可能性。特别地，程序员应该清楚，虽然在通常情况下，进入入口函数之后，已经上了一些锁，可以安全地访问对"
"象及其安全标记，但是这并不能保证对它们进行修改（包括对象本身和其安全标记）也是安全的。相关的上锁信息，可以参考 MAC 框架入口函数的相关文档。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:245
msgid ""
"Policy entry points will pass a reference to the object label along with the "
"object itself. This permits labeled policies to be unaware of the internals "
"of the object yet still make decisions based on the label. The exception to "
"this is the process credential, which is assumed to be understood by "
"policies as a first class security object in the kernel."
msgstr ""
"策略入口函数把两个分别指向对象本身和其安全标记的指针传递给策略模块。这样一来，即使策略并不熟悉对象内部结构，也能基于标记作出正确决策。只有进程信任状这个对"
"象例外：MAC 框架总是假设所有的策略模块是理解其内部结构的。"

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:247
#, no-wrap
msgid "MAC Policy Entry Point Reference"
msgstr "MAC策略入口函数参考"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:250
#, no-wrap
msgid "General-Purpose Module Entry Points"
msgstr "通用的模块入口函数"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:253
#, no-wrap
msgid "`mpo_init`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:259
#, no-wrap
msgid ""
"void mpo_init(\tconf);\t \n"
"struct mac_policy_conf *conf;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:271
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:294
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`conf`\n"
"|MAC policy definition\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:274
msgid ""
"Policy load event. The policy list mutex is held, so sleep operations cannot "
"be performed, and calls out to other kernel subsystems must be made with "
"caution. If potentially sleeping memory allocations are required during "
"policy initialization, they should be made using a separate module "
"SYSINIT()."
msgstr ""
"策略加载事件。当前进程正持有策略链表上的互斥锁，因此是非睡眠的，对其他内核子系统的调用也须慎重。如果需要在策略初始化阶段进行可能造成睡眠阻塞的存储分配操作"
"，可以将它们放在一个单独的模块 SYSINIT()过程中集中进行。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:276
#, no-wrap
msgid "`mpo_destroy`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:282
#, no-wrap
msgid ""
"void mpo_destroy(\tconf);\t \n"
"struct mac_policy_conf *conf;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:297
msgid ""
"Policy load event. The policy list mutex is held, so caution should be "
"applied."
msgstr "策略加载事件。必须持有策略链表互斥锁，因此需要慎重行事。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:299
#, no-wrap
msgid "`mpo_syscall`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:309
#, no-wrap
msgid ""
"int mpo_syscall(\ttd, \t \n"
" \tcall, \t \n"
" \targ);\t \n"
"struct thread *td;\n"
"int call;\n"
"void *arg;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:329
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`td`\n"
"|Calling thread\n"
"|\n"
"\n"
"|`call`\n"
"|Policy-specific syscall number\n"
"|\n"
"\n"
"|`arg`\n"
"|Pointer to syscall arguments\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:332
msgid ""
"This entry point provides a policy-multiplexed system call so that policies "
"may provide additional services to user processes without registering "
"specific system calls. The policy name provided during registration is used "
"to demux calls from userland, and the arguments will be forwarded to this "
"entry point. When implementing new services, security modules should be sure "
"to invoke appropriate access control checks from the MAC framework as "
"needed. For example, if a policy implements an augmented signal "
"functionality, it should call the necessary signal access control checks to "
"invoke the MAC framework and other registered policies."
msgstr ""
"该入口函数提供策略复用的系统调用，这样策略模块不需要为其向用户进程提供的每一个额外服务而注册专用的系统调用。由应用程序提供的策略注册名字来确定提供其所申请"
"服务的特定策略，所有参数将通过该入口函数传递给被调用的策略。当实现新服务时，安全模块必须在必要时通过 MAC "
"框架调用相应的访问控制检查机制。比方说，假如一个策略实现了某种额外的信号功能，那么它应该调用相关的信号访问控制检查，以接受 MAC "
"框架中注册的其他策略的检查。"

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:336
msgid ""
"Modules must currently perform the `copyin()` of the syscall data on their "
"own."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:339
#, no-wrap
msgid "`mpo_thread_userret`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:345
#, no-wrap
msgid ""
"void mpo_thread_userret(\ttd);\t \n"
"struct thread *td;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:357
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`td`\n"
"|Returning thread\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:360
#, fuzzy
msgid ""
"This entry point permits policy modules to perform MAC-related events when a "
"thread returns to user space, via a system call return, trap return, or "
"otherwise. This is required for policies that have floating process labels, "
"as it is not always possible to acquire the process lock at arbitrary points "
"in the stack during system call processing; process labels might represent "
"traditional authentication data, process history information, or other "
"data. To employ this mechanism, intended changes to the process credential "
"label may be stored in the `p_label` protected by a per-policy spin lock, "
"and then set the per-thread `TDF_ASTPENDING` flag and per-process "
"`PS_MACPENDM` flag to schedule a call to the userret entry point. From this "
"entry point, the policy may create a replacement credential with less "
"concern about the locking context. Policy writers are cautioned that event "
"ordering relating to scheduling an AST and the AST being performed may be "
"complex and interlaced in multithreaded applications."
msgstr ""
"使用该入口函数，策略模块能够在线程返回用户空间时（系统调用返回、异常返回等等）进行 MAC 相关的处理工作。使用动态进程标记的策略需要使用该入口函数，因为"
"在处理系统调用的过程中，并不是在任意时刻都能申请到进程锁的；进程的标记可能表示传统的认证信息、进程历史记录或者其他数据。为使用该入口函数，"
"对进程信任状所作的修改可能被存放在 <literal>p_label</literal> ,该域受一个进程级自旋锁的保护；接下来，设置线程级的<liter"
"al>TDF_ASTPENDING</literal>标志位和进程级的<literal>PS_MACPENDM</literal>标志位，"
"表明将调度一个对 userret 入口函数的调用。通过该入口函数，策略可以在相对简单的同步上下文中创建信任状的替代品。策略编程人员必须清楚，"
"需要保证与调度一个 AST 相关的事件执行次序，同时所执行的 AST 可能很复杂，而且在处理多线程应用程序时可能被重入。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:362
#, no-wrap
msgid "Label Operations"
msgstr "操作标记"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:365
#, no-wrap
msgid "`mpo_init_bpfdesc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:371
#, no-wrap
msgid ""
"void mpo_init_bpfdesc_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:383
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:429
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:452
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|New label to apply\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:386
msgid ""
"Initialize the label on a newly instantiated bpfdesc (BPF "
"descriptor). Sleeping is permitted."
msgstr "为一个新近实例化的 bpfdesc（BPF 描述子）初始化标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:388
#, no-wrap
msgid "`mpo_init_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:394
#, no-wrap
msgid ""
"void mpo_init_cred_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:406
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:666
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:689
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|New label to initialize\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:409
msgid ""
"Initialize the label for a newly instantiated user credential. Sleeping is "
"permitted."
msgstr "为一个新近实例化的用户信任状初始化标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:411
#, no-wrap
msgid "`mpo_init_devfsdirent_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:417
#, no-wrap
msgid ""
"void mpo_init_devfsdirent_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:432
msgid ""
"Initialize the label on a newly instantiated devfs entry. Sleeping is "
"permitted."
msgstr "为一个新近实例化的用户信任状初始化标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:434
#, no-wrap
msgid "`mpo_init_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:440
#, no-wrap
msgid ""
"void mpo_init_ifnet_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:455
msgid ""
"Initialize the label on a newly instantiated network interface. Sleeping is "
"permitted."
msgstr "为一个新近实例化的用户信任状初始化标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:457
#, no-wrap
msgid "`mpo_init_ipq_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:465
#, no-wrap
msgid ""
"void mpo_init_ipq_label(\tlabel, \t \n"
" \tflag);\t \n"
"struct label *label;\n"
"int flag;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:481
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|New label to apply\n"
"|\n"
"\n"
"|`flag`\n"
"|Sleeping/non-sleeping man:malloc[9]; see below\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:484
msgid ""
"Initialize the label on a newly instantiated IP fragment reassembly "
"queue. The `flag` field may be one of M_WAITOK and M_NOWAIT, and should be "
"employed to avoid performing a sleeping man:malloc[9] during this "
"initialization call. IP fragment reassembly queue allocation frequently "
"occurs in performance sensitive environments, and the implementation should "
"be careful to avoid sleeping or long-lived operations. This entry point is "
"permitted to fail resulting in the failure to allocate the IP fragment "
"reassembly queue."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:486
#, no-wrap
msgid "`mpo_init_mbuf_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:494
#, no-wrap
msgid ""
"void mpo_init_mbuf_label(\tflag, \t \n"
" \tlabel);\t \n"
"int flag;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:510
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`flag`\n"
"|Sleeping/non-sleeping man:malloc[9]; see below\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label to initialize\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:513
msgid ""
"Initialize the label on a newly instantiated mbuf packet header "
"(`mbuf`). The `flag` field may be one of M_WAITOK and M_NOWAIT, and should "
"be employed to avoid performing a sleeping man:malloc[9] during this "
"initialization call. Mbuf allocation frequently occurs in performance "
"sensitive environments, and the implementation should be careful to avoid "
"sleeping or long-lived operations. This entry point is permitted to fail "
"resulting in the failure to allocate the mbuf header."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:515
#, no-wrap
msgid "`mpo_init_mount_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:523
#, no-wrap
msgid ""
"void mpo_init_mount_label(\tmntlabel, \t \n"
" \tfslabel);\t \n"
"struct label *mntlabel;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:539
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`mntlabel`\n"
"|Policy label to be initialized for the mount itself\n"
"|\n"
"\n"
"|`fslabel`\n"
"|Policy label to be initialized for the file system\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:542
msgid ""
"Initialize the labels on a newly instantiated mount point. Sleeping is "
"permitted."
msgstr "为一个新近实例化的 mount 点初始化标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:544
#, no-wrap
msgid "`mpo_init_mount_fs_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:550
#, no-wrap
msgid ""
"void mpo_init_mount_fs_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:562
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Label to be initialized\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:565
msgid "Initialize the label on a newly mounted file system. Sleeping is permitted"
msgstr "为一个新近加载的文件系统初始化标记。可以睡眠"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:567
#, no-wrap
msgid "`mpo_init_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:573
#, no-wrap
msgid ""
"void mpo_init_pipe_label(\tlabel);\t \n"
"struct label*label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:585
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Label to be filled in\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:588
msgid "Initialize a label for a newly instantiated pipe. Sleeping is permitted."
msgstr "为一个刚刚实例化的管道初始化安全标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:590
#, no-wrap
msgid "`mpo_init_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:598
#, no-wrap
msgid ""
"void mpo_init_socket_label(\tlabel, \t \n"
" \tflag);\t \n"
"struct label *label;\n"
"int flag;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:614
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:643
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|New label to initialize\n"
"|\n"
"\n"
"|`flag`\n"
"|man:malloc[9] flags\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:617
msgid ""
"Initialize a label for a newly instantiated socket. The `flag` field may be "
"one of M_WAITOK and M_NOWAIT, and should be employed to avoid performing a "
"sleeping man:malloc[9] during this initialization call."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:619
#, no-wrap
msgid "`mpo_init_socket_peer_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:627
#, no-wrap
msgid ""
"void mpo_init_socket_peer_label(\tlabel, \t \n"
" \tflag);\t \n"
"struct label *label;\n"
"int flag;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:646
msgid ""
"Initialize the peer label for a newly instantiated socket. The `flag` field "
"may be one of M_WAITOK and M_NOWAIT, and should be employed to avoid "
"performing a sleeping man:malloc[9] during this initialization call."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:648
#, no-wrap
msgid "`mpo_init_proc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:654
#, no-wrap
msgid ""
"void mpo_init_proc_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:669
msgid ""
"Initialize the label for a newly instantiated process. Sleeping is "
"permitted."
msgstr "为一个刚刚实例化的进程初始化安全标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:671
#, no-wrap
msgid "`mpo_init_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:677
#, no-wrap
msgid ""
"void mpo_init_vnode_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:692
msgid "Initialize the label on a newly instantiated vnode. Sleeping is permitted."
msgstr "为一个刚刚实例化的 vnode 初始化安全标记。可以睡眠。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:694
#, no-wrap
msgid "`mpo_destroy_bpfdesc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:700
#, no-wrap
msgid ""
"void mpo_destroy_bpfdesc_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:712
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|bpfdesc label\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:715
msgid ""
"Destroy the label on a BPF descriptor. In this entry point a policy should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:717
#, no-wrap
msgid "`mpo_destroy_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:723
#, no-wrap
msgid ""
"void mpo_destroy_cred_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:735
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:758
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:781
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:804
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:827
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Label being destroyed\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:738
msgid ""
"Destroy the label on a credential. In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:740
#, no-wrap
msgid "`mpo_destroy_devfsdirent_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:746
#, no-wrap
msgid ""
"void mpo_destroy_devfsdirent_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:761
msgid ""
"Destroy the label on a devfs entry. In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:763
#, no-wrap
msgid "`mpo_destroy_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:769
#, no-wrap
msgid ""
"void mpo_destroy_ifnet_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:784
msgid ""
"Destroy the label on a removed interface. In this entry point, a policy "
"module should free any internal storage associated with `label` so that it "
"may be destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:786
#, no-wrap
msgid "`mpo_destroy_ipq_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:792
#, no-wrap
msgid ""
"void mpo_destroy_ipq_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:807
msgid ""
"Destroy the label on an IP fragment queue. In this entry point, a policy "
"module should free any internal storage associated with `label` so that it "
"may be destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:809
#, no-wrap
msgid "`mpo_destroy_mbuf_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:815
#, no-wrap
msgid ""
"void mpo_destroy_mbuf_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:830
msgid ""
"Destroy the label on an mbuf header. In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:832
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:855
#, no-wrap
msgid "`mpo_destroy_mount_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:838
#, no-wrap
msgid ""
"void mpo_destroy_mount_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:850
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Mount point label being destroyed\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:853
msgid ""
"Destroy the labels on a mount point. In this entry point, a policy module "
"should free the internal storage associated with `mntlabel` so that they may "
"be destroyed."
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:863
#, no-wrap
msgid ""
"void mpo_destroy_mount_label(\tmntlabel, \t \n"
" \tfslabel);\t \n"
"struct label *mntlabel;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:879
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`mntlabel`\n"
"|Mount point label being destroyed\n"
"|\n"
"\n"
"|`fslabel`\n"
"|File system label being destroyed>\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:882
msgid ""
"Destroy the labels on a mount point. In this entry point, a policy module "
"should free the internal storage associated with `mntlabel` and `fslabel` so "
"that they may be destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:884
#, no-wrap
msgid "`mpo_destroy_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:890
#, no-wrap
msgid ""
"void mpo_destroy_socket_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:902
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Socket label being destroyed\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:905
msgid ""
"Destroy the label on a socket. In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:907
#, no-wrap
msgid "`mpo_destroy_socket_peer_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:913
#, no-wrap
msgid ""
"void mpo_destroy_socket_peer_label(\tpeerlabel);\t \n"
"struct label *peerlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:925
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`peerlabel`\n"
"|Socket peer label being destroyed\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:928
msgid ""
"Destroy the peer label on a socket. In this entry point, a policy module "
"should free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:930
#, no-wrap
msgid "`mpo_destroy_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:936
#, no-wrap
msgid ""
"void mpo_destroy_pipe_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:948
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Pipe label\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:951
msgid ""
"Destroy the label on a pipe. In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:953
#, no-wrap
msgid "`mpo_destroy_proc_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:959
#, no-wrap
msgid ""
"void mpo_destroy_proc_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:971
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:994
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Process label\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:974
msgid ""
"Destroy the label on a process. In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:976
#, no-wrap
msgid "`mpo_destroy_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:982
#, no-wrap
msgid ""
"void mpo_destroy_vnode_label(\tlabel);\t \n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:997
msgid ""
"Destroy the label on a vnode. In this entry point, a policy module should "
"free any internal storage associated with `label` so that it may be "
"destroyed."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:999
#, no-wrap
msgid "`mpo_copy_mbuf_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1007
#, no-wrap
msgid ""
"void mpo_copy_mbuf_label(\tsrc, \t \n"
" \tdest);\t \n"
"struct label *src;\n"
"struct label *dest;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1023
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1052
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1081
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`src`\n"
"|Source label\n"
"|\n"
"\n"
"|`dest`\n"
"|Destination label\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1026
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1055
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1084
msgid "Copy the label information in `src` into `dest`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1028
#, no-wrap
msgid "`mpo_copy_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1036
#, no-wrap
msgid ""
"void mpo_copy_pipe_label(\tsrc, \t \n"
" \tdest);\t \n"
"struct label *src;\n"
"struct label *dest;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1057
#, no-wrap
msgid "`mpo_copy_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1065
#, no-wrap
msgid ""
"void mpo_copy_vnode_label(\tsrc, \t \n"
" \tdest);\t \n"
"struct label *src;\n"
"struct label *dest;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1086
#, no-wrap
msgid "`mpo_externalize_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1098
#, no-wrap
msgid ""
"int mpo_externalize_cred_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \tsb, \t \n"
" \t*claimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1122
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1163
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1204
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1245
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1286
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1327
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Label to be externalized\n"
"|\n"
"\n"
"|`element_name`\n"
"|Name of the policy whose label should be externalized\n"
"|\n"
"\n"
"|`sb`\n"
"|String buffer to be filled with a text representation of label\n"
"|\n"
"\n"
"|`claimed`\n"
"|Should be incremented when `element_data` can be filled in.\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1125
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1166
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1207
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1248
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1289
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1330
msgid ""
"Produce an externalized label based on the label structure passed. An "
"externalized label consists of a text representation of the label contents "
"that can be used with userland applications and read by the user. Currently, "
"all policies' `externalize` entry points will be called, so the "
"implementation should check the contents of `element_name` before attempting "
"to fill in `sb`. If `element_name` does not match the name of your policy, "
"simply return 0. Only return nonzero if an error occurs while externalizing "
"the label data. Once the policy fills in `element_data`, `*claimed` should "
"be incremented."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1127
#, no-wrap
msgid "`mpo_externalize_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1139
#, no-wrap
msgid ""
"int mpo_externalize_ifnet_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \tsb, \t \n"
" \t*claimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1168
#, no-wrap
msgid "`mpo_externalize_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1180
#, no-wrap
msgid ""
"int mpo_externalize_pipe_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \tsb, \t \n"
" \t*claimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1209
#, no-wrap
msgid "`mpo_externalize_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1221
#, no-wrap
msgid ""
"int mpo_externalize_socket_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \tsb, \t \n"
" \t*claimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1250
#, no-wrap
msgid "`mpo_externalize_socket_peer_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1262
#, no-wrap
msgid ""
"int mpo_externalize_socket_peer_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \tsb, \t \n"
" \t*claimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1291
#, no-wrap
msgid "`mpo_externalize_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1303
#, no-wrap
msgid ""
"int mpo_externalize_vnode_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \tsb, \t \n"
" \t*claimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"struct sbuf *sb;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1332
#, no-wrap
msgid "`mpo_internalize_cred_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1344
#, no-wrap
msgid ""
"int mpo_internalize_cred_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \telement_data, \t \n"
" \tclaimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1368
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1409
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1450
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1491
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1532
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`label`\n"
"|Label to be filled in\n"
"|\n"
"\n"
"|`element_name`\n"
"|Name of the policy whose label should be internalized\n"
"|\n"
"\n"
"|`element_data`\n"
"|Text data to be internalized\n"
"|\n"
"\n"
"|`claimed`\n"
"|Should be incremented when data can be successfully internalized.\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1371
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1412
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1453
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1494
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1535
msgid ""
"Produce an internal label structure based on externalized label data in text "
"format. Currently, all policies' `internalize` entry points are called when "
"internalization is requested, so the implementation should compare the "
"contents of `element_name` to its own name in order to be sure it should be "
"internalizing the data in `element_data`. Just as in the `externalize` entry "
"points, the entry point should return 0 if `element_name` does not match its "
"own name, or when data can successfully be internalized, in which case "
"`*claimed` should be incremented."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1373
#, no-wrap
msgid "`mpo_internalize_ifnet_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1385
#, no-wrap
msgid ""
"int mpo_internalize_ifnet_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \telement_data, \t \n"
" \tclaimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1414
#, no-wrap
msgid "`mpo_internalize_pipe_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1426
#, no-wrap
msgid ""
"int mpo_internalize_pipe_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \telement_data, \t \n"
" \tclaimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1455
#, no-wrap
msgid "`mpo_internalize_socket_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1467
#, no-wrap
msgid ""
"int mpo_internalize_socket_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \telement_data, \t \n"
" \tclaimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1496
#, no-wrap
msgid "`mpo_internalize_vnode_label`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1508
#, no-wrap
msgid ""
"int mpo_internalize_vnode_label(\tlabel, \t \n"
" \telement_name, \t \n"
" \telement_data, \t \n"
" \tclaimed);\t \n"
"struct label *label;\n"
"char *element_name;\n"
"char *element_data;\n"
"int *claimed;\n"
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1537
#, no-wrap
msgid "Label Events"
msgstr "标记事件"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1540
msgid ""
"This class of entry points is used by the MAC framework to permit policies "
"to maintain label information on kernel objects. For each labeled kernel "
"object of interest to a MAC policy, entry points may be registered for "
"relevant life cycle events. All objects implement initialization, creation, "
"and destruction hooks. Some objects will also implement relabeling, allowing "
"user processes to change the labels on objects. Some objects will also "
"implement object-specific events, such as label events associated with IP "
"reassembly. A typical labeled object will have the following life cycle of "
"entry points:"
msgstr ""
"策略模块使用MAC 框架提供的“标记事件”类入口函数，对内核对象的标记进行操作。策略模块将感兴趣的被标记内核对象的相关生命周期事件注册在恰当的入口点上。对"
"象的初始化、创建和销毁事件均提供了钩子点。在某些对象上还可以实现重新标记，即，允许用户进程改变对象上的标记值。对某些对象可以实现其特定的对象事件，比如与 "
"IP 重组相关的标记事件。一个典型的被标记对象在其生命周期中将拥有下列入口函数："

#. type: delimited block . 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1552
#, no-wrap
msgid ""
"Label initialization          o\n"
"(object-specific wait)         \\\n"
"Label creation                  o\n"
"                                 \\\n"
"Relabel events,                   o--<--.\n"
"Various object-specific,          |     |\n"
"Access control events             ~-->--o\n"
"                                         \\\n"
"Label destruction                         o\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1555
msgid ""
"Label initialization permits policies to allocate memory and set initial "
"values for labels without context for the use of the object. The label slot "
"allocated to a policy will be zeroed by default, so some policies may not "
"need to perform initialization."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1557
msgid ""
"Label creation occurs when the kernel structure is associated with an actual "
"kernel object. For example, Mbufs may be allocated and remain unused in a "
"pool until they are required. mbuf allocation causes label initialization on "
"the mbuf to take place, but mbuf creation occurs when the mbuf is associated "
"with a datagram. Typically, context will be provided for a creation event, "
"including the circumstances of the creation, and labels of other relevant "
"objects in the creation process. For example, when an mbuf is created from a "
"socket, the socket and its label will be presented to registered policies in "
"addition to the new mbuf and its label. Memory allocation in creation events "
"is discouraged, as it may occur in performance sensitive ports of the "
"kernel; in addition, creation calls are not permitted to fail so a failure "
"to allocate memory cannot be reported."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1559
#, fuzzy
msgid ""
"Object specific events do not generally fall into the other broad classes of "
"label events, but will generally provide an opportunity to modify or update "
"the label on an object based on additional context. For example, the label "
"on an IP fragment reassembly queue may be updated during the MAC_UPDATE_IPQ "
"entry point as a result of the acceptance of an additional mbuf to that "
"queue."
msgstr ""
"对象特有的事件一般不会引发其他的标记事件，但是在对象上下文发生改变时，策略使用它们可以对相关标记进行修改或更新操作。例如，在<symbol>MAC_UPD"
"ATE_IPQ</symbol> 入口函数之内，某个 IP 分片重组队列的标记可能会因为队列中接收了新的 mbuf 而被更新。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1561
msgid "Access control events are discussed in detail in the following section."
msgstr "访问控制事件将在后续章节中详细讨论。"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1563
msgid ""
"Label destruction permits policies to release storage or state associated "
"with a label during its association with an object so that the kernel data "
"structures supporting the object may be reused or released."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1565
#, fuzzy
msgid ""
"In addition to labels associated with specific kernel objects, an additional "
"class of labels exists: temporary labels. These labels are used to store "
"update information submitted by user processes. These labels are initialized "
"and destroyed as with other label types, but the creation event is "
"MAC_INTERNALIZE, which accepts a user label to be converted to an in-kernel "
"representation."
msgstr ""
"除了与特定内核对象绑定的普通标记之外，还有一种额外的标记类型：临时标记。这些标记用于存放由用户进程提交的更新信息。它们的初始化和销毁操作与其他标记一样，只"
"是创建事件，<symbol>MAC_INTERNALIZE</symbol>，略有不同：该函数接受用户提交的标记，负责将其转化为内核表示形式。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1567
#, no-wrap
msgid "File System Object Labeling Event Operations"
msgstr "文件系统对象标记事件操作"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1570
#, no-wrap
msgid "`mpo_associate_vnode_devfs`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1586
#, no-wrap
msgid ""
"void mpo_associate_vnode_devfs(\tmp, \t \n"
" \tfslabel, \t \n"
" \tde, \t \n"
" \tdelabel, \t \n"
" \tvp, \t \n"
" \tvlabel);\t \n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct devfs_dirent *de;\n"
"struct label *delabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1618
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`mp`\n"
"|Devfs mount point\n"
"|\n"
"\n"
"|`fslabel`\n"
"|Devfs file system label (`mp->mnt_fslabel`)\n"
"|\n"
"\n"
"|`de`\n"
"|Devfs directory entry\n"
"|\n"
"\n"
"|`delabel`\n"
"|Policy label associated with `de`\n"
"|\n"
"\n"
"|`vp`\n"
"|vnode associated with `de`\n"
"|\n"
"\n"
"|`vlabel`\n"
"|Policy label associated with `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1621
msgid ""
"Fill in the label (`vlabel`) for a newly created devfs vnode based on the "
"devfs directory entry passed in `de` and its label."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1623
#, no-wrap
msgid "`mpo_associate_vnode_extattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1635
#, no-wrap
msgid ""
"int mpo_associate_vnode_extattr(\tmp, \t \n"
" \tfslabel, \t \n"
" \tvp, \t \n"
" \tvlabel);\t \n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1659
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1700
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`mp`\n"
"|File system mount point\n"
"|\n"
"\n"
"|`fslabel`\n"
"|File system label\n"
"|\n"
"\n"
"|`vp`\n"
"|Vnode to label\n"
"|\n"
"\n"
"|`vlabel`\n"
"|Policy label associated with `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1662
msgid ""
"Attempt to retrieve the label for `vp` from the file system extended "
"attributes. Upon success, the value `0` is returned. Should extended "
"attribute retrieval not be supported, an accepted fallback is to copy "
"`fslabel` into `vlabel`. In the event of an error, an appropriate value for "
"`errno` should be returned."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1664
#, no-wrap
msgid "`mpo_associate_vnode_singlelabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1676
#, no-wrap
msgid ""
"void mpo_associate_vnode_singlelabel(\tmp, \t \n"
" \tfslabel, \t \n"
" \tvp, \t \n"
" \tvlabel);\t \n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1703
msgid ""
"On non-multilabel file systems, this entry point is called to set the policy "
"label for `vp` based on the file system label, `fslabel`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1705
#, no-wrap
msgid "`mpo_create_devfs_device`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1715
#, no-wrap
msgid ""
"void mpo_create_devfs_device(\tdev, \t \n"
" \tdevfs_dirent, \t \n"
" \tlabel);\t \n"
"dev_t dev;\n"
"struct devfs_dirent *devfs_dirent;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1735
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`dev`\n"
"|Device corresponding with `devfs_dirent`\n"
"|\n"
"\n"
"|`devfs_dirent`\n"
"|Devfs directory entry to be labeled.\n"
"|\n"
"\n"
"|`label`\n"
"|Label for `devfs_dirent` to be filled in.\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1738
msgid ""
"Fill out the label on a devfs_dirent being created for the passed "
"device. This call will be made when the device file system is mounted, "
"regenerated, or a new device is made available."
msgstr "为传入设备新建的 devfs_dirent 填写标记。该函数将在设备文件系统加载、重构或添加新设备时被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1740
#, no-wrap
msgid "`mpo_create_devfs_directory`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1752
#, no-wrap
msgid ""
"void mpo_create_devfs_directory(\tdirname, \t \n"
" \tdirnamelen, \t \n"
" \tdevfs_dirent, \t \n"
" \tlabel);\t \n"
"char *dirname;\n"
"int dirnamelen;\n"
"struct devfs_dirent *devfs_dirent;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1772
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`dirname`\n"
"|Name of directory being created\n"
"|\n"
"\n"
"|`namelen`\n"
"|Length of string `dirname`\n"
"|\n"
"\n"
"|`devfs_dirent`\n"
"|Devfs directory entry for directory being created.\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1775
msgid ""
"Fill out the label on a devfs_dirent being created for the passed "
"directory. This call will be made when the device file system is mounted, "
"regenerated, or a new device requiring a specific directory hierarchy is "
"made available."
msgstr "为传入目录参数的新建 devfs_dirent 填写标记。该函数将在加载、重构设备文件系统，或者添加一个需要指定目录结构的新设备时被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1777
#, no-wrap
msgid "`mpo_create_devfs_symlink`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1793
#, no-wrap
msgid ""
"void mpo_create_devfs_symlink(\tcred, \t \n"
" \tmp, \t \n"
" \tdd, \t \n"
" \tddlabel, \t \n"
" \tde, \t \n"
" \tdelabel);\t \n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct devfs_dirent *dd;\n"
"struct label *ddlabel;\n"
"struct devfs_dirent *de;\n"
"struct label *delabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1825
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`mp`\n"
"|Devfs mount point\n"
"|\n"
"\n"
"|`dd`\n"
"|Link destination\n"
"|\n"
"\n"
"|`ddlabel`\n"
"|Label associated with `dd`\n"
"|\n"
"\n"
"|`de`\n"
"|Symlink entry\n"
"|\n"
"\n"
"|`delabel`\n"
"|Label associated with `de`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1828
msgid ""
"Fill in the label (`delabel`) for a newly created man:devfs[5] symbolic link "
"entry."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1830
#, no-wrap
msgid "`mpo_create_vnode_extattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1850
#, no-wrap
msgid ""
"int mpo_create_vnode_extattr(\tcred, \t \n"
" \tmp, \t \n"
" \tfslabel, \t \n"
" \tdvp, \t \n"
" \tdlabel, \t \n"
" \tvp, \t \n"
" \tvlabel, \t \n"
" \tcnp);\t \n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *fslabel;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1890
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`mount`\n"
"|File system mount point\n"
"|\n"
"\n"
"|`label`\n"
"|File system label\n"
"|\n"
"\n"
"|`dvp`\n"
"|Parent directory vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Label associated with `dvp`\n"
"|\n"
"\n"
"|`vp`\n"
"|Newly created vnode\n"
"|\n"
"\n"
"|`vlabel`\n"
"|Policy label associated with `vp`\n"
"|\n"
"\n"
"|`cnp`\n"
"|Component name for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1893
msgid ""
"Write out the label for `vp` to the appropriate extended attribute. If the "
"write succeeds, fill in `vlabel` with the label, and return 0. Otherwise, "
"return an appropriate error."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1895
#, no-wrap
msgid "`mpo_create_mount`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1907
#, no-wrap
msgid ""
"void mpo_create_mount(\tcred, \t \n"
" \tmp, \t \n"
" \tmnt, \t \n"
" \tfslabel);\t \n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *mnt;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1931
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`mp`\n"
"|Object; file system being mounted\n"
"|\n"
"\n"
"|`mntlabel`\n"
"|Policy label to be filled in for `mp`\n"
"|\n"
"\n"
"|`fslabel`\n"
"|Policy label for the file system `mp` mounts.\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1934
msgid ""
"Fill out the labels on the mount point being created by the passed subject "
"credential. This call will be made when a new file system is mounted."
msgstr "为传入的主体信任状所创建的挂载点填写标记。该函数将在文件系统挂载时被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1936
#, no-wrap
msgid "`mpo_create_root_mount`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1948
#, no-wrap
msgid ""
"void mpo_create_root_mount(\tcred, \t \n"
" \tmp, \t \n"
" \tmntlabel, \t \n"
" \tfslabel);\t \n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *mntlabel;\n"
"struct label *fslabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1958
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"3+|See <<mac-mpo-create-mount>>.\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1961
msgid ""
"Fill out the labels on the mount point being created by the passed subject "
"credential. This call will be made when the root file system is mounted, "
"after mpo_create_mount;."
msgstr "为传入的主体信任状所创建的挂载点填写标记。该函数将在挂载根文件系统时，在.mpo;_create_mount; 之后被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1963
#, no-wrap
msgid "`mpo_relabel_vnode`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1975
#, no-wrap
msgid ""
"void mpo_relabel_vnode(\tcred, \t \n"
" \tvp, \t \n"
" \tvnodelabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:1999
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|vnode to relabel\n"
"|\n"
"\n"
"|`vnodelabel`\n"
"|Existing policy label for `vp`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|New, possibly partial label to replace `vnodelabel`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2002
msgid ""
"Update the label on the passed vnode given the passed update vnode label and "
"the passed subject credential."
msgstr "根据传入的新标记和主体信任状，更新参数 vnode 的标记。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2004
#, no-wrap
msgid "`mpo_setlabel_vnode_extattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2016
#, no-wrap
msgid ""
"int mpo_setlabel_vnode_extattr(\tcred, \t \n"
" \tvp, \t \n"
" \tvlabel, \t \n"
" \tintlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
"struct label *intlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2040
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Vnode for which the label is being written\n"
"|\n"
"\n"
"|`vlabel`\n"
"|Policy label associated with `vp`\n"
"|\n"
"\n"
"|`intlabel`\n"
"|Label to write out\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2043
msgid ""
"Write out the policy from `intlabel` to an extended attribute. This is "
"called from `vop_stdcreatevnode_ea`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2045
#, no-wrap
msgid "`mpo_update_devfsdirent`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2057
#, no-wrap
msgid ""
"void mpo_update_devfsdirent(\tdevfs_dirent, \t \n"
" \tdirentlabel, \t \n"
" \tvp, \t \n"
" \tvnodelabel);\t \n"
"struct devfs_dirent *devfs_dirent;\n"
"struct label *direntlabel;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2082
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`devfs_dirent`\n"
"|Object; devfs directory entry\n"
"|\n"
"\n"
"|`direntlabel`\n"
"|Policy label for `devfs_dirent` to be updated.\n"
"|\n"
"\n"
"|`vp`\n"
"|Parent vnode\n"
"|Locked\n"
"|\n"
"\n"
"|`vnodelabel`\n"
"|Policy label for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2085
msgid ""
"Update the `devfs_dirent` label from the passed devfs vnode label. This call "
"will be made when a devfs vnode has been successfully relabeled to commit "
"the label change such that it lasts even if the vnode is recycled. It will "
"also be made when a symlink is created in devfs, following a call to "
"`mac_vnode_create_from_vnode` to initialize the vnode label."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2087
#, no-wrap
msgid "IPC Object Labeling Event Operations"
msgstr "IPC 对象标记事件操作"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2090
#, no-wrap
msgid "`mpo_create_mbuf_from_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2102
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_socket(\tso, \t \n"
" \tsocketlabel, \t \n"
" \tm, \t \n"
" \tmbuflabel);\t \n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
"struct mbuf *m;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2126
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`socket`\n"
"|Socket\n"
"|Socket locking WIP\n"
"\n"
"|`socketlabel`\n"
"|Policy label for `socket`\n"
"|\n"
"\n"
"|`m`\n"
"|Object; mbuf\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Policy label to fill in for `m`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2129
msgid ""
"Set the label on a newly created mbuf header from the passed socket "
"label. This call is made when a new datagram or message is generated by the "
"socket and stored in the passed mbuf."
msgstr "根据传入的套接字标记为新创建的mbuf头部设置标记。每当套接字产生一个新的数据报或者消息，并将其存储在参数 mbuf 中时，将调用该函数。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2131
#, no-wrap
msgid "`mpo_create_pipe`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2141
#, no-wrap
msgid ""
"void mpo_create_pipe(\tcred, \t \n"
" \tpipe, \t \n"
" \tpipelabel);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2161
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3497
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3532
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3608
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3643
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`pipe`\n"
"|Pipe\n"
"|\n"
"\n"
"|`pipelabel`\n"
"|Policy label associated with `pipe`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2164
msgid ""
"Set the label on a newly created pipe from the passed subject "
"credential. This call is made when a new pipe is created."
msgstr "根据传入的主体信任状参数，设置新建管道的标记。每当一个新管道被创建，该函数将被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2166
#, no-wrap
msgid "`mpo_create_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2176
#, no-wrap
msgid ""
"void mpo_create_socket(\tcred, \t \n"
" \tso, \t \n"
" \tsocketlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2196
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|Immutable\n"
"\n"
"|`so`\n"
"|Object; socket to label\n"
"|\n"
"\n"
"|`socketlabel`\n"
"|Label to fill in for `so`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2199
msgid ""
"Set the label on a newly created socket from the passed subject "
"credential. This call is made when a socket is created."
msgstr "根据传入的主体信任状参数，设置新建套接字的标记。每当新建一个套接字，该函数将被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2201
#, no-wrap
msgid "`mpo_create_socket_from_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2213
#, no-wrap
msgid ""
"void mpo_create_socket_from_socket(\toldsocket, \t \n"
" \toldsocketlabel, \t \n"
" \tnewsocket, \t \n"
" \tnewsocketlabel);\t \n"
"struct socket *oldsocket;\n"
"struct label *oldsocketlabel;\n"
"struct socket *newsocket;\n"
"struct label *newsocketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2237
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`oldsocket`\n"
"|Listening socket\n"
"|\n"
"\n"
"|`oldsocketlabel`\n"
"|Policy label associated with `oldsocket`\n"
"|\n"
"\n"
"|`newsocket`\n"
"|New socket\n"
"|\n"
"\n"
"|`newsocketlabel`\n"
"|Policy label associated with `newsocketlabel`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2240
msgid ""
"Label a socket, `newsocket`, newly man:accept[2]ed, based on the "
"man:listen[2] socket, `oldsocket`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2242
#, no-wrap
msgid "`mpo_relabel_pipe`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2254
#, no-wrap
msgid ""
"void mpo_relabel_pipe(\tcred, \t \n"
" \tpipe, \t \n"
" \toldlabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *oldlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2278
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`pipe`\n"
"|Pipe\n"
"|\n"
"\n"
"|`oldlabel`\n"
"|Current policy label associated with `pipe`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Policy label update to apply to `pipe`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2281
msgid "Apply a new label, `newlabel`, to `pipe`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2283
#, no-wrap
msgid "`mpo_relabel_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2295
#, no-wrap
msgid ""
"void mpo_relabel_socket(\tcred, \t \n"
" \tso, \t \n"
" \toldlabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *oldlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2319
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|Immutable\n"
"\n"
"|`so`\n"
"|Object; socket\n"
"|\n"
"\n"
"|`oldlabel`\n"
"|Current label for `so`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Label update for `so`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2322
msgid "Update the label on a socket from the passed socket label update."
msgstr "根据传入的标记参数，对套接字的当前标记进行更新。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2324
#, no-wrap
msgid "`mpo_set_socket_peer_from_mbuf`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2336
#, no-wrap
msgid ""
"void mpo_set_socket_peer_from_mbuf(\tmbuf, \t \n"
" \tmbuflabel, \t \n"
" \toldlabel, \t \n"
" \tnewlabel);\t \n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
"struct label *oldlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2360
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`mbuf`\n"
"|First datagram received over socket\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Label for `mbuf`\n"
"|\n"
"\n"
"|`oldlabel`\n"
"|Current label for the socket\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Policy label to be filled out for the socket\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2363
msgid ""
"Set the peer label on a stream socket from the passed mbuf label. This call "
"will be made when the first datagram is received by the stream socket, with "
"the exception of Unix domain sockets."
msgstr ""
"根据传入的 mbuf 标记，设置某个 stream 套接字的对等标志。除Unix域的套接字之外，每当一个 stream "
"套接字接收到第一个数据报时，该函数将被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2365
#, no-wrap
msgid "`mpo_set_socket_peer_from_socket`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2377
#, no-wrap
msgid ""
"void mpo_set_socket_peer_from_socket(\toldsocket, \t \n"
" \toldsocketlabel, \t \n"
" \tnewsocket, \t \n"
" \tnewsocketpeerlabel);\t \n"
"struct socket *oldsocket;\n"
"struct label *oldsocketlabel;\n"
"struct socket *newsocket;\n"
"struct label *newsocketpeerlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2401
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`oldsocket`\n"
"|Local socket\n"
"|\n"
"\n"
"|`oldsocketlabel`\n"
"|Policy label for `oldsocket`\n"
"|\n"
"\n"
"|`newsocket`\n"
"|Peer socket\n"
"|\n"
"\n"
"|`newsocketpeerlabel`\n"
"|Policy label to fill in for `newsocket`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2404
msgid ""
"Set the peer label on a stream UNIX domain socket from the passed remote "
"socket endpoint. This call will be made when the socket pair is connected, "
"and will be made for both endpoints."
msgstr "根据传入的远程套接字端点，为一个 stream UNIX 与套接字设置对等标记。每当相应的套接字对之间进行连接时，该函数将在两端分别被调用。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2406
#, no-wrap
msgid "Network Object Labeling Event Operations"
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2409
#, no-wrap
msgid "`mpo_create_bpfdesc`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2419
#, no-wrap
msgid ""
"void mpo_create_bpfdesc(\tcred, \t \n"
" \tbpf_d, \t \n"
" \tbpflabel);\t \n"
"struct ucred *cred;\n"
"struct bpf_d *bpf_d;\n"
"struct label *bpflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2439
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|Immutable\n"
"\n"
"|`bpf_d`\n"
"|Object; bpf descriptor\n"
"|\n"
"\n"
"|`bpf`\n"
"|Policy label to be filled in for `bpf_d`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2442
msgid ""
"Set the label on a newly created BPF descriptor from the passed subject "
"credential. This call will be made when a BPF device node is opened by a "
"process with the passed subject credential."
msgstr "根据传入的主体信任状参数，为新建的 BPF 描述子设置标记。当进程打开 BPF 设备节点时，该函数将被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2444
#, no-wrap
msgid "`mpo_create_ifnet`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2452
#, no-wrap
msgid ""
"void mpo_create_ifnet(\tifnet, \t \n"
" \tifnetlabel);\t \n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2468
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`ifnet`\n"
"|Network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label to fill in for `ifnet`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2471
msgid ""
"Set the label on a newly created interface. This call may be made when a new "
"physical interface becomes available to the system, or when a "
"pseudo-interface is instantiated during the boot or as a result of a user "
"action."
msgstr "为新建的网络接口设置标记。该函数在以下情况下被调用：当一个新的物理接口变为可用时，或者当一个伪接口在引导时或由于某个用户操作而实例化时。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2473
#, no-wrap
msgid "`mpo_create_ipq`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2485
#, no-wrap
msgid ""
"void mpo_create_ipq(\tfragment, \t \n"
" \tfragmentlabel, \t \n"
" \tipq, \t \n"
" \tipqlabel);\t \n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2509
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`fragment`\n"
"|First received IP fragment\n"
"|\n"
"\n"
"|`fragmentlabel`\n"
"|Policy label for `fragment`\n"
"|\n"
"\n"
"|`ipq`\n"
"|IP reassembly queue to be labeled\n"
"|\n"
"\n"
"|`ipqlabel`\n"
"|Policy label to be filled in for `ipq`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2512
msgid ""
"Set the label on a newly created IP fragment reassembly queue from the mbuf "
"header of the first received fragment."
msgstr "根据第一个接收到的分片的 mbuf 头部信息，为新建的 IP 分片重组队列设置标记。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2514
#, no-wrap
msgid "`mpo_create_datagram_from_ipq`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2526
#, no-wrap
msgid ""
"void mpo_create_create_datagram_from_ipq(\tipq, \t \n"
" \tipqlabel, \t \n"
" \tdatagram, \t \n"
" \tdatagramlabel);\t \n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
"struct mbuf *datagram;\n"
"struct label *datagramlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2550
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`ipq`\n"
"|IP reassembly queue\n"
"|\n"
"\n"
"|`ipqlabel`\n"
"|Policy label for `ipq`\n"
"|\n"
"\n"
"|`datagram`\n"
"|Datagram to be labeled\n"
"|\n"
"\n"
"|`datagramlabel`\n"
"|Policy label to be filled in for `datagramlabel`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2553
msgid ""
"Set the label on a newly reassembled IP datagram from the IP fragment "
"reassembly queue from which it was generated."
msgstr "根据 IP 分片重组队列，为刚刚重组完毕的 IP 数据报设置标记。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2555
#, no-wrap
msgid "`mpo_create_fragment`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2567
#, no-wrap
msgid ""
"void mpo_create_fragment(\tdatagram, \t \n"
" \tdatagramlabel, \t \n"
" \tfragment, \t \n"
" \tfragmentlabel);\t \n"
"struct mbuf *datagram;\n"
"struct label *datagramlabel;\n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2591
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`datagram`\n"
"|Datagram\n"
"|\n"
"\n"
"|`datagramlabel`\n"
"|Policy label for `datagram`\n"
"|\n"
"\n"
"|`fragment`\n"
"|Fragment to be labeled\n"
"|\n"
"\n"
"|`fragmentlabel`\n"
"|Policy label to be filled in for `datagram`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2594
msgid ""
"Set the label on the mbuf header of a newly created IP fragment from the "
"label on the mbuf header of the datagram it was generate from."
msgstr "根据数据报所对应的 mbuf 头部信息，为其新建的分片的 mbuf 头部设置标记。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2596
#, no-wrap
msgid "`mpo_create_mbuf_from_mbuf`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2608
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_mbuf(\toldmbuf, \t \n"
" \toldmbuflabel, \t \n"
" \tnewmbuf, \t \n"
" \tnewmbuflabel);\t \n"
"struct mbuf *oldmbuf;\n"
"struct label *oldmbuflabel;\n"
"struct mbuf *newmbuf;\n"
"struct label *newmbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2632
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`oldmbuf`\n"
"|Existing (source) mbuf\n"
"|\n"
"\n"
"|`oldmbuflabel`\n"
"|Policy label for `oldmbuf`\n"
"|\n"
"\n"
"|`newmbuf`\n"
"|New mbuf to be labeled\n"
"|\n"
"\n"
"|`newmbuflabel`\n"
"|Policy label to be filled in for `newmbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2635
msgid ""
"Set the label on the mbuf header of a newly created datagram from the mbuf "
"header of an existing datagram. This call may be made in a number of "
"situations, including when an mbuf is re-allocated for alignment purposes."
msgstr ""
"根据某个现有数据报的 mbuf 头部信息，为新建数据报的 mbuf 头部设置标记。在许多条件下将会调用该函数，比如，由于对齐要求而重新分配某个 mbuf "
"时。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2637
#, no-wrap
msgid "`mpo_create_mbuf_linklayer`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2649
#, no-wrap
msgid ""
"void mpo_create_mbuf_linklayer(\tifnet, \t \n"
" \tifnetlabel, \t \n"
" \tmbuf, \t \n"
" \tmbuflabel);\t \n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2673
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`ifnet`\n"
"|Network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label for `ifnet`\n"
"|\n"
"\n"
"|`mbuf`\n"
"|mbuf header for new datagram\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Policy label to be filled in for `mbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2676
msgid ""
"Set the label on the mbuf header of a newly created datagram generated for "
"the purposes of a link layer response for the passed interface. This call "
"may be made in a number of situations, including for ARP or ND6 responses in "
"the IPv4 and IPv6 stacks."
msgstr ""
"为在给定接口上由于某个链路层响应而新建的数据报的mbuf头部设置标记。该函数将在若干条件下被调用，比如当IPv4和IPv6协议栈在响应ARP或者ND6时。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2678
#, no-wrap
msgid "`mpo_create_mbuf_from_bpfdesc`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2690
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_bpfdesc(\tbpf_d, \t \n"
" \tbpflabel, \t \n"
" \tmbuf, \t \n"
" \tmbuflabel);\t \n"
"struct bpf_d *bpf_d;\n"
"struct label *bpflabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2714
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`bpf_d`\n"
"|BPF descriptor\n"
"|\n"
"\n"
"|`bpflabel`\n"
"|Policy label for `bpflabel`\n"
"|\n"
"\n"
"|`mbuf`\n"
"|New mbuf to be labeled\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Policy label to fill in for `mbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2717
msgid ""
"Set the label on the mbuf header of a newly created datagram generated using "
"the passed BPF descriptor. This call is made when a write is performed to "
"the BPF device associated with the passed BPF descriptor."
msgstr ""
"为使用参数 BPF 描述子创建的新数据报的 mbuf 头部设置标记。当对参数 BPF 描述子所关联的 BPF 设备进行写操作时，该函数将被调用。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2719
#, no-wrap
msgid "`mpo_create_mbuf_from_ifnet`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2731
#, no-wrap
msgid ""
"void mpo_create_mbuf_from_ifnet(\tifnet, \t \n"
" \tifnetlabel, \t \n"
" \tmbuf, \t \n"
" \tmbuflabel);\t \n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2755
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`ifnet`\n"
"|Network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label for `ifnetlabel`\n"
"|\n"
"\n"
"|`mbuf`\n"
"|mbuf header for new datagram\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Policy label to be filled in for `mbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2758
msgid ""
"Set the label on the mbuf header of a newly created datagram generated from "
"the passed network interface."
msgstr "为从网络接口参数创建的数据报的 mbuf 头部设置标记。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2760
#, no-wrap
msgid "`mpo_create_mbuf_multicast_encap`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2776
#, no-wrap
msgid ""
"void mpo_create_mbuf_multicast_encap(\toldmbuf, \t \n"
" \toldmbuflabel, \t \n"
" \tifnet, \t \n"
" \tifnetlabel, \t \n"
" \tnewmbuf, \t \n"
" \tnewmbuflabel);\t \n"
"struct mbuf *oldmbuf;\n"
"struct label *oldmbuflabel;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *newmbuf;\n"
"struct label *newmbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2808
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`oldmbuf`\n"
"|mbuf header for existing datagram\n"
"|\n"
"\n"
"|`oldmbuflabel`\n"
"|Policy label for `oldmbuf`\n"
"|\n"
"\n"
"|`ifnet`\n"
"|Network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label for `ifnet`\n"
"|\n"
"\n"
"|`newmbuf`\n"
"|mbuf header to be labeled for new datagram\n"
"|\n"
"\n"
"|`newmbuflabel`\n"
"|Policy label to be filled in for `newmbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2811
msgid ""
"Set the label on the mbuf header of a newly created datagram generated from "
"the existing passed datagram when it is processed by the passed multicast "
"encapsulation interface. This call is made when an mbuf is to be delivered "
"using the virtual interface."
msgstr ""
"当传入的已有数据报被给定多播封装接口（multicast encapsulation interface）处理时被调用，为新创建的数据报所在 mbuf "
"头部设置标记。每当使用该虚拟接口传递一个mbuf时，将调用该函数。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2813
#, no-wrap
msgid "`mpo_create_mbuf_netlayer`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2825
#, no-wrap
msgid ""
"void mpo_create_mbuf_netlayer(\toldmbuf, \t \n"
" \toldmbuflabel, \t \n"
" \tnewmbuf, \t \n"
" \tnewmbuflabel);\t \n"
"struct mbuf *oldmbuf;\n"
"struct label *oldmbuflabel;\n"
"struct mbuf *newmbuf;\n"
"struct label *newmbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2849
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`oldmbuf`\n"
"|Received datagram\n"
"|\n"
"\n"
"|`oldmbuflabel`\n"
"|Policy label for `oldmbuf`\n"
"|\n"
"\n"
"|`newmbuf`\n"
"|Newly created datagram\n"
"|\n"
"\n"
"|`newmbuflabel`\n"
"|Policy label for `newmbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2852
#, fuzzy
msgid ""
"Set the label on the mbuf header of a newly created datagram generated by "
"the IP stack in response to an existing received datagram (`oldmbuf`). This "
"call may be made in a number of situations, including when responding to "
"ICMP request datagrams."
msgstr ""
"为由 IP 堆栈因为响应接收数据报（<parameter>oldmbuf</parameter>）而新建的数据报设置其 mbuf "
"头部的标记。许多情况下需要调用该函数，比如，响应 ICMP 请求数据报时。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2854
#, no-wrap
msgid "`mpo_fragment_match`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2866
#, no-wrap
msgid ""
"int mpo_fragment_match(\tfragment, \t \n"
" \tfragmentlabel, \t \n"
" \tipq, \t \n"
" \tipqlabel);\t \n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2890
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`fragment`\n"
"|IP datagram fragment\n"
"|\n"
"\n"
"|`fragmentlabel`\n"
"|Policy label for `fragment`\n"
"|\n"
"\n"
"|`ipq`\n"
"|IP fragment reassembly queue\n"
"|\n"
"\n"
"|`ipqlabel`\n"
"|Policy label for `ipq`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2893
#, fuzzy
msgid ""
"Determine whether an mbuf header containing an IP datagram (`fragment`) "
"fragment matches the label of the passed IP fragment reassembly queue "
"(`ipq`). Return (1) for a successful match, or (0) for no match. This call "
"is made when the IP stack attempts to find an existing fragment reassembly "
"queue for a newly received fragment; if this fails, a new fragment "
"reassembly queue may be instantiated for the fragment. Policies may use this "
"entry point to prevent the reassembly of otherwise matching IP fragments if "
"policy does not permit them to be reassembled based on the label or other "
"information."
msgstr ""
"根据所传入的 IP 分片重组队列（<parameter>ipq</parameter>）的标记，检查包含一个 IP "
"数据报（<parameter>fragment</parameter>）的 mbuf 的头部是否符合其要求。符合，则返回<returnvalue>1</r"
"eturnvalue>。否则，返回<returnvalue>0</returnvalue>。每当 IP 堆栈尝试将一个刚刚接收到的分片放入某个已有的分片重"
"组队列中时，将调用该函数进行安全检查；如果失败，将为分片重新实例化一个新的分片重组队列。策略可以利用该入口函数，根据标记或者其他信息阻止不期望的 IP "
"分片重组。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2895
#, no-wrap
msgid "`mpo_relabel_ifnet`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2907
#, no-wrap
msgid ""
"void mpo_relabel_ifnet(\tcred, \t \n"
" \tifnet, \t \n"
" \tifnetlabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2931
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`ifnet`\n"
"|Object; Network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label for `ifnet`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Label update to apply to `ifnet`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2934
msgid ""
"Update the label of network interface, `ifnet`, based on the passed update "
"label, `newlabel`, and the passed subject credential, `cred`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2936
#, no-wrap
msgid "`mpo_update_ipq`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2948
#, no-wrap
msgid ""
"void mpo_update_ipq(\tfragment, \t \n"
" \tfragmentlabel, \t \n"
" \tipq, \t \n"
" \tipqlabel);\t \n"
"struct mbuf *fragment;\n"
"struct label *fragmentlabel;\n"
"struct ipq *ipq;\n"
"struct label *ipqlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2972
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`mbuf`\n"
"|IP fragment\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Policy label for `mbuf`\n"
"|\n"
"\n"
"|`ipq`\n"
"|IP fragment reassembly queue\n"
"|\n"
"\n"
"|`ipqlabel`\n"
"|Policy label to be updated for `ipq`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2975
msgid ""
"Update the label on an IP fragment reassembly queue (`ipq`) based on the "
"acceptance of the passed IP fragment mbuf header (`mbuf`)."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2977
#, no-wrap
msgid "Process Labeling Event Operations"
msgstr "进程标记事件操作"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2980
#, no-wrap
msgid "`mpo_create_cred`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:2988
#, no-wrap
msgid ""
"void mpo_create_cred(\tparent_cred, \t \n"
" \tchild_cred);\t \n"
"struct ucred *parent_cred;\n"
"struct ucred *child_cred;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3004
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`parent_cred`\n"
"|Parent subject credential\n"
"|\n"
"\n"
"|`child_cred`\n"
"|Child subject credential\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3007
msgid ""
"Set the label of a newly created subject credential from the passed subject "
"credential. This call will be made when man:crcopy[9] is invoked on a newly "
"created struct ucred. This call should not be confused with a process "
"forking or creation event."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3009
#, no-wrap
msgid "`mpo_execve_transition`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3021
#, no-wrap
msgid ""
"void mpo_execve_transition(\told, \t \n"
" \tnew, \t \n"
" \tvp, \t \n"
" \tvnodelabel);\t \n"
"struct ucred *old;\n"
"struct ucred *new;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3046
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`old`\n"
"|Existing subject credential\n"
"|Immutable\n"
"\n"
"|`new`\n"
"|New subject credential to be labeled\n"
"|\n"
"\n"
"|`vp`\n"
"|File to execute\n"
"|Locked\n"
"\n"
"|`vnodelabel`\n"
"|Policy label for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3049
msgid ""
"Update the label of a newly created subject credential (`new`) from the "
"passed existing subject credential (`old`) based on a label transition "
"caused by executing the passed vnode (`vp`). This call occurs when a process "
"executes the passed vnode and one of the policies returns a success from the "
"`mpo_execve_will_transition` entry point. Policies may choose to implement "
"this call simply by invoking `mpo_create_cred` and passing the two subject "
"credentials so as not to implement a transitioning event. Policies should "
"not leave this entry point unimplemented if they implement "
"`mpo_create_cred`, even if they do not implement "
"`mpo_execve_will_transition`."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3051
#, no-wrap
msgid "`mpo_execve_will_transition`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3061
#, no-wrap
msgid ""
"int mpo_execve_will_transition(\told, \t \n"
" \tvp, \t \n"
" \tvnodelabel);\t \n"
"struct ucred *old;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3081
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`old`\n"
"|Subject credential prior to man:execve[2]\n"
"|Immutable\n"
"\n"
"|`vp`\n"
"|File to execute\n"
"|\n"
"\n"
"|`vnodelabel`\n"
"|Policy label for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3084
msgid ""
"Determine whether the policy will want to perform a transition event as a "
"result of the execution of the passed vnode by the passed subject "
"credential. Return 1 if a transition is required, 0 if not. Even if a policy "
"returns 0, it should behave correctly in the presence of an unexpected "
"invocation of `mpo_execve_transition`, as that call may happen as a result "
"of another policy requesting a transition."
msgstr ""

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3086
#, no-wrap
msgid "`mpo_create_proc0`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3092
#, no-wrap
msgid ""
"void mpo_create_proc0(\tcred);\t \n"
"struct ucred *cred;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3104
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3127
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential to be filled in\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3107
msgid ""
"Create the subject credential of process 0, the parent of all kernel "
"processes."
msgstr "为进程0，所有内核进程的祖先，创建主体信任状。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3109
#, no-wrap
msgid "`mpo_create_proc1`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3115
#, no-wrap
msgid ""
"void mpo_create_proc1(\tcred);\t \n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3130
msgid ""
"Create the subject credential of process 1, the parent of all user "
"processes."
msgstr "为进程1，所有用户进程的祖先，创建主体信任状。"

#. type: Title =====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3132
#, no-wrap
msgid "`mpo_relabel_cred`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3140
#, no-wrap
msgid ""
"void mpo_relabel_cred(\tcred, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3156
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Label update to apply to `cred`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3159
msgid "Update the label on a subject credential from the passed update label."
msgstr "根据传入的新标记，对主体信任状上的标记进行更新。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3161
#, no-wrap
msgid "Access Control Checks"
msgstr "访问控制检查"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3164
msgid ""
"Access control entry points permit policy modules to influence access "
"control decisions made by the kernel. Generally, although not always, "
"arguments to an access control entry point will include one or more "
"authorizing credentials, information (possibly including a label) for any "
"other objects involved in the operation. An access control entry point may "
"return 0 to permit the operation, or an man:errno[2] error value. The "
"results of invoking the entry point across various registered policy modules "
"will be composed as follows: if all modules permit the operation to succeed, "
"success will be returned. If one or modules returns a failure, a failure "
"will be returned. If more than one module returns a failure, the errno value "
"to return to the user will be selected using the following precedence, "
"implemented by the `error_select()` function in [.filename]#kern_mac.c#:"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3183
#, no-wrap
msgid ""
"|Most precedence\n"
"|EDEADLK\n"
"\n"
"|\n"
"|EINVAL\n"
"\n"
"|\n"
"|ESRCH\n"
"\n"
"|\n"
"|EACCES\n"
"\n"
"|Least precedence\n"
"|EPERM\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3186
msgid ""
"If none of the error values returned by all modules are listed in the "
"precedence chart then an arbitrarily selected value from the set will be "
"returned. In general, the rules provide precedence to errors in the "
"following order: kernel failures, invalid arguments, object not present, "
"access not permitted, other."
msgstr ""
"如果所有策略模块返回的错误编码均没有出现在上述优先级序列表中，则任意选择一个返回。选择错误编码的一般次序为：内核错误，无效的参数，对象不存在，访问被拒绝，"
"和其他错误。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3188
#, no-wrap
msgid "`mpo_check_bpfdesc_receive`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3200
#, no-wrap
msgid ""
"int mpo_check_bpfdesc_receive(\tbpf_d, \t \n"
" \tbpflabel, \t \n"
" \tifnet, \t \n"
" \tifnetlabel);\t \n"
"struct bpf_d *bpf_d;\n"
"struct label *bpflabel;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3224
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`bpf_d`\n"
"|Subject; BPF descriptor\n"
"|\n"
"\n"
"|`bpflabel`\n"
"|Policy label for `bpf_d`\n"
"|\n"
"\n"
"|`ifnet`\n"
"|Object; network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label for `ifnet`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3227
msgid ""
"Determine whether the MAC framework should permit datagrams from the passed "
"interface to be delivered to the buffers of the passed BPF "
"descriptor. Return (0) for success, or an `errno` value for failure "
"Suggested failure: EACCES for label mismatches, EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3229
#, no-wrap
msgid "`mpo_check_kenv_dump`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3235
#, no-wrap
msgid ""
"int mpo_check_kenv_dump(\tcred);\t \n"
"struct ucred *cred;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3247
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3392
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3415
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5565
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5617
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3250
msgid ""
"Determine whether the subject should be allowed to retrieve the kernel "
"environment (see man:kenv[2])."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3252
#, no-wrap
msgid "`mpo_check_kenv_get`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3260
#, no-wrap
msgid ""
"int mpo_check_kenv_get(\tcred, \t \n"
" \tname);\t \n"
"struct ucred *cred;\n"
"char *name;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3276
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3305
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3334
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`name`\n"
"|Kernel environment variable name\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3279
msgid ""
"Determine whether the subject should be allowed to retrieve the value of the "
"specified kernel environment variable."
msgstr "决定相关主体是否可以查询内核中给定环境变量的状态。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3281
#, no-wrap
msgid "`mpo_check_kenv_set`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3289
#, no-wrap
msgid ""
"int mpo_check_kenv_set(\tcred, \t \n"
" \tname);\t \n"
"struct ucred *cred;\n"
"char *name;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3308
msgid ""
"Determine whether the subject should be allowed to set the specified kernel "
"environment variable."
msgstr "决定相关主体是否有权设置给定内核环境变量的值。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3310
#, no-wrap
msgid "`mpo_check_kenv_unset`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3318
#, no-wrap
msgid ""
"int mpo_check_kenv_unset(\tcred, \t \n"
" \tname);\t \n"
"struct ucred *cred;\n"
"char *name;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3337
msgid ""
"Determine whether the subject should be allowed to unset the specified "
"kernel environment variable."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3339
#, no-wrap
msgid "`mpo_check_kld_load`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3349
#, no-wrap
msgid ""
"int mpo_check_kld_load(\tcred, \t \n"
" \tvp, \t \n"
" \tvlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3369
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Kernel module vnode\n"
"|\n"
"\n"
"|`vlabel`\n"
"|Label associated with `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3372
msgid ""
"Determine whether the subject should be allowed to load the specified module "
"file."
msgstr "决定相关主体是否有权加载给定的模块文件。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3374
#, no-wrap
msgid "`mpo_check_kld_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3380
#, no-wrap
msgid ""
"int mpo_check_kld_stat(\tcred);\t \n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3395
msgid ""
"Determine whether the subject should be allowed to retrieve a list of loaded "
"kernel module files and associated statistics."
msgstr "决定相关主体是否有权访问内核的加载模块文件链表以及相关的统计数据。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3397
#, no-wrap
msgid "`mpo_check_kld_unload`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3403
#, no-wrap
msgid ""
"int mpo_check_kld_unload(\tcred);\t \n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3418
msgid "Determine whether the subject should be allowed to unload a kernel module."
msgstr "决定相关主体是否有权卸载一个内核模块。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3420
#, no-wrap
msgid "`mpo_check_pipe_ioctl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3434
#, no-wrap
msgid ""
"int mpo_check_pipe_ioctl(\tcred, \t \n"
" \tpipe, \t \n"
" \tpipelabel, \t \n"
" \tcmd, \t \n"
" \tdata);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
"unsigned long cmd;\n"
"void *data;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3462
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`pipe`\n"
"|Pipe\n"
"|\n"
"\n"
"|`pipelabel`\n"
"|Policy label associated with `pipe`\n"
"|\n"
"\n"
"|`cmd`\n"
"|man:ioctl[2] command\n"
"|\n"
"\n"
"|`data`\n"
"|man:ioctl[2] data\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3465
msgid ""
"Determine whether the subject should be allowed to make the specified "
"man:ioctl[2] call."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3467
#, no-wrap
msgid "`mpo_check_pipe_poll`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3477
#, no-wrap
msgid ""
"int mpo_check_pipe_poll(\tcred, \t \n"
" \tpipe, \t \n"
" \tpipelabel);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3500
msgid "Determine whether the subject should be allowed to poll `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3502
#, no-wrap
msgid "`mpo_check_pipe_read`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3512
#, no-wrap
msgid ""
"int mpo_check_pipe_read(\tcred, \t \n"
" \tpipe, \t \n"
" \tpipelabel);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3535
msgid "Determine whether the subject should be allowed read access to `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3537
#, no-wrap
msgid "`mpo_check_pipe_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3549
#, no-wrap
msgid ""
"int mpo_check_pipe_relabel(\tcred, \t \n"
" \tpipe, \t \n"
" \tpipelabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3573
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`pipe`\n"
"|Pipe\n"
"|\n"
"\n"
"|`pipelabel`\n"
"|Current policy label associated with `pipe`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Label update to `pipelabel`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3576
msgid "Determine whether the subject should be allowed to relabel `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3578
#, no-wrap
msgid "`mpo_check_pipe_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3588
#, no-wrap
msgid ""
"int mpo_check_pipe_stat(\tcred, \t \n"
" \tpipe, \t \n"
" \tpipelabel);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3611
msgid ""
"Determine whether the subject should be allowed to retrieve statistics "
"related to `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3613
#, no-wrap
msgid "`mpo_check_pipe_write`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3623
#, no-wrap
msgid ""
"int mpo_check_pipe_write(\tcred, \t \n"
" \tpipe, \t \n"
" \tpipelabel);\t \n"
"struct ucred *cred;\n"
"struct pipe *pipe;\n"
"struct label *pipelabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3646
msgid "Determine whether the subject should be allowed to write to `pipe`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3648
#, no-wrap
msgid "`mpo_check_socket_bind`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3660
#, no-wrap
msgid ""
"int mpo_check_socket_bind(\tcred, \t \n"
" \tsocket, \t \n"
" \tsocketlabel, \t \n"
" \tsockaddr);\t \n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
"struct sockaddr *sockaddr;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3684
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`socket`\n"
"|Socket to be bound\n"
"|\n"
"\n"
"|`socketlabel`\n"
"|Policy label for `socket`\n"
"|\n"
"\n"
"|`sockaddr`\n"
"|Address of `socket`\n"
"|\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3687
#, no-wrap
msgid "`mpo_check_socket_connect`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3699
#, no-wrap
msgid ""
"int mpo_check_socket_connect(\tcred, \t \n"
" \tsocket, \t \n"
" \tsocketlabel, \t \n"
" \tsockaddr);\t \n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
"struct sockaddr *sockaddr;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3723
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`socket`\n"
"|Socket to be connected\n"
"|\n"
"\n"
"|`socketlabel`\n"
"|Policy label for `socket`\n"
"|\n"
"\n"
"|`sockaddr`\n"
"|Address of `socket`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3726
msgid ""
"Determine whether the subject credential (`cred`) can connect the passed "
"socket (`socket`) to the passed socket address (`sockaddr`). Return 0 for "
"success, or an `errno` value for failure. Suggested failure: EACCES for "
"label mismatches, EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3728
#, no-wrap
msgid "`mpo_check_socket_receive`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3738
#, no-wrap
msgid ""
"int mpo_check_socket_receive(\tcred, \t \n"
" \tso, \t \n"
" \tsocketlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3758
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3793
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`so`\n"
"|Socket\n"
"|\n"
"\n"
"|`socketlabel`\n"
"|Policy label associated with `so`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3761
msgid ""
"Determine whether the subject should be allowed to receive information from "
"the socket `so`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3763
#, no-wrap
msgid "`mpo_check_socket_send`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3773
#, no-wrap
msgid ""
"int mpo_check_socket_send(\tcred, \t \n"
" \tso, \t \n"
" \tsocketlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3796
msgid ""
"Determine whether the subject should be allowed to send information across "
"the socket `so`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3798
#, no-wrap
msgid "`mpo_check_cred_visible`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3806
#, no-wrap
msgid ""
"int mpo_check_cred_visible(\tu1, \t \n"
" \tu2);\t \n"
"struct ucred *u1;\n"
"struct ucred *u2;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3822
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`u1`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`u2`\n"
"|Object credential\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3825
msgid ""
"Determine whether the subject credential `u1` can \"see\" other subjects "
"with the passed subject credential `u2`. Return 0 for success, or an `errno` "
"value for failure. Suggested failure: EACCES for label mismatches, EPERM for "
"lack of privilege, or ESRCH to hide visibility. This call may be made in a "
"number of situations, including inter-process status sysctl's used by `ps`, "
"and in procfs lookups."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3827
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5477
#, no-wrap
msgid "`mpo_check_socket_visible`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3837
#, no-wrap
msgid ""
"int mpo_check_socket_visible(\tcred, \t \n"
" \tsocket, \t \n"
" \tsocketlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3857
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4812
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`socket`\n"
"|Object; socket\n"
"|\n"
"\n"
"|`socketlabel`\n"
"|Policy label for `socket`\n"
"|\n"
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3860
#, no-wrap
msgid "`mpo_check_ifnet_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3872
#, no-wrap
msgid ""
"int mpo_check_ifnet_relabel(\tcred, \t \n"
" \tifnet, \t \n"
" \tifnetlabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3896
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`ifnet`\n"
"|Object; network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Existing policy label for `ifnet`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Policy label update to later be applied to `ifnet`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3899
msgid ""
"Determine whether the subject credential can relabel the passed network "
"interface to the passed label update."
msgstr "决定该主体信任状是否有权使用传入的标记更新参数对给定的网络接口的标记进行重新设置。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3901
#, no-wrap
msgid "`mpo_check_socket_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3913
#, no-wrap
msgid ""
"int mpo_check_socket_relabel(\tcred, \t \n"
" \tsocket, \t \n"
" \tsocketlabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3937
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`socket`\n"
"|Object; socket\n"
"|\n"
"\n"
"|`socketlabel`\n"
"|Existing policy label for `socket`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Label update to later be applied to `socketlabel`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3940
msgid ""
"Determine whether the subject credential can relabel the passed socket to "
"the passed label update."
msgstr "决定该主体信任状是否有权采用传入的标记对套接字参数的标记进行重新设置。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3942
#, no-wrap
msgid "`mpo_check_cred_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3950
#, no-wrap
msgid ""
"int mpo_check_cred_relabel(\tcred, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3966
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Label update to later be applied to `cred`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3969
msgid ""
"Determine whether the subject credential can relabel itself to the passed "
"label update."
msgstr "决定该主体信任状是否有权将自己的标记重新设置为给定的更新标记。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3971
#, no-wrap
msgid "`mpo_check_vnode_relabel`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:3983
#, no-wrap
msgid ""
"int mpo_check_vnode_relabel(\tcred, \t \n"
" \tvp, \t \n"
" \tvnodelabel, \t \n"
" \tnewlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vnodelabel;\n"
"struct label *newlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4007
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|Immutable\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|Locked\n"
"\n"
"|`vnodelabel`\n"
"|Existing policy label for `vp`\n"
"|\n"
"\n"
"|`newlabel`\n"
"|Policy label update to later be applied to `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4010
msgid ""
"Determine whether the subject credential can relabel the passed vnode to the "
"passed label update."
msgstr "决定该主体信任状是否有权将参数 vnode 的标记重新设置为指定标记。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4012
#, no-wrap
msgid "`mpo_check_mount_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4022
#, no-wrap
msgid ""
"int mpo_check_mount_stat(\tcred, \t \n"
" \tmp, \t \n"
" \tmountlabel);\t \n"
"struct ucred *cred;\n"
"struct mount *mp;\n"
"struct label *mountlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4042
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`mp`\n"
"|Object; file system mount\n"
"|\n"
"\n"
"|`mountlabel`\n"
"|Policy label for `mp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4045
msgid ""
"Determine whether the subject credential can see the results of a statfs "
"performed on the file system. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatches or EPERM for lack of "
"privilege. This call may be made in a number of situations, including during "
"invocations of man:statfs[2] and related calls, as well as to determine what "
"file systems to exclude from listings of file systems, such as when "
"man:getfsstat[2] is invoked."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4047
#, no-wrap
msgid "`mpo_check_proc_debug`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4055
#, no-wrap
msgid ""
"int mpo_check_proc_debug(\tcred, \t \n"
" \tproc);\t \n"
"struct ucred *cred;\n"
"struct proc *proc;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4071
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|Immutable\n"
"\n"
"|`proc`\n"
"|Object; process\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4074
msgid ""
"Determine whether the subject credential can debug the passed "
"process. Return 0 for success, or an `errno` value for failure. Suggested "
"failure: EACCES for label mismatch, EPERM for lack of privilege, or ESRCH to "
"hide visibility of the target. This call may be made in a number of "
"situations, including use of the man:ptrace[2] and man:ktrace[2] APIs, as "
"well as for some types of procfs operations."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4076
#, no-wrap
msgid "`mpo_check_vnode_access`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4088
#, no-wrap
msgid ""
"int mpo_check_vnode_access(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tflags);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int flags;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4112
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`flags`\n"
"|man:access[2] flags\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4115
msgid ""
"Determine how invocations of man:access[2] and related calls by the subject "
"credential should return when performed on the passed vnode using the passed "
"access flags. This should generally be implemented using the same semantics "
"used in `mpo_check_vnode_open`. Return 0 for success, or an `errno` value "
"for failure. Suggested failure: EACCES for label mismatches or EPERM for "
"lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4117
#, no-wrap
msgid "`mpo_check_vnode_chdir`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4127
#, no-wrap
msgid ""
"int mpo_check_vnode_chdir(\tcred, \t \n"
" \tdvp, \t \n"
" \tdlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4147
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Object; vnode to man:chdir[2] into\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label for `dvp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4150
msgid ""
"Determine whether the subject credential can change the process working "
"directory to the passed vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4152
#, no-wrap
msgid "`mpo_check_vnode_chroot`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4162
#, no-wrap
msgid ""
"int mpo_check_vnode_chroot(\tcred, \t \n"
" \tdvp, \t \n"
" \tdlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4182
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Directory vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label associated with `dvp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4185
msgid ""
"Determine whether the subject should be allowed to man:chroot[2] into the "
"specified directory (`dvp`)."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4187
#, no-wrap
msgid "`mpo_check_vnode_create`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4201
#, no-wrap
msgid ""
"int mpo_check_vnode_create(\tcred, \t \n"
" \tdvp, \t \n"
" \tdlabel, \t \n"
" \tcnp, \t \n"
" \tvap);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct componentname *cnp;\n"
"struct vattr *vap;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4229
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label for `dvp`\n"
"|\n"
"\n"
"|`cnp`\n"
"|Component name for `dvp`\n"
"|\n"
"\n"
"|`vap`\n"
"|vnode attributes for `vap`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4232
msgid ""
"Determine whether the subject credential can create a vnode with the passed "
"parent directory, passed name information, and passed attribute "
"information. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege. This call may be made in a number of situations, including as a "
"result of calls to man:open[2] with O_CREAT, man:mkfifo[2], and others."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4234
#, no-wrap
msgid "`mpo_check_vnode_delete`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4250
#, no-wrap
msgid ""
"int mpo_check_vnode_delete(\tcred, \t \n"
" \tdvp, \t \n"
" \tdlabel, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tcnp);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"void *label;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4282
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Parent directory vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label for `dvp`\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode to delete\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`cnp`\n"
"|Component name for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4285
msgid ""
"Determine whether the subject credential can delete a vnode from the passed "
"parent directory and passed name information. Return 0 for success, or an "
"`errno` value for failure. Suggested failure: EACCES for label mismatch, or "
"EPERM for lack of privilege. This call may be made in a number of "
"situations, including as a result of calls to man:unlink[2] and "
"man:rmdir[2]. Policies implementing this entry point should also implement "
"`mpo_check_rename_to` to authorize deletion of objects as a result of being "
"the target of a rename."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4287
#, no-wrap
msgid "`mpo_check_vnode_deleteacl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4299
#, no-wrap
msgid ""
"int mpo_check_vnode_deleteacl(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \ttype);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"acl_type_t type;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4323
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|Immutable\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|Locked\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`type`\n"
"|ACL type\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4326
msgid ""
"Determine whether the subject credential can delete the ACL of passed type "
"from the passed vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4328
#, no-wrap
msgid "`mpo_check_vnode_exec`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4338
#, no-wrap
msgid ""
"int mpo_check_vnode_exec(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4358
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode to execute\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4361
msgid ""
"Determine whether the subject credential can execute the passed "
"vnode. Determination of execute privilege is made separately from decisions "
"about any transitioning event. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4363
#, no-wrap
msgid "`mpo_check_vnode_getacl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4375
#, no-wrap
msgid ""
"int mpo_check_vnode_getacl(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \ttype);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"acl_type_t type;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4399
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`type`\n"
"|ACL type\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4402
msgid ""
"Determine whether the subject credential can retrieve the ACL of passed type "
"from the passed vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4404
#, no-wrap
msgid "`mpo_check_vnode_getextattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4420
#, no-wrap
msgid ""
"int mpo_check_vnode_getextattr(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tattrnamespace, \t \n"
" \tname, \t \n"
" \tuio);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int attrnamespace;\n"
"const char *name;\n"
"struct uio *uio;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4452
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5099
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`attrnamespace`\n"
"|Extended attribute namespace\n"
"|\n"
"\n"
"|`name`\n"
"|Extended attribute name\n"
"|\n"
"\n"
"|`uio`\n"
"|I/O structure pointer; see man:uio[9]\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4455
#, fuzzy
msgid ""
"Determine whether the subject credential can retrieve the extended attribute "
"with the passed namespace and name from the passed vnode. Policies "
"implementing labeling using extended attributes may be interested in special "
"handling of operations on those extended attributes. Return 0 for success, "
"or an `errno` value for failure. Suggested failure: EACCES for label "
"mismatch, or EPERM for lack of privilege."
msgstr ""
"确定相关主体信任状是否有权查询给定 vnode "
"上给定名字空间和名字的扩展属性。使用扩展属性实现标记存储的策略模块可能会需要对这些扩展属性的操作进行特殊处理。成功，则返回 <returnvalue>0<"
"/returnvalue>；否则，返回一个<varname>errno</varname>值。建议使用的错误编码：<errorcode>EACCES</e"
"rrorcode>，用于标记不匹配；<errorcode>EPERM</errorcode>，用于权限不够。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4457
#, no-wrap
msgid "`mpo_check_vnode_link`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4473
#, no-wrap
msgid ""
"int mpo_check_vnode_link(\tcred, \t \n"
" \tdvp, \t \n"
" \tdlabel, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tcnp);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4505
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Directory vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label associated with `dvp`\n"
"|\n"
"\n"
"|`vp`\n"
"|Link destination vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label associated with `vp`\n"
"|\n"
"\n"
"|`cnp`\n"
"|Component name for the link being created\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4508
msgid ""
"Determine whether the subject should be allowed to create a link to the "
"vnode `vp` with the name specified by `cnp`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4510
#, no-wrap
msgid "`mpo_check_vnode_mmap`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4522
#, no-wrap
msgid ""
"int mpo_check_vnode_mmap(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tprot);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int prot;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4546
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Vnode to map\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label associated with `vp`\n"
"|\n"
"\n"
"|`prot`\n"
"|Mmap protections (see man:mmap[2])\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4549
msgid ""
"Determine whether the subject should be allowed to map the vnode `vp` with "
"the protections specified in `prot`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4551
#, no-wrap
msgid "`mpo_check_vnode_mmap_downgrade`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4563
#, no-wrap
msgid ""
"void mpo_check_vnode_mmap_downgrade(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tprot);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int *prot;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4587
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|See <<mac-mpo-check-vnode-mmap>>.\n"
"|\n"
"\n"
"|`vp`\n"
"|\n"
"|\n"
"\n"
"|`label`\n"
"|\n"
"|\n"
"\n"
"|`prot`\n"
"|Mmap protections to be downgraded\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4590
msgid "Downgrade the mmap protections based on the subject and object labels."
msgstr "根据主体和客体标记，降低 mmap protections。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4592
#, no-wrap
msgid "`mpo_check_vnode_mprotect`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4604
#, no-wrap
msgid ""
"int mpo_check_vnode_mprotect(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tprot);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int prot;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4624
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Mapped vnode\n"
"|\n"
"\n"
"|`prot`\n"
"|Memory protections\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4627
msgid ""
"Determine whether the subject should be allowed to set the specified memory "
"protections on memory mapped from the vnode `vp`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4629
#, no-wrap
msgid "`mpo_check_vnode_poll`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4641
#, no-wrap
msgid ""
"int mpo_check_vnode_poll(\tactive_cred, \t \n"
" \tfile_cred, \t \n"
" \tvp, \t \n"
" \tlabel);\t \n"
"struct ucred *active_cred;\n"
"struct ucred *file_cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4665
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`active_cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`file_cred`\n"
"|Credential associated with the struct file\n"
"|\n"
"\n"
"|`vp`\n"
"|Polled vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label associated with `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4668
msgid "Determine whether the subject should be allowed to poll the vnode `vp`."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4670
#, no-wrap
msgid "`mpo_check_vnode_rename_from`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4686
#, no-wrap
msgid ""
"int mpo_vnode_rename_from(\tcred, \t \n"
" \tdvp, \t \n"
" \tdlabel, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tcnp);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4718
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Directory vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label associated with `dvp`\n"
"|\n"
"\n"
"|`vp`\n"
"|Vnode to be renamed\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label associated with `vp`\n"
"|\n"
"\n"
"|`cnp`\n"
"|Component name for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4721
msgid ""
"Determine whether the subject should be allowed to rename the vnode `vp` to "
"something else."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4723
#, no-wrap
msgid "`mpo_check_vnode_rename_to`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4741
#, no-wrap
msgid ""
"int mpo_check_vnode_rename_to(\tcred, \t \n"
" \tdvp, \t \n"
" \tdlabel, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tsamedir, \t \n"
" \tcnp);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int samedir;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4777
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Directory vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label associated with `dvp`\n"
"|\n"
"\n"
"|`vp`\n"
"|Overwritten vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label associated with `vp`\n"
"|\n"
"\n"
"|`samedir`\n"
"|Boolean; `1` if the source and destination directories are the same\n"
"|\n"
"\n"
"|`cnp`\n"
"|Destination component name\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4780
msgid ""
"Determine whether the subject should be allowed to rename to the vnode `vp`, "
"into the directory `dvp`, or to the name represented by `cnp`. If there is "
"no existing file to overwrite, `vp` and `label` will be NULL."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4782
#, no-wrap
msgid "`mpo_check_socket_listen`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4792
#, no-wrap
msgid ""
"int mpo_check_socket_listen(\tcred, \t \n"
" \tsocket, \t \n"
" \tsocketlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *socket;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4815
msgid ""
"Determine whether the subject credential can listen on the passed "
"socket. Return 0 for success, or an `errno` value for failure. Suggested "
"failure: EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4817
#, no-wrap
msgid "`mpo_check_vnode_lookup`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4829
#, no-wrap
msgid ""
"int mpo_check_vnode_lookup(\t, \t \n"
" \t, \t \n"
" \t, \t \n"
" \tcnp);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
"struct componentname *cnp;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4853
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label for `dvp`\n"
"|\n"
"\n"
"|`cnp`\n"
"|Component name being looked up\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4856
msgid ""
"Determine whether the subject credential can perform a lookup in the passed "
"directory vnode for the passed name. Return 0 for success, or an `errno` "
"value for failure. Suggested failure: EACCES for label mismatch, or EPERM "
"for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4858
#, no-wrap
msgid "`mpo_check_vnode_open`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4870
#, no-wrap
msgid ""
"int mpo_check_vnode_open(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tacc_mode);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int acc_mode;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4894
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`acc_mode`\n"
"|man:open[2] access mode\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4897
msgid ""
"Determine whether the subject credential can perform an open operation on "
"the passed vnode with the passed access mode. Return 0 for success, or an "
"errno value for failure. Suggested failure: EACCES for label mismatch, or "
"EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4899
#, no-wrap
msgid "`mpo_check_vnode_readdir`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4909
#, no-wrap
msgid ""
"int mpo_check_vnode_readdir(\t, \t \n"
" \t, \t \n"
" \t);\t \n"
"struct ucred *cred;\n"
"struct vnode *dvp;\n"
"struct label *dlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4929
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`dvp`\n"
"|Object; directory vnode\n"
"|\n"
"\n"
"|`dlabel`\n"
"|Policy label for `dvp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4932
msgid ""
"Determine whether the subject credential can perform a `readdir` operation "
"on the passed directory vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4934
#, no-wrap
msgid "`mpo_check_vnode_readlink`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4944
#, no-wrap
msgid ""
"int mpo_check_vnode_readlink(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4964
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4999
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5376
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4967
msgid ""
"Determine whether the subject credential can perform a `readlink` operation "
"on the passed symlink vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege. This call may be made in a number of situations, including an "
"explicit `readlink` call by the user process, or as a result of an implicit "
"`readlink` during a name lookup by the process."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4969
#, no-wrap
msgid "`mpo_check_vnode_revoke`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:4979
#, no-wrap
msgid ""
"int mpo_check_vnode_revoke(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5002
msgid ""
"Determine whether the subject credential can revoke access to the passed "
"vnode. Return 0 for success, or an `errno` value for failure. Suggested "
"failure: EACCES for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5004
#, no-wrap
msgid "`mpo_check_vnode_setacl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5018
#, no-wrap
msgid ""
"int mpo_check_vnode_setacl(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \ttype, \t \n"
" \tacl);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"acl_type_t type;\n"
"struct acl *acl;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5046
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`type`\n"
"|ACL type\n"
"|\n"
"\n"
"|`acl`\n"
"|ACL\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5049
msgid ""
"Determine whether the subject credential can set the passed ACL of passed "
"type on the passed vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5051
#, no-wrap
msgid "`mpo_check_vnode_setextattr`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5067
#, no-wrap
msgid ""
"int mpo_check_vnode_setextattr(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tattrnamespace, \t \n"
" \tname, \t \n"
" \tuio);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"int attrnamespace;\n"
"const char *name;\n"
"struct uio *uio;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5102
#, fuzzy
msgid ""
"Determine whether the subject credential can set the extended attribute of "
"passed name and passed namespace on the passed vnode. Policies implementing "
"security labels backed into extended attributes may want to provide "
"additional protections for those attributes. Additionally, policies should "
"avoid making decisions based on the data referenced from `uio`, as there is "
"a potential race condition between this check and the actual operation. The "
"`uio` may also be `NULL` if a delete operation is being performed. Return 0 "
"for success, or an `errno` value for failure. Suggested failure: EACCES for "
"label mismatch, or EPERM for lack of privilege."
msgstr ""
"确定相关主体信任状是否有权设置给定 vnode 上给定名字空间中给定名字的扩展属性的值。使用扩展属性备份安全标记的策略模块可能需要对其使用的属性实施额外的"
"保护。另外，由于在检查和实际操作时间可能存在的竞争，策略模块应该避免根据来自<parameter>uio</parameter>中的数据做出决策。如果正在"
"执行一个删除操作，则参数 <parameter>uio</parameter> 的值也可能为 <literal>NULL</literal>。成功，"
"则返回 <returnvalue>0</returnvalue>；否则，返回一个<varname>errno</varname>值。建议使用的错误编码：<"
"errorcode>EACCES</errorcode>，用于标记不匹配；<errorcode>EPERM</errorcode>，用于权限不够。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5104
#, no-wrap
msgid "`mpo_check_vnode_setflags`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5116
#, no-wrap
msgid ""
"int mpo_check_vnode_setflags(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tflags);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"u_long flags;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5140
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`flags`\n"
"|File flags; see man:chflags[2]\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5143
msgid ""
"Determine whether the subject credential can set the passed flags on the "
"passed vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5145
#, no-wrap
msgid "`mpo_check_vnode_setmode`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5157
#, no-wrap
msgid ""
"int mpo_check_vnode_setmode(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tmode);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"mode_t mode;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5181
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`mode`\n"
"|File mode; see man:chmod[2]\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5184
msgid ""
"Determine whether the subject credential can set the passed mode on the "
"passed vnode. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5186
#, no-wrap
msgid "`mpo_check_vnode_setowner`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5200
#, no-wrap
msgid ""
"int mpo_check_vnode_setowner(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel, \t \n"
" \tuid, \t \n"
" \tgid);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"uid_t uid;\n"
"gid_t gid;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5228
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vnode\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`uid`\n"
"|User ID\n"
"|\n"
"\n"
"|`gid`\n"
"|Group ID\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5231
msgid ""
"Determine whether the subject credential can set the passed uid and passed "
"gid as file uid and file gid on the passed vnode. The IDs may be set to "
"(`-1`) to request no update. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5233
#, no-wrap
msgid "`mpo_check_vnode_setutimes`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5247
#, no-wrap
msgid ""
"int mpo_check_vnode_setutimes(\t, \t \n"
" \t, \t \n"
" \t, \t \n"
" \t, \t \n"
" \t);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
"struct timespec atime;\n"
"struct timespec mtime;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5275
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Object; vp\n"
"|\n"
"\n"
"|`label`\n"
"|Policy label for `vp`\n"
"|\n"
"\n"
"|`atime`\n"
"|Access time; see man:utimes[2]\n"
"|\n"
"\n"
"|`mtime`\n"
"|Modification time; see man:utimes[2]\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5278
msgid ""
"Determine whether the subject credential can set the passed access "
"timestamps on the passed vnode. Return 0 for success, or an `errno` value "
"for failure. Suggested failure: EACCES for label mismatch, or EPERM for lack "
"of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5280
#, no-wrap
msgid "`mpo_check_proc_sched`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5288
#, no-wrap
msgid ""
"int mpo_check_proc_sched(\tucred, \t \n"
" \tproc);\t \n"
"struct ucred *ucred;\n"
"struct proc *proc;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5304
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`proc`\n"
"|Object; process\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5307
msgid ""
"Determine whether the subject credential can change the scheduling "
"parameters of the passed process. Return 0 for success, or an `errno` value "
"for failure. Suggested failure: EACCES for label mismatch, EPERM for lack of "
"privilege, or ESRCH to limit visibility."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5309
msgid "See man:setpriority[2] for more information."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5311
#, no-wrap
msgid "`mpo_check_proc_signal`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5321
#, no-wrap
msgid ""
"int mpo_check_proc_signal(\tcred, \t \n"
" \tproc, \t \n"
" \tsignal);\t \n"
"struct ucred *cred;\n"
"struct proc *proc;\n"
"int signal;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5341
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`proc`\n"
"|Object; process\n"
"|\n"
"\n"
"|`signal`\n"
"|Signal; see man:kill[2]\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5344
msgid ""
"Determine whether the subject credential can deliver the passed signal to "
"the passed process. Return 0 for success, or an `errno` value for "
"failure. Suggested failure: EACCES for label mismatch, EPERM for lack of "
"privilege, or ESRCH to limit visibility."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5346
#, no-wrap
msgid "`mpo_check_vnode_stat`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5356
#, no-wrap
msgid ""
"int mpo_check_vnode_stat(\tcred, \t \n"
" \tvp, \t \n"
" \tlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *label;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5379
msgid ""
"Determine whether the subject credential can `stat` the passed vnode. Return "
"0 for success, or an `errno` value for failure. Suggested failure: EACCES "
"for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5381
msgid "See man:stat[2] for more information."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5383
#, no-wrap
msgid "`mpo_check_ifnet_transmit`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5397
#, no-wrap
msgid ""
"int mpo_check_ifnet_transmit(\tcred, \t \n"
" \tifnet, \t \n"
" \tifnetlabel, \t \n"
" \tmbuf, \t \n"
" \tmbuflabel);\t \n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5425
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`ifnet`\n"
"|Network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label for `ifnet`\n"
"|\n"
"\n"
"|`mbuf`\n"
"|Object; mbuf to be sent\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Policy label for `mbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5428
msgid ""
"Determine whether the network interface can transmit the passed mbuf. Return "
"0 for success, or an `errno` value for failure. Suggested failure: EACCES "
"for label mismatch, or EPERM for lack of privilege."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5430
#, no-wrap
msgid "`mpo_check_socket_deliver`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5444
#, no-wrap
msgid ""
"int mpo_check_socket_deliver(\tcred, \t \n"
" \tifnet, \t \n"
" \tifnetlabel, \t \n"
" \tmbuf, \t \n"
" \tmbuflabel);\t \n"
"struct ucred *cred;\n"
"struct ifnet *ifnet;\n"
"struct label *ifnetlabel;\n"
"struct mbuf *mbuf;\n"
"struct label *mbuflabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5472
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`ifnet`\n"
"|Network interface\n"
"|\n"
"\n"
"|`ifnetlabel`\n"
"|Policy label for `ifnet`\n"
"|\n"
"\n"
"|`mbuf`\n"
"|Object; mbuf to be delivered\n"
"|\n"
"\n"
"|`mbuflabel`\n"
"|Policy label for `mbuf`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5475
msgid ""
"Determine whether the socket may receive the datagram stored in the passed "
"mbuf header. Return 0 for success, or an `errno` value for "
"failure. Suggested failures: EACCES for label mismatch, or EPERM for lack of "
"privilege."
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5487
#, no-wrap
msgid ""
"int mpo_check_socket_visible(\tcred, \t \n"
" \tso, \t \n"
" \tsocketlabel);\t \n"
"struct ucred *cred;\n"
"struct socket *so;\n"
"struct label *socketlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5507
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|Immutable\n"
"\n"
"|`so`\n"
"|Object; socket\n"
"|\n"
"\n"
"|`socketlabel`\n"
"|Policy label for `so`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5510
msgid ""
"Determine whether the subject credential cred can \"see\" the passed socket "
"(`socket`) using system monitoring functions, such as those employed by "
"man:netstat[8] and man:sockstat[1]. Return 0 for success, or an `errno` "
"value for failure. Suggested failure: EACCES for label mismatches, EPERM for "
"lack of privilege, or ESRCH to hide visibility."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5512
#, no-wrap
msgid "`mpo_check_system_acct`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5522
#, no-wrap
msgid ""
"int mpo_check_system_acct(\tucred, \t \n"
" \tvp, \t \n"
" \tvlabel);\t \n"
"struct ucred *ucred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5542
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`ucred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Accounting file; man:acct[5]\n"
"|\n"
"\n"
"|`vlabel`\n"
"|Label associated with `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5545
msgid ""
"Determine whether the subject should be allowed to enable accounting, based "
"on its label and the label of the accounting log file."
msgstr "根据主体标记和审计日志文件的标记，确定该主体是否有权启动审计。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5547
#, no-wrap
msgid "`mpo_check_system_nfsd`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5553
#, no-wrap
msgid ""
"int mpo_check_system_nfsd(\tcred);\t \n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5568
msgid "Determine whether the subject should be allowed to call man:nfssvc[2]."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5570
#, no-wrap
msgid "`mpo_check_system_reboot`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5578
#, no-wrap
msgid ""
"int mpo_check_system_reboot(\tcred, \t \n"
" \thowto);\t \n"
"struct ucred *cred;\n"
"int howto;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5594
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`howto`\n"
"|`howto` parameter from man:reboot[2]\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5597
msgid ""
"Determine whether the subject should be allowed to reboot the system in the "
"specified manner."
msgstr "确定相关主体是否有权以指定方式重启系统。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5599
#, no-wrap
msgid "`mpo_check_system_settime`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5605
#, no-wrap
msgid ""
"int mpo_check_system_settime(\tcred);\t \n"
"struct ucred *cred;\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5620
msgid "Determine whether the user should be allowed to set the system clock."
msgstr "确定相关用户是否有权设置系统时钟。"

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5622
#, no-wrap
msgid "`mpo_check_system_swapon`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5632
#, no-wrap
msgid ""
"int mpo_check_system_swapon(\tcred, \t \n"
" \tvp, \t \n"
" \tvlabel);\t \n"
"struct ucred *cred;\n"
"struct vnode *vp;\n"
"struct label *vlabel;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5652
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`vp`\n"
"|Swap device\n"
"|\n"
"\n"
"|`vlabel`\n"
"|Label associated with `vp`\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5655
msgid ""
"Determine whether the subject should be allowed to add `vp` as a swap "
"device."
msgstr ""

#. type: Title ====
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5657
#, no-wrap
msgid "`mpo_check_system_sysctl`"
msgstr ""

#. type: delimited block - 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5677
#, no-wrap
msgid ""
"int mpo_check_system_sysctl(\tcred, \t \n"
" \tname, \t \n"
" \tnamelen, \t \n"
" \told, \t \n"
" \toldlenp, \t \n"
" \tinkernel, \t \n"
" \tnew, \t \n"
" \tnewlen);\t \n"
"struct ucred *cred;\n"
"int *name;\n"
"u_int *namelen;\n"
"void *old;\n"
"size_t *oldlenp;\n"
"int inkernel;\n"
"void *new;\n"
"size_t newlen;\n"
msgstr ""

#. type: Table
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5717
#, no-wrap
msgid ""
"| Parameter\n"
"| Description\n"
"| Locking\n"
"\n"
"|`cred`\n"
"|Subject credential\n"
"|\n"
"\n"
"|`name`\n"
"|See man:sysctl[3]\n"
"|\n"
"\n"
"|`namelen`\n"
"|\n"
"|\n"
"\n"
"|`old`\n"
"|\n"
"|\n"
"\n"
"|`oldlenp`\n"
"|\n"
"|\n"
"\n"
"|`inkernel`\n"
"|Boolean; `1` if called from kernel\n"
"|\n"
"\n"
"|`new`\n"
"|See man:sysctl[3]\n"
"|\n"
"\n"
"|`newlen`\n"
"|\n"
"|\n"
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5720
msgid ""
"Determine whether the subject should be allowed to make the specified "
"man:sysctl[3] transaction."
msgstr ""

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5722
#, no-wrap
msgid "Label Management Calls"
msgstr "标记管理调用"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5725
msgid ""
"Relabel events occur when a user process has requested that the label on an "
"object be modified. A two-phase update occurs: first, an access control "
"check will be performed to determine if the update is both valid and "
"permitted, and then the update itself is performed via a separate entry "
"point. Relabel entry points typically accept the object, object label "
"reference, and an update label submitted by the process. Memory allocation "
"during relabel is discouraged, as relabel calls are not permitted to fail "
"(failure should be reported earlier in the relabel check)."
msgstr ""
"当用户进程请求对某个对象的标记进行修改时，将引发重新标记事件。对应的更新操作分两步进行：首先，进行访问控制检查，确认此次更新操作是有效且被允许的；然后，调"
"用另一个独立的入口函数对标记进行修改。重新标记入口函数通常接收由请求进程提交的对象、对象标记指针和请求新标记，作为输入参数。对象重新标记操作的失败将由先期"
"的标记检查报告，所以，不允许在接下来的标记修改过程中报告失败，故而不提倡在此过程中新分配内存。"

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5727
#, no-wrap
msgid "Userland Architecture"
msgstr "应用层体系结构"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5730
msgid ""
"The TrustedBSD MAC Framework includes a number of policy-agnostic elements, "
"including MAC library interfaces for abstractly managing labels, "
"modifications to the system credential management and login libraries to "
"support the assignment of MAC labels to users, and a set of tools to monitor "
"and modify labels on processes, files, and network interfaces. More details "
"on the user architecture will be added to this section in the near future."
msgstr ""
"TrustedBSD MAC 框架包含了一组策略无关的组成元素，包括管理抽象标记的 MAC 接口库，对系统信任状管理体系的修改, 为用户分配 MAC "
"标记提供支持的 login "
"库函数，以及若干负责维护和更新内核对象(进程、文件和网络接口等)安全标记的工具。不久，将有更多关于应用层体系结构的详细信息被包含进来。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5732
#, no-wrap
msgid "APIs for Policy-Agnostic Label Management"
msgstr ""
".ps.1;，使用这些策略无关的接口查询网络结构、文件和进程的标记信息。\n"
"       这些 API 也被用于支持 MAC 管理工具"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5735
msgid ""
"The TrustedBSD MAC Framework provides a number of library and system calls "
"permitting applications to manage MAC labels on objects using a "
"policy-agnostic interface. This permits applications to manipulate labels "
"for a variety of policies without being written to support specific "
"policies. These interfaces are used by general-purpose tools such as "
"man:ifconfig[8], man:ls[1] and man:ps[1] to view labels on network "
"interfaces, files, and processes. The APIs also support MAC management tools "
"including man:getfmac[8], man:getpmac[8], man:setfmac[8], man:setfsmac[8], "
"and man:setpmac[8]. The MAC APIs are documented in man:mac[3]."
msgstr ""

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5737
msgid ""
"Applications handle MAC labels in two forms: an internalized form used to "
"return and set labels on processes and objects (`mac_t`), and externalized "
"form based on C strings appropriate for storage in configuration files, "
"display to the user, or input from the user. Each MAC label contains a "
"number of elements, each consisting of a name and value pair. Policy modules "
"in the kernel bind to specific names and interpret the values in "
"policy-specific ways. In the externalized string form, labels are "
"represented by a comma-delimited list of name and value pairs separated by "
"the `/` character. Labels may be directly converted to and from text using "
"provided APIs; when retrieving labels from the kernel, internalized label "
"storage must first be prepared for the desired label element set. Typically, "
"this is done in one of two ways: using man:mac_prepare[3] and an arbitrary "
"list of desired label elements, or one of the variants of the call that "
"loads a default element set from the man:mac.conf[5] configuration "
"file. Per-object defaults permit application writers to usefully display "
"labels associated with objects without being aware of the policies present "
"in the system."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5741
msgid ""
"Currently, direct manipulation of label elements other than by conversion to "
"a text string, string editing, and conversion back to an internalized label "
"is not supported by the MAC library. Such interfaces may be added in the "
"future if they prove necessary for application writers."
msgstr ""
"目前的 MAC 库不支持直接修改内部形式的标记元素，所有的修改必须按照下列的步骤进行：将内部形式的标记转换成文本字符串，对字符串进行编辑，最后将其转换成内"
"部形式标记。如果应用程序的作者证明确实有需要，可以在将来的版本中加入对内部形式标记进行直接修改的接口。"

#. type: Title ===
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5744
#, no-wrap
msgid "Binding of Labels to Users"
msgstr "为用户指定标记"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5747
msgid ""
"The standard user context management interface, man:setusercontext[3], has "
"been modified to retrieve MAC labels associated with a user's class from "
"man:login.conf[5]. These labels are then set along with other user context "
"when either `LOGIN_SETALL` is specified, or when `LOGIN_SETMAC` is "
"explicitly specified."
msgstr ""

#. type: delimited block = 4
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5751
msgid ""
"It is expected that, in a future version of FreeBSD, the MAC label database "
"will be separated from the [.filename]#login.conf# user class abstraction, "
"and be maintained in a separate database. However, the man:setusercontext[3] "
"API should remain the same following such a change."
msgstr ""

#. type: Title ==
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5754
#, no-wrap
msgid "Conclusion"
msgstr "结论"

#. type: Plain text
#: documentation/content/en/books/arch-handbook/mac/chapter.adoc:5756
msgid ""
"The TrustedBSD MAC framework permits kernel modules to augment the system "
"security policy in a highly integrated manner. They may do this based on "
"existing object properties, or based on label data that is maintained with "
"the assistance of the MAC framework. The framework is sufficiently flexible "
"to implement a variety of policy types, including information flow security "
"policies such as MLS and Biba, as well as policies based on existing BSD "
"credentials or file protections. Policy authors may wish to consult this "
"documentation as well as existing security modules when implementing a new "
"security service."
msgstr ""
"TrustedBSD MAC 框架使得内核模块能以一种集中的方式，完善系统的安全策略。它们既可利用现有的内核对象属性，又能使用由 MAC "
"框架协助维护的安全标记数据，来实施访问控制。框架提供的灵活性使得开发人员可以在其上实现各种策略，如利用 BSD "
"现有的信任状（credential）与文件保护机制的策略，以及信息流安全策略（如 MLS 和 "
"Biba）。实现新安全服务的策略编程人员，可以参考本文档，以了解现有安全模块的信息。"
